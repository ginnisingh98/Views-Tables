--------------------------------------------------------
--  DDL for Package Body GMD_ROUTINGS_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."GMD_ROUTINGS_PKG" AS
/* $Header: GMDROUMB.pls 120.0.12010000.2 2008/11/12 18:41:38 rnalla ship $ */

PROCEDURE INSERT_ROW (
  X_ROWID IN OUT NOCOPY VARCHAR2,
  X_ROUTING_ID IN NUMBER,
  X_OWNER_ORGANIZATION_ID IN NUMBER,
  X_ROUTING_NO IN VARCHAR2,
  X_ROUTING_VERS IN NUMBER,
  X_ROUTING_CLASS IN VARCHAR2,
  X_ROUTING_QTY IN NUMBER,
  X_ROUTING_UOM IN VARCHAR2,
  X_DELETE_MARK IN NUMBER,
  X_TEXT_CODE IN NUMBER,
  X_INACTIVE_IND IN NUMBER,
  X_ENFORCE_STEP_DEPENDENCY IN NUMBER,
  X_CONTIGUOUS_IND          IN NUMBER,
  X_IN_USE IN NUMBER,
  X_ATTRIBUTE1 IN VARCHAR2,
  X_ATTRIBUTE2 IN VARCHAR2,
  X_ATTRIBUTE3 IN VARCHAR2,
  X_ATTRIBUTE4 IN VARCHAR2,
  X_ATTRIBUTE5 IN VARCHAR2,
  X_ATTRIBUTE6 IN VARCHAR2,
  X_ATTRIBUTE7 IN VARCHAR2,
  X_ATTRIBUTE8 IN VARCHAR2,
  X_ATTRIBUTE9 IN VARCHAR2,
  X_ATTRIBUTE10 IN VARCHAR2,
  X_ATTRIBUTE11 IN VARCHAR2,
  X_ATTRIBUTE12 IN VARCHAR2,
  X_ATTRIBUTE13 IN VARCHAR2,
  X_ATTRIBUTE14 IN VARCHAR2,
  X_ATTRIBUTE15 IN VARCHAR2,
  X_ATTRIBUTE16 IN VARCHAR2,
  X_ATTRIBUTE17 IN VARCHAR2,
  X_ATTRIBUTE18 IN VARCHAR2,
  X_ATTRIBUTE19 IN VARCHAR2,
  X_ATTRIBUTE20 IN VARCHAR2,
  X_ATTRIBUTE21 IN VARCHAR2,
  X_ATTRIBUTE22 IN VARCHAR2,
  X_ATTRIBUTE23 IN VARCHAR2,
  X_ATTRIBUTE24 IN VARCHAR2,
  X_ATTRIBUTE25 IN VARCHAR2,
  X_ATTRIBUTE26 IN VARCHAR2,
  X_ATTRIBUTE27 IN VARCHAR2,
  X_ATTRIBUTE28 IN VARCHAR2,
  X_ATTRIBUTE29 IN VARCHAR2,
  X_ATTRIBUTE30 IN VARCHAR2,
  X_ATTRIBUTE_CATEGORY IN VARCHAR2,
  X_EFFECTIVE_START_DATE IN DATE,
  X_EFFECTIVE_END_DATE IN DATE,
  X_OWNER_ID IN NUMBER,
  X_PROJECT_ID IN NUMBER,
  X_PROCESS_LOSS IN NUMBER,
  X_ROUTING_STATUS IN VARCHAR2,
  X_ROUTING_DESC IN VARCHAR2,
  X_CREATION_DATE IN DATE,
  X_CREATED_BY IN NUMBER,
  X_LAST_UPDATE_DATE IN DATE,
  X_LAST_UPDATED_BY IN NUMBER,
  X_LAST_UPDATE_LOGIN IN NUMBER,
  X_FIXED_PROCESS_LOSS IN NUMBER, /* B6811759 */
  X_FIXED_PROCESS_LOSS_UOM IN VARCHAR2
) IS
  CURSOR C IS SELECT ROWID FROM GMD_ROUTINGS_B
    WHERE ROUTING_ID = X_ROUTING_ID
    ;
BEGIN
  INSERT INTO GMD_ROUTINGS_B (
    OWNER_ORGANIZATION_ID,
    ROUTING_ID,
    ROUTING_NO,
    ROUTING_VERS,
    ROUTING_CLASS,
    ROUTING_QTY,
    ROUTING_UOM,
    DELETE_MARK,
    TEXT_CODE,
    INACTIVE_IND,
    ENFORCE_STEP_DEPENDENCY,
    CONTIGUOUS_IND,
    IN_USE,
    ATTRIBUTE1,
    ATTRIBUTE2,
    ATTRIBUTE3,
    ATTRIBUTE4,
    ATTRIBUTE5,
    ATTRIBUTE6,
    ATTRIBUTE7,
    ATTRIBUTE8,
    ATTRIBUTE9,
    ATTRIBUTE10,
    ATTRIBUTE11,
    ATTRIBUTE12,
    ATTRIBUTE13,
    ATTRIBUTE14,
    ATTRIBUTE15,
    ATTRIBUTE16,
    ATTRIBUTE17,
    ATTRIBUTE18,
    ATTRIBUTE19,
    ATTRIBUTE20,
    ATTRIBUTE21,
    ATTRIBUTE22,
    ATTRIBUTE23,
    ATTRIBUTE24,
    ATTRIBUTE25,
    ATTRIBUTE26,
    ATTRIBUTE27,
    ATTRIBUTE28,
    ATTRIBUTE29,
    ATTRIBUTE30,
    ATTRIBUTE_CATEGORY,
    EFFECTIVE_START_DATE,
    EFFECTIVE_END_DATE,
    OWNER_ID,
    PROJECT_ID,
    PROCESS_LOSS,
    ROUTING_STATUS,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN,
    FIXED_PROCESS_LOSS, /* B6811759 */
    FIXED_PROCESS_LOSS_UOM
  ) VALUES (
    X_OWNER_ORGANIZATION_ID,
    X_ROUTING_ID,
    X_ROUTING_NO,
    X_ROUTING_VERS,
    X_ROUTING_CLASS,
    X_ROUTING_QTY,
    X_ROUTING_UOM,
    X_DELETE_MARK,
    X_TEXT_CODE,
    X_INACTIVE_IND,
    X_ENFORCE_STEP_DEPENDENCY,
    X_CONTIGUOUS_IND,
    X_IN_USE,
    X_ATTRIBUTE1,
    X_ATTRIBUTE2,
    X_ATTRIBUTE3,
    X_ATTRIBUTE4,
    X_ATTRIBUTE5,
    X_ATTRIBUTE6,
    X_ATTRIBUTE7,
    X_ATTRIBUTE8,
    X_ATTRIBUTE9,
    X_ATTRIBUTE10,
    X_ATTRIBUTE11,
    X_ATTRIBUTE12,
    X_ATTRIBUTE13,
    X_ATTRIBUTE14,
    X_ATTRIBUTE15,
    X_ATTRIBUTE16,
    X_ATTRIBUTE17,
    X_ATTRIBUTE18,
    X_ATTRIBUTE19,
    X_ATTRIBUTE20,
    X_ATTRIBUTE21,
    X_ATTRIBUTE22,
    X_ATTRIBUTE23,
    X_ATTRIBUTE24,
    X_ATTRIBUTE25,
    X_ATTRIBUTE26,
    X_ATTRIBUTE27,
    X_ATTRIBUTE28,
    X_ATTRIBUTE29,
    X_ATTRIBUTE30,
    X_ATTRIBUTE_CATEGORY,
    X_EFFECTIVE_START_DATE,
    X_EFFECTIVE_END_DATE,
    X_OWNER_ID,
    X_PROJECT_ID,
    X_PROCESS_LOSS,
    X_ROUTING_STATUS,
    X_CREATION_DATE,
    X_CREATED_BY,
    X_LAST_UPDATE_DATE,
    X_LAST_UPDATED_BY,
    X_LAST_UPDATE_LOGIN,
    X_FIXED_PROCESS_LOSS, /* B6811759 */
    X_FIXED_PROCESS_LOSS_UOM
  );

  INSERT INTO GMD_ROUTINGS_TL (
    LAST_UPDATE_LOGIN,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    ROUTING_ID,
    ROUTING_DESC,
    CREATION_DATE,
    CREATED_BY,
    LANGUAGE,
    SOURCE_LANG
  ) SELECT
    X_LAST_UPDATE_LOGIN,
    X_LAST_UPDATE_DATE,
    X_LAST_UPDATED_BY,
    X_ROUTING_ID,
    X_ROUTING_DESC,
    X_CREATION_DATE,
    X_CREATED_BY,
    L.LANGUAGE_CODE,
    USERENV('LANG')
  FROM FND_LANGUAGES L
  WHERE L.INSTALLED_FLAG IN ('I', 'B')
  AND NOT EXISTS
    (SELECT NULL
    FROM GMD_ROUTINGS_TL T
    WHERE T.ROUTING_ID = X_ROUTING_ID
    AND T.LANGUAGE = L.LANGUAGE_CODE);

  OPEN C;
  FETCH C INTO X_ROWID;
  IF (C%NOTFOUND) THEN
    CLOSE C;
    RAISE NO_DATA_FOUND;
  END IF;
  CLOSE C;

END INSERT_ROW;

PROCEDURE LOCK_ROW (
  X_ROUTING_ID IN NUMBER,
  X_OWNER_ORGANIZATION_ID IN NUMBER,
  X_ROUTING_NO IN VARCHAR2,
  X_ROUTING_VERS IN NUMBER,
  X_ROUTING_CLASS IN VARCHAR2,
  X_ROUTING_QTY IN NUMBER,
  X_ROUTING_UOM IN VARCHAR2,
  X_DELETE_MARK IN NUMBER,
  X_TEXT_CODE IN NUMBER,
  X_INACTIVE_IND IN NUMBER,
  X_ENFORCE_STEP_DEPENDENCY IN NUMBER,
  X_CONTIGUOUS_IND IN NUMBER,
  X_IN_USE IN NUMBER,
  X_ATTRIBUTE1 IN VARCHAR2,
  X_ATTRIBUTE2 IN VARCHAR2,
  X_ATTRIBUTE3 IN VARCHAR2,
  X_ATTRIBUTE4 IN VARCHAR2,
  X_ATTRIBUTE5 IN VARCHAR2,
  X_ATTRIBUTE6 IN VARCHAR2,
  X_ATTRIBUTE7 IN VARCHAR2,
  X_ATTRIBUTE8 IN VARCHAR2,
  X_ATTRIBUTE9 IN VARCHAR2,
  X_ATTRIBUTE10 IN VARCHAR2,
  X_ATTRIBUTE11 IN VARCHAR2,
  X_ATTRIBUTE12 IN VARCHAR2,
  X_ATTRIBUTE13 IN VARCHAR2,
  X_ATTRIBUTE14 IN VARCHAR2,
  X_ATTRIBUTE15 IN VARCHAR2,
  X_ATTRIBUTE16 IN VARCHAR2,
  X_ATTRIBUTE17 IN VARCHAR2,
  X_ATTRIBUTE18 IN VARCHAR2,
  X_ATTRIBUTE19 IN VARCHAR2,
  X_ATTRIBUTE20 IN VARCHAR2,
  X_ATTRIBUTE21 IN VARCHAR2,
  X_ATTRIBUTE22 IN VARCHAR2,
  X_ATTRIBUTE23 IN VARCHAR2,
  X_ATTRIBUTE24 IN VARCHAR2,
  X_ATTRIBUTE25 IN VARCHAR2,
  X_ATTRIBUTE26 IN VARCHAR2,
  X_ATTRIBUTE27 IN VARCHAR2,
  X_ATTRIBUTE28 IN VARCHAR2,
  X_ATTRIBUTE29 IN VARCHAR2,
  X_ATTRIBUTE30 IN VARCHAR2,
  X_ATTRIBUTE_CATEGORY IN VARCHAR2,
  X_EFFECTIVE_START_DATE IN DATE,
  X_EFFECTIVE_END_DATE IN DATE,
  X_OWNER_ID IN NUMBER,
  X_PROJECT_ID IN NUMBER,
  X_PROCESS_LOSS IN NUMBER,
  X_ROUTING_STATUS IN VARCHAR2,
  X_ROUTING_DESC IN VARCHAR2,
  X_FIXED_PROCESS_LOSS IN NUMBER, /* B6811759 */
  X_FIXED_PROCESS_LOSS_UOM     IN VARCHAR2
) IS
  CURSOR C IS SELECT
      OWNER_ORGANIZATION_ID,
      ROUTING_NO,
      ROUTING_VERS,
      ROUTING_CLASS,
      ROUTING_QTY,
      ROUTING_UOM,
      DELETE_MARK,
      TEXT_CODE,
      INACTIVE_IND,
      ENFORCE_STEP_DEPENDENCY,
      CONTIGUOUS_IND,
      IN_USE,
      ATTRIBUTE1,
      ATTRIBUTE2,
      ATTRIBUTE3,
      ATTRIBUTE4,
      ATTRIBUTE5,
      ATTRIBUTE6,
      ATTRIBUTE7,
      ATTRIBUTE8,
      ATTRIBUTE9,
      ATTRIBUTE10,
      ATTRIBUTE11,
      ATTRIBUTE12,
      ATTRIBUTE13,
      ATTRIBUTE14,
      ATTRIBUTE15,
      ATTRIBUTE16,
      ATTRIBUTE17,
      ATTRIBUTE18,
      ATTRIBUTE19,
      ATTRIBUTE20,
      ATTRIBUTE21,
      ATTRIBUTE22,
      ATTRIBUTE23,
      ATTRIBUTE24,
      ATTRIBUTE25,
      ATTRIBUTE26,
      ATTRIBUTE27,
      ATTRIBUTE28,
      ATTRIBUTE29,
      ATTRIBUTE30,
      ATTRIBUTE_CATEGORY,
      EFFECTIVE_START_DATE,
      EFFECTIVE_END_DATE,
      OWNER_ID,
      PROJECT_ID,
      PROCESS_LOSS,
      ROUTING_STATUS,
      FIXED_PROCESS_LOSS, /* B6811759 */
      FIXED_PROCESS_LOSS_UOM
    FROM GMD_ROUTINGS_B
    WHERE ROUTING_ID = X_ROUTING_ID
    FOR UPDATE OF ROUTING_ID NOWAIT;
  RECINFO C%ROWTYPE;

  CURSOR C1 IS SELECT
      ROUTING_DESC,
      DECODE(LANGUAGE, USERENV('LANG'), 'Y', 'N') BASELANG
    FROM GMD_ROUTINGS_TL
    WHERE ROUTING_ID = X_ROUTING_ID
    AND USERENV('LANG') IN (LANGUAGE, SOURCE_LANG)
    FOR UPDATE OF ROUTING_ID NOWAIT;
BEGIN
  OPEN C;
  FETCH C INTO RECINFO;
  IF (C%NOTFOUND) THEN
    CLOSE C;
    FND_MESSAGE.SET_NAME('FND', 'FORM_RECORD_DELETED');
    APP_EXCEPTION.RAISE_EXCEPTION;
  END IF;
  CLOSE C;
  IF ( (RECINFO.OWNER_ORGANIZATION_ID = X_OWNER_ORGANIZATION_ID)
      AND (RECINFO.ROUTING_NO = X_ROUTING_NO)
      AND (RECINFO.ROUTING_VERS = X_ROUTING_VERS)
      AND ((RECINFO.ROUTING_CLASS = X_ROUTING_CLASS)
           OR ((RECINFO.ROUTING_CLASS IS NULL) AND (X_ROUTING_CLASS IS NULL)))
      AND (RECINFO.ROUTING_QTY = X_ROUTING_QTY)
      AND (RECINFO.ROUTING_UOM = X_ROUTING_UOM)
      AND (RECINFO.DELETE_MARK = X_DELETE_MARK)
      AND ((RECINFO.TEXT_CODE = X_TEXT_CODE)
           OR ((RECINFO.TEXT_CODE IS NULL) AND (X_TEXT_CODE IS NULL)))
      AND (RECINFO.INACTIVE_IND = X_INACTIVE_IND)
      AND (NVL(RECINFO.ENFORCE_STEP_DEPENDENCY,0) = NVL(X_ENFORCE_STEP_DEPENDENCY,0))
      AND (NVL(RECINFO.CONTIGUOUS_IND,0) = NVL(X_CONTIGUOUS_IND,0))
      AND ((RECINFO.IN_USE = X_IN_USE)
           OR ((RECINFO.IN_USE IS NULL) AND (X_IN_USE IS NULL)))
      AND ((RECINFO.ATTRIBUTE1 = X_ATTRIBUTE1)
           OR ((RECINFO.ATTRIBUTE1 IS NULL) AND (X_ATTRIBUTE1 IS NULL)))
      AND ((RECINFO.ATTRIBUTE2 = X_ATTRIBUTE2)
           OR ((RECINFO.ATTRIBUTE2 IS NULL) AND (X_ATTRIBUTE2 IS NULL)))
      AND ((RECINFO.ATTRIBUTE3 = X_ATTRIBUTE3)
           OR ((RECINFO.ATTRIBUTE3 IS NULL) AND (X_ATTRIBUTE3 IS NULL)))
      AND ((RECINFO.ATTRIBUTE4 = X_ATTRIBUTE4)
           OR ((RECINFO.ATTRIBUTE4 IS NULL) AND (X_ATTRIBUTE4 IS NULL)))
      AND ((RECINFO.ATTRIBUTE5 = X_ATTRIBUTE5)
           OR ((RECINFO.ATTRIBUTE5 IS NULL) AND (X_ATTRIBUTE5 IS NULL)))
      AND ((RECINFO.ATTRIBUTE6 = X_ATTRIBUTE6)
           OR ((RECINFO.ATTRIBUTE6 IS NULL) AND (X_ATTRIBUTE6 IS NULL)))
      AND ((RECINFO.ATTRIBUTE7 = X_ATTRIBUTE7)
           OR ((RECINFO.ATTRIBUTE7 IS NULL) AND (X_ATTRIBUTE7 IS NULL)))
      AND ((RECINFO.ATTRIBUTE8 = X_ATTRIBUTE8)
           OR ((RECINFO.ATTRIBUTE8 IS NULL) AND (X_ATTRIBUTE8 IS NULL)))
      AND ((RECINFO.ATTRIBUTE9 = X_ATTRIBUTE9)
           OR ((RECINFO.ATTRIBUTE9 IS NULL) AND (X_ATTRIBUTE9 IS NULL)))
      AND ((RECINFO.ATTRIBUTE10 = X_ATTRIBUTE10)
           OR ((RECINFO.ATTRIBUTE10 IS NULL) AND (X_ATTRIBUTE10 IS NULL)))
      AND ((RECINFO.ATTRIBUTE11 = X_ATTRIBUTE11)
           OR ((RECINFO.ATTRIBUTE11 IS NULL) AND (X_ATTRIBUTE11 IS NULL)))
      AND ((RECINFO.ATTRIBUTE12 = X_ATTRIBUTE12)
           OR ((RECINFO.ATTRIBUTE12 IS NULL) AND (X_ATTRIBUTE12 IS NULL)))
      AND ((RECINFO.ATTRIBUTE13 = X_ATTRIBUTE13)
           OR ((RECINFO.ATTRIBUTE13 IS NULL) AND (X_ATTRIBUTE13 IS NULL)))
      AND ((RECINFO.ATTRIBUTE14 = X_ATTRIBUTE14)
           OR ((RECINFO.ATTRIBUTE14 IS NULL) AND (X_ATTRIBUTE14 IS NULL)))
      AND ((RECINFO.ATTRIBUTE15 = X_ATTRIBUTE15)
           OR ((RECINFO.ATTRIBUTE15 IS NULL) AND (X_ATTRIBUTE15 IS NULL)))
      AND ((RECINFO.ATTRIBUTE16 = X_ATTRIBUTE16)
           OR ((RECINFO.ATTRIBUTE16 IS NULL) AND (X_ATTRIBUTE16 IS NULL)))
      AND ((RECINFO.ATTRIBUTE17 = X_ATTRIBUTE17)
           OR ((RECINFO.ATTRIBUTE17 IS NULL) AND (X_ATTRIBUTE17 IS NULL)))
      AND ((RECINFO.ATTRIBUTE18 = X_ATTRIBUTE18)
           OR ((RECINFO.ATTRIBUTE18 IS NULL) AND (X_ATTRIBUTE18 IS NULL)))
      AND ((RECINFO.ATTRIBUTE19 = X_ATTRIBUTE19)
           OR ((RECINFO.ATTRIBUTE19 IS NULL) AND (X_ATTRIBUTE19 IS NULL)))
      AND ((RECINFO.ATTRIBUTE20 = X_ATTRIBUTE20)
           OR ((RECINFO.ATTRIBUTE20 IS NULL) AND (X_ATTRIBUTE20 IS NULL)))
      AND ((RECINFO.ATTRIBUTE21 = X_ATTRIBUTE21)
           OR ((RECINFO.ATTRIBUTE21 IS NULL) AND (X_ATTRIBUTE21 IS NULL)))
      AND ((RECINFO.ATTRIBUTE22 = X_ATTRIBUTE22)
           OR ((RECINFO.ATTRIBUTE22 IS NULL) AND (X_ATTRIBUTE22 IS NULL)))
      AND ((RECINFO.ATTRIBUTE23 = X_ATTRIBUTE23)
           OR ((RECINFO.ATTRIBUTE23 IS NULL) AND (X_ATTRIBUTE23 IS NULL)))
      AND ((RECINFO.ATTRIBUTE24 = X_ATTRIBUTE24)
           OR ((RECINFO.ATTRIBUTE24 IS NULL) AND (X_ATTRIBUTE24 IS NULL)))
      AND ((RECINFO.ATTRIBUTE25 = X_ATTRIBUTE25)
           OR ((RECINFO.ATTRIBUTE25 IS NULL) AND (X_ATTRIBUTE25 IS NULL)))
      AND ((RECINFO.ATTRIBUTE26 = X_ATTRIBUTE26)
           OR ((RECINFO.ATTRIBUTE26 IS NULL) AND (X_ATTRIBUTE26 IS NULL)))
      AND ((RECINFO.ATTRIBUTE27 = X_ATTRIBUTE27)
           OR ((RECINFO.ATTRIBUTE27 IS NULL) AND (X_ATTRIBUTE27 IS NULL)))
      AND ((RECINFO.ATTRIBUTE28 = X_ATTRIBUTE28)
           OR ((RECINFO.ATTRIBUTE28 IS NULL) AND (X_ATTRIBUTE28 IS NULL)))
      AND ((RECINFO.ATTRIBUTE29 = X_ATTRIBUTE29)
           OR ((RECINFO.ATTRIBUTE29 IS NULL) AND (X_ATTRIBUTE29 IS NULL)))
      AND ((RECINFO.ATTRIBUTE30 = X_ATTRIBUTE30)
           OR ((RECINFO.ATTRIBUTE30 IS NULL) AND (X_ATTRIBUTE30 IS NULL)))
      AND ((RECINFO.ATTRIBUTE_CATEGORY = X_ATTRIBUTE_CATEGORY)
           OR ((RECINFO.ATTRIBUTE_CATEGORY IS NULL) AND (X_ATTRIBUTE_CATEGORY IS NULL)))
      AND ((RECINFO.EFFECTIVE_START_DATE = X_EFFECTIVE_START_DATE)
           OR ((RECINFO.EFFECTIVE_START_DATE IS NULL) AND (X_EFFECTIVE_START_DATE IS NULL)))
      AND ((RECINFO.EFFECTIVE_END_DATE = X_EFFECTIVE_END_DATE)
           OR ((RECINFO.EFFECTIVE_END_DATE IS NULL) AND (X_EFFECTIVE_END_DATE IS NULL)))
      AND ((RECINFO.OWNER_ID = X_OWNER_ID)
           OR ((RECINFO.OWNER_ID IS NULL) AND (X_OWNER_ID IS NULL)))
      AND ((RECINFO.PROJECT_ID = X_PROJECT_ID)
           OR ((RECINFO.PROJECT_ID IS NULL) AND (X_PROJECT_ID IS NULL)))
      AND ((RECINFO.PROCESS_LOSS = X_PROCESS_LOSS)
           OR ((RECINFO.PROCESS_LOSS IS NULL) AND (X_PROCESS_LOSS IS NULL)))
      AND ((RECINFO.ROUTING_STATUS = X_ROUTING_STATUS)
           OR ((RECINFO.ROUTING_STATUS IS NULL) AND (X_ROUTING_STATUS IS NULL)))
      AND ((RECINFO.FIXED_PROCESS_LOSS = X_FIXED_PROCESS_LOSS) /* B6811759 */
           OR ((RECINFO.FIXED_PROCESS_LOSS IS NULL) AND (X_FIXED_PROCESS_LOSS IS NULL)))
      AND ((RECINFO.FIXED_PROCESS_LOSS_UOM = X_FIXED_PROCESS_LOSS_UOM)
           OR ((RECINFO.FIXED_PROCESS_LOSS_UOM IS NULL) AND (X_FIXED_PROCESS_LOSS_UOM IS NULL)))
  ) THEN
    NULL;
  ELSE
    FND_MESSAGE.SET_NAME('FND', 'FORM_RECORD_CHANGED');
    APP_EXCEPTION.RAISE_EXCEPTION;
  END IF;

  FOR TLINFO IN C1 LOOP
    IF (TLINFO.BASELANG = 'Y') THEN
      IF (    (TLINFO.ROUTING_DESC = X_ROUTING_DESC)
      ) THEN
        NULL;
      ELSE
        FND_MESSAGE.SET_NAME('FND', 'FORM_RECORD_CHANGED');
        APP_EXCEPTION.RAISE_EXCEPTION;
      END IF;
    END IF;
  END LOOP;
  RETURN;
END LOCK_ROW;

PROCEDURE UPDATE_ROW (
  X_ROUTING_ID IN NUMBER,
  X_OWNER_ORGANIZATION_ID IN NUMBER,
  X_ROUTING_NO IN VARCHAR2,
  X_ROUTING_VERS IN NUMBER,
  X_ROUTING_CLASS IN VARCHAR2,
  X_ROUTING_QTY IN NUMBER,
  X_ROUTING_UOM IN VARCHAR2,
  X_DELETE_MARK IN NUMBER,
  X_TEXT_CODE IN NUMBER,
  X_INACTIVE_IND IN NUMBER,
  X_ENFORCE_STEP_DEPENDENCY IN NUMBER,
  X_CONTIGUOUS_IND IN NUMBER,
  X_IN_USE IN NUMBER,
  X_ATTRIBUTE1 IN VARCHAR2,
  X_ATTRIBUTE2 IN VARCHAR2,
  X_ATTRIBUTE3 IN VARCHAR2,
  X_ATTRIBUTE4 IN VARCHAR2,
  X_ATTRIBUTE5 IN VARCHAR2,
  X_ATTRIBUTE6 IN VARCHAR2,
  X_ATTRIBUTE7 IN VARCHAR2,
  X_ATTRIBUTE8 IN VARCHAR2,
  X_ATTRIBUTE9 IN VARCHAR2,
  X_ATTRIBUTE10 IN VARCHAR2,
  X_ATTRIBUTE11 IN VARCHAR2,
  X_ATTRIBUTE12 IN VARCHAR2,
  X_ATTRIBUTE13 IN VARCHAR2,
  X_ATTRIBUTE14 IN VARCHAR2,
  X_ATTRIBUTE15 IN VARCHAR2,
  X_ATTRIBUTE16 IN VARCHAR2,
  X_ATTRIBUTE17 IN VARCHAR2,
  X_ATTRIBUTE18 IN VARCHAR2,
  X_ATTRIBUTE19 IN VARCHAR2,
  X_ATTRIBUTE20 IN VARCHAR2,
  X_ATTRIBUTE21 IN VARCHAR2,
  X_ATTRIBUTE22 IN VARCHAR2,
  X_ATTRIBUTE23 IN VARCHAR2,
  X_ATTRIBUTE24 IN VARCHAR2,
  X_ATTRIBUTE25 IN VARCHAR2,
  X_ATTRIBUTE26 IN VARCHAR2,
  X_ATTRIBUTE27 IN VARCHAR2,
  X_ATTRIBUTE28 IN VARCHAR2,
  X_ATTRIBUTE29 IN VARCHAR2,
  X_ATTRIBUTE30 IN VARCHAR2,
  X_ATTRIBUTE_CATEGORY IN VARCHAR2,
  X_EFFECTIVE_START_DATE IN DATE,
  X_EFFECTIVE_END_DATE IN DATE,
  X_OWNER_ID IN NUMBER,
  X_PROJECT_ID IN NUMBER,
  X_PROCESS_LOSS IN NUMBER,
  X_ROUTING_STATUS IN VARCHAR2,
  X_ROUTING_DESC IN VARCHAR2,
  X_LAST_UPDATE_DATE IN DATE,
  X_LAST_UPDATED_BY IN NUMBER,
  X_LAST_UPDATE_LOGIN IN NUMBER,
  X_FIXED_PROCESS_LOSS IN NUMBER, /* B6811759 */
  X_FIXED_PROCESS_LOSS_UOM IN VARCHAR2
) IS
BEGIN
  UPDATE GMD_ROUTINGS_B SET
    OWNER_ORGANIZATION_ID = X_OWNER_ORGANIZATION_ID,
    ROUTING_NO = X_ROUTING_NO,
    ROUTING_VERS = X_ROUTING_VERS,
    ROUTING_CLASS = X_ROUTING_CLASS,
    ROUTING_QTY = X_ROUTING_QTY,
    ROUTING_UOM = X_ROUTING_UOM,
    DELETE_MARK = X_DELETE_MARK,
    TEXT_CODE = X_TEXT_CODE,
    INACTIVE_IND = X_INACTIVE_IND,
    ENFORCE_STEP_DEPENDENCY = X_ENFORCE_STEP_DEPENDENCY,
    CONTIGUOUS_IND = X_CONTIGUOUS_IND,
    IN_USE = X_IN_USE,
    ATTRIBUTE1 = X_ATTRIBUTE1,
    ATTRIBUTE2 = X_ATTRIBUTE2,
    ATTRIBUTE3 = X_ATTRIBUTE3,
    ATTRIBUTE4 = X_ATTRIBUTE4,
    ATTRIBUTE5 = X_ATTRIBUTE5,
    ATTRIBUTE6 = X_ATTRIBUTE6,
    ATTRIBUTE7 = X_ATTRIBUTE7,
    ATTRIBUTE8 = X_ATTRIBUTE8,
    ATTRIBUTE9 = X_ATTRIBUTE9,
    ATTRIBUTE10 = X_ATTRIBUTE10,
    ATTRIBUTE11 = X_ATTRIBUTE11,
    ATTRIBUTE12 = X_ATTRIBUTE12,
    ATTRIBUTE13 = X_ATTRIBUTE13,
    ATTRIBUTE14 = X_ATTRIBUTE14,
    ATTRIBUTE15 = X_ATTRIBUTE15,
    ATTRIBUTE16 = X_ATTRIBUTE16,
    ATTRIBUTE17 = X_ATTRIBUTE17,
    ATTRIBUTE18 = X_ATTRIBUTE18,
    ATTRIBUTE19 = X_ATTRIBUTE19,
    ATTRIBUTE20 = X_ATTRIBUTE20,
    ATTRIBUTE21 = X_ATTRIBUTE21,
    ATTRIBUTE22 = X_ATTRIBUTE22,
    ATTRIBUTE23 = X_ATTRIBUTE23,
    ATTRIBUTE24 = X_ATTRIBUTE24,
    ATTRIBUTE25 = X_ATTRIBUTE25,
    ATTRIBUTE26 = X_ATTRIBUTE26,
    ATTRIBUTE27 = X_ATTRIBUTE27,
    ATTRIBUTE28 = X_ATTRIBUTE28,
    ATTRIBUTE29 = X_ATTRIBUTE29,
    ATTRIBUTE30 = X_ATTRIBUTE30,
    ATTRIBUTE_CATEGORY = X_ATTRIBUTE_CATEGORY,
    EFFECTIVE_START_DATE = X_EFFECTIVE_START_DATE,
    EFFECTIVE_END_DATE = X_EFFECTIVE_END_DATE,
    OWNER_ID = X_OWNER_ID,
    PROJECT_ID = X_PROJECT_ID,
    PROCESS_LOSS = X_PROCESS_LOSS,
    ROUTING_STATUS = X_ROUTING_STATUS,
    LAST_UPDATE_DATE = X_LAST_UPDATE_DATE,
    LAST_UPDATED_BY = X_LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN = X_LAST_UPDATE_LOGIN,
    FIXED_PROCESS_LOSS = X_FIXED_PROCESS_LOSS, /* B6811759 */
    FIXED_PROCESS_LOSS_UOM = X_FIXED_PROCESS_LOSS_UOM
  WHERE ROUTING_ID = X_ROUTING_ID;

  IF (SQL%NOTFOUND) THEN
    RAISE NO_DATA_FOUND;
  END IF;

  UPDATE GMD_ROUTINGS_TL SET
    ROUTING_DESC = X_ROUTING_DESC,
    LAST_UPDATE_DATE = X_LAST_UPDATE_DATE,
    LAST_UPDATED_BY = X_LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN = X_LAST_UPDATE_LOGIN,
    SOURCE_LANG = USERENV('LANG')
  WHERE ROUTING_ID = X_ROUTING_ID
  AND USERENV('LANG') IN (LANGUAGE, SOURCE_LANG);

  IF (SQL%NOTFOUND) THEN
    RAISE NO_DATA_FOUND;
  END IF;
END UPDATE_ROW;

PROCEDURE DELETE_ROW (
  X_ROUTING_ID IN NUMBER
) IS
BEGIN

  UPDATE GMD_ROUTINGS_B SET
  DELETE_MARK = 1
  WHERE ROUTING_ID = X_ROUTING_ID;

  IF (SQL%NOTFOUND) THEN
    RAISE NO_DATA_FOUND;
  END IF;
END DELETE_ROW;

PROCEDURE ADD_LANGUAGE
IS
BEGIN
  DELETE FROM GMD_ROUTINGS_TL T
  WHERE NOT EXISTS
    (SELECT NULL
    FROM GMD_ROUTINGS_B B
    WHERE B.ROUTING_ID = T.ROUTING_ID
    );

  UPDATE GMD_ROUTINGS_TL T SET (
      ROUTING_DESC
    ) = (SELECT
      B.ROUTING_DESC
    FROM GMD_ROUTINGS_TL B
    WHERE B.ROUTING_ID = T.ROUTING_ID
    AND B.LANGUAGE = T.SOURCE_LANG)
  WHERE (
      T.ROUTING_ID,
      T.LANGUAGE
  ) IN (SELECT
      SUBT.ROUTING_ID,
      SUBT.LANGUAGE
    FROM GMD_ROUTINGS_TL SUBB, GMD_ROUTINGS_TL SUBT
    WHERE SUBB.ROUTING_ID = SUBT.ROUTING_ID
    AND SUBB.LANGUAGE = SUBT.SOURCE_LANG
    AND (SUBB.ROUTING_DESC <> SUBT.ROUTING_DESC
  ));

  INSERT INTO GMD_ROUTINGS_TL (
    LAST_UPDATE_LOGIN,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    ROUTING_ID,
    ROUTING_DESC,
    CREATION_DATE,
    CREATED_BY,
    LANGUAGE,
    SOURCE_LANG
  ) SELECT
    B.LAST_UPDATE_LOGIN,
    B.LAST_UPDATE_DATE,
    B.LAST_UPDATED_BY,
    B.ROUTING_ID,
    B.ROUTING_DESC,
    B.CREATION_DATE,
    B.CREATED_BY,
    L.LANGUAGE_CODE,
    B.SOURCE_LANG
  FROM GMD_ROUTINGS_TL B, FND_LANGUAGES L
  WHERE L.INSTALLED_FLAG IN ('I', 'B')
  AND B.LANGUAGE = USERENV('LANG')
  AND NOT EXISTS
    (SELECT NULL
    FROM GMD_ROUTINGS_TL T
    WHERE T.ROUTING_ID = B.ROUTING_ID
    AND T.LANGUAGE = L.LANGUAGE_CODE);
END ADD_LANGUAGE;

END GMD_ROUTINGS_PKG;

/
