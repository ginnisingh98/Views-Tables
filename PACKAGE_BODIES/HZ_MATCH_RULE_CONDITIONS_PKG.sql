--------------------------------------------------------
--  DDL for Package Body HZ_MATCH_RULE_CONDITIONS_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."HZ_MATCH_RULE_CONDITIONS_PKG" AS
/*$Header: ARHMSCTB.pls 120.0 2005/05/25 21:08:58 achung noship $ */

PROCEDURE Insert_Row (
    X_MATCH_RULE_SET_CONDITION_ID           IN OUT NOCOPY NUMBER,
    X_MATCH_RULE_SET_ID                     IN        NUMBER,
    X_CONDITION_MATCH_RULE_ID               IN        NUMBER,
    X_ATTRIBUTE_ID                          IN        NUMBER,
    X_OPERATION                             IN        VARCHAR2,
    X_VALUE                                 IN        VARCHAR2,
    X_RANK                                  IN        NUMBER,
    X_BETWEEN_CONDITION_BIN_OP              IN        NUMBER,
    X_OBJECT_VERSION_NUMBER                 IN        NUMBER,
    X_CREATED_BY_MODULE                     IN        VARCHAR2,
    X_APPLICATION_ID                        IN        NUMBER
) IS

BEGIN
        INSERT INTO HZ_MATCH_RULE_CONDITIONS(
		    MATCH_RULE_SET_CONDITION_ID,
                    MATCH_RULE_SET_ID,
                    CONDITION_MATCH_RULE_ID,
                    ATTRIBUTE_ID,
                    OPERATION,
                    VALUE,
                    RANK ,
                    BETWEEN_CONDITION_BIN_OP ,
                    REQUEST_ID,
                    PROGRAM_APPLICATION_ID,
                    PROGRAM_ID,
                    PROGRAM_UPDATE_DATE,
                    CREATED_BY,
                    CREATION_DATE,
                    LAST_UPDATE_LOGIN,
                    LAST_UPDATE_DATE,
                    LAST_UPDATED_BY,
                    OBJECT_VERSION_NUMBER,
                    CREATED_BY_MODULE,
                    APPLICATION_ID   )
       VALUES
                  (DECODE(X_MATCH_RULE_SET_CONDITION_ID, FND_API.G_MISS_NUM, HZ_MATCH_RULE_CONDITIONS_S.NEXTVAL, NULL,
                           HZ_MATCH_RULE_CONDITIONS_S.NEXTVAL, X_MATCH_RULE_SET_CONDITION_ID ),
		   DECODE(X_MATCH_RULE_SET_ID, FND_API.G_MISS_NUM, NULL,X_MATCH_RULE_SET_ID),
                   DECODE(X_CONDITION_MATCH_RULE_ID,FND_API.G_MISS_NUM,NULL,X_CONDITION_MATCH_RULE_ID ),
                   DECODE(X_ATTRIBUTE_ID,FND_API.G_MISS_NUM,NULL,X_ATTRIBUTE_ID ),
                   DECODE(X_OPERATION,FND_API.G_MISS_CHAR,NULL,X_OPERATION),
                   DECODE(X_VALUE,FND_API.G_MISS_CHAR,NULL,X_VALUE),
                   DECODE(X_RANK,FND_API.G_MISS_NUM,NULL,X_RANK),
                   DECODE(X_BETWEEN_CONDITION_BIN_OP,FND_API.G_MISS_NUM,NULL,X_BETWEEN_CONDITION_BIN_OP),
                   HZ_UTILITY_V2PUB.REQUEST_ID,
                   HZ_UTILITY_V2PUB.PROGRAM_APPLICATION_ID,
                   HZ_UTILITY_V2PUB.PROGRAM_ID,
                   HZ_UTILITY_V2PUB.PROGRAM_UPDATE_DATE,
                   HZ_UTILITY_V2PUB.CREATED_BY,
                   HZ_UTILITY_V2PUB.CREATION_DATE,
                   HZ_UTILITY_V2PUB.LAST_UPDATE_LOGIN,
                   HZ_UTILITY_V2PUB.LAST_UPDATE_DATE,
                   HZ_UTILITY_V2PUB.LAST_UPDATED_BY,
                   DECODE( X_OBJECT_VERSION_NUMBER, FND_API.G_MISS_NUM, NULL, X_OBJECT_VERSION_NUMBER ),
                   DECODE( X_CREATED_BY_MODULE, FND_API.G_MISS_CHAR, NULL, X_CREATED_BY_MODULE ),
                   DECODE( X_APPLICATION_ID, FND_API.G_MISS_NUM, NULL, X_APPLICATION_ID )
                  ) returning MATCH_RULE_SET_CONDITION_ID INTO X_MATCH_RULE_SET_CONDITION_ID;

END Insert_Row;



PROCEDURE Update_Row (
    X_MATCH_RULE_SET_CONDITION_ID           IN	   NUMBER,
    X_MATCH_RULE_SET_ID                     IN     NUMBER,
    X_CONDITION_MATCH_RULE_ID               IN     NUMBER,
    X_ATTRIBUTE_ID                          IN     NUMBER,
    X_OPERATION                             IN     VARCHAR2,
    X_VALUE                                 IN     VARCHAR2,
    X_RANK                                  IN     NUMBER,
    X_BETWEEN_CONDITION_BIN_OP              IN     NUMBER,
    X_OBJECT_VERSION_NUMBER                 IN     NUMBER,
    X_CREATED_BY_MODULE                     IN     VARCHAR2,
    X_APPLICATION_ID                        IN     NUMBER
) IS
BEGIN
    UPDATE HZ_MATCH_RULE_CONDITIONS SET
           /*MATCH_RULE_SET_ID       = DECODE( X_MATCH_RULE_SET_ID, NULL, MATCH_RULE_SET_ID,FND_API.G_MISS_NUM,
                                       NULL,MATCH_RULE_SET_ID),
	   */
           CONDITION_MATCH_RULE_ID   = DECODE(X_CONDITION_MATCH_RULE_ID,NULL,CONDITION_MATCH_RULE_ID,
				       FND_API.G_MISS_NUM,NULL,X_CONDITION_MATCH_RULE_ID),
           ATTRIBUTE_ID              = DECODE(X_ATTRIBUTE_ID,NULL,ATTRIBUTE_ID,FND_API.G_MISS_NUM,NULL,
				        X_ATTRIBUTE_ID),
           OPERATION                 = DECODE(X_OPERATION,NULL,OPERATION,FND_API.G_MISS_CHAR,NULL,X_OPERATION),
           VALUE                     = DECODE(X_VALUE,NULL,VALUE,FND_API.G_MISS_CHAR,NULL,X_VALUE),
           RANK                      = DECODE(X_RANK,NULL,RANK,FND_API.G_MISS_NUM,NULL,X_RANK),
           BETWEEN_CONDITION_BIN_OP  = DECODE(X_BETWEEN_CONDITION_BIN_OP,NULL,BETWEEN_CONDITION_BIN_OP,
                                       FND_API.G_MISS_CHAR,NULL,X_BETWEEN_CONDITION_BIN_OP),
           LAST_UPDATE_DATE          = HZ_UTILITY_V2PUB.LAST_UPDATE_DATE,
           LAST_UPDATED_BY           = HZ_UTILITY_V2PUB.LAST_UPDATED_BY,
           LAST_UPDATE_LOGIN         = HZ_UTILITY_V2PUB.LAST_UPDATE_LOGIN,
           REQUEST_ID                = HZ_UTILITY_V2PUB.REQUEST_ID,
           PROGRAM_APPLICATION_ID    = HZ_UTILITY_V2PUB.PROGRAM_APPLICATION_ID,
           PROGRAM_ID                = HZ_UTILITY_V2PUB.PROGRAM_ID,
           PROGRAM_UPDATE_DATE       = HZ_UTILITY_V2PUB.PROGRAM_UPDATE_DATE,
           OBJECT_VERSION_NUMBER     = DECODE(X_OBJECT_VERSION_NUMBER,NULL,OBJECT_VERSION_NUMBER,FND_API.G_MISS_NUM,NULL,X_OBJECT_VERSION_NUMBER),
           CREATED_BY_MODULE         = DECODE(X_CREATED_BY_MODULE,NULL,CREATED_BY_MODULE,FND_API.G_MISS_CHAR,
                                       NULL,X_CREATED_BY_MODULE),
           APPLICATION_ID            = DECODE(X_APPLICATION_ID,NULL,APPLICATION_ID,FND_API.G_MISS_NUM,NULL,X_APPLICATION_ID)
    WHERE MATCH_RULE_SET_CONDITION_ID=X_MATCH_RULE_SET_CONDITION_ID;

    IF ( SQL%NOTFOUND ) THEN
        RAISE NO_DATA_FOUND;
    END IF;
END UPDATE_ROW;

PROCEDURE LOCK_ROW (
  X_MATCH_RULE_SET_CONDITION_ID IN NUMBER,
  X_OBJECT_VERSION_NUMBER       IN NUMBER
) IS
  CURSOR C IS SELECT OBJECT_VERSION_NUMBER
  FROM HZ_MATCH_RULE_CONDITIONS
  WHERE MATCH_RULE_SET_CONDITION_ID = X_MATCH_RULE_SET_CONDITION_ID
  FOR UPDATE OF MATCH_RULE_SET_CONDITION_ID NOWAIT;
  RECINFO C%ROWTYPE;

BEGIN
  OPEN C;
  FETCH C INTO RECINFO;
  IF (C%NOTFOUND) THEN
    CLOSE C;
    FND_MESSAGE.SET_NAME('fnd', 'form_record_deleted');
    APP_EXCEPTION.RAISE_EXCEPTION;
  END IF;
  CLOSE C;
  IF(( RECINFO.OBJECT_VERSION_NUMBER IS NULL AND X_OBJECT_VERSION_NUMBER IS NULL )
      OR ((RECINFO.OBJECT_VERSION_NUMBER IS NOT NULL AND X_OBJECT_VERSION_NUMBER IS NOT NULL) AND
           (RECINFO.OBJECT_VERSION_NUMBER = X_OBJECT_VERSION_NUMBER) )
     ) THEN
       NULL;
  ELSE
    FND_MESSAGE.SET_NAME('FND', 'FORM_RECORD_CHANGED');
    APP_EXCEPTION.RAISE_EXCEPTION;
  END IF;
  RETURN;
END LOCK_ROW;



PROCEDURE DELETE_ROW (
  X_MATCH_RULE_SET_CONDITION_ID in NUMBER
) IS
BEGIN
  DELETE FROM HZ_MATCH_RULE_CONDITIONS
  WHERE MATCH_RULE_SET_CONDITION_ID = X_MATCH_RULE_SET_CONDITION_ID;

  IF (SQL%NOTFOUND) THEN
    RAISE NO_DATA_FOUND;
  END IF;
END DELETE_ROW;

END HZ_MATCH_RULE_CONDITIONS_PKG;



/
