--------------------------------------------------------
--  DDL for Package Body PA_ACCUM_SRW
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."PA_ACCUM_SRW" AS
/* $Header: PAACSRWB.pls 120.1 2005/08/19 16:14:25 mwasowic noship $ */

   -- Initialize PROCEDURE

   PROCEDURE initialize IS
   BEGIN
      NULL;

   EXCEPTION
    WHEN  OTHERS  THEN
      RAISE;
   END initialize;

   FUNCTION get_number_of_projects RETURN NUMBER IS
   BEGIN
     RETURN number_of_projects;
   END get_number_of_projects;

   FUNCTION get_number_of_budgets_pst RETURN NUMBER IS
   BEGIN
     RETURN number_of_budgets_pst;
   END get_number_of_budgets_pst;

   FUNCTION get_number_of_budgets_pre RETURN NUMBER IS
   BEGIN
     RETURN number_of_budgets_pre;
   END get_number_of_budgets_pre;

   -- This procedure gets the summary number from the fixed table and
   -- puts them into PL/SQL table

   PROCEDURE get_project_summary_numbers
		      (X_PROJECT_ACCUM_ID  IN NUMBER,
		       X_PRE_POST_FLAG     IN VARCHAR2,
		       X_TABLE_INDEX       IN NUMBER,
		       X_ERR_STACK      IN OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
		       X_ERR_STAGE      IN OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
		       X_ERR_CODE       IN OUT NOCOPY NUMBER) --File.Sql.39 bug 4440895
   IS

     CURSOR selsummary IS
     SELECT
	PROJECT_ID,
	ACCUM_PERIOD,
        RAW_COST_ITD,
        RAW_COST_YTD,
        RAW_COST_PP,
        RAW_COST_PTD,
        BILLABLE_RAW_COST_ITD,
        BILLABLE_RAW_COST_YTD,
        BILLABLE_RAW_COST_PP,
        BILLABLE_RAW_COST_PTD,
        BURDENED_COST_ITD,
        BURDENED_COST_YTD,
        BURDENED_COST_PP,
        BURDENED_COST_PTD,
        BILLABLE_BURDENED_COST_ITD,
        BILLABLE_BURDENED_COST_YTD,
        BILLABLE_BURDENED_COST_PP,
        BILLABLE_BURDENED_COST_PTD,
        QUANTITY_ITD,
        QUANTITY_YTD,
        QUANTITY_PP,
        QUANTITY_PTD,
        LABOR_HOURS_ITD,
        LABOR_HOURS_YTD,
        LABOR_HOURS_PP,
        LABOR_HOURS_PTD,
        BILLABLE_QUANTITY_ITD,
        BILLABLE_QUANTITY_YTD,
        BILLABLE_QUANTITY_PP,
        BILLABLE_QUANTITY_PTD,
        BILLABLE_LABOR_HOURS_ITD,
        BILLABLE_LABOR_HOURS_YTD,
        BILLABLE_LABOR_HOURS_PP,
        BILLABLE_LABOR_HOURS_PTD,
        REVENUE_ITD,
        REVENUE_YTD,
        REVENUE_PP,
        REVENUE_PTD,
        CMT_RAW_COST_ITD,
        CMT_RAW_COST_YTD,
        CMT_RAW_COST_PP,
        CMT_RAW_COST_PTD,
        CMT_BURDENED_COST_ITD,
        CMT_BURDENED_COST_YTD,
        CMT_BURDENED_COST_PP,
        CMT_BURDENED_COST_PTD,
        CMT_QUANTITY_ITD,
        CMT_QUANTITY_YTD,
        CMT_QUANTITY_PP,
        CMT_QUANTITY_PTD
     FROM
	PA_PROJECT_ACCUM_HEADERS PAH,
	PA_PROJECT_ACCUM_ACTUALS PAA,
	PA_PROJECT_ACCUM_COMMITMENTS PAC
     WHERE
	PAH.PROJECT_ACCUM_ID = PAA.PROJECT_ACCUM_ID(+)
     AND PAH.PROJECT_ACCUM_ID = PAC.PROJECT_ACCUM_ID(+)
     AND PAH.PROJECT_ACCUM_ID = X_PROJECT_ACCUM_ID;

     srec             selsummary%ROWTYPE;
     x_old_stack      varchar2(1000);

   BEGIN

      x_old_stack := x_err_stack;
      x_err_stack := x_err_stack|| '->get_project_summary_numbers';

      pa_debug.debug(x_err_stack);

      FOR srec IN selsummary LOOP

	IF ( X_PRE_POST_FLAG = 'PRE' ) THEN

	   -- initialize the numbers before processing
	   PROJECT_ID(X_TABLE_INDEX) := SREC.PROJECT_ID;

           ACCUM_PERIOD_PRE(X_TABLE_INDEX) := SREC.ACCUM_PERIOD;
           RAW_COST_ITD_PRE(X_TABLE_INDEX) := SREC.RAW_COST_ITD;
           RAW_COST_YTD_PRE(X_TABLE_INDEX) := SREC.RAW_COST_YTD;
           RAW_COST_PP_PRE(X_TABLE_INDEX)  := SREC.RAW_COST_PP;
           RAW_COST_PTD_PRE(X_TABLE_INDEX) := SREC.RAW_COST_PTD;
           BILLABLE_RAW_COST_ITD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_ITD;
           BILLABLE_RAW_COST_YTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_YTD;
           BILLABLE_RAW_COST_PP_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_PP;
           BILLABLE_RAW_COST_PTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_PTD;
           BURDENED_COST_ITD_PRE(X_TABLE_INDEX) := SREC.BURDENED_COST_ITD;
           BURDENED_COST_YTD_PRE(X_TABLE_INDEX) := SREC.BURDENED_COST_YTD;
           BURDENED_COST_PP_PRE(X_TABLE_INDEX)  := SREC.BURDENED_COST_PP;
           BURDENED_COST_PTD_PRE(X_TABLE_INDEX) := SREC.BURDENED_COST_PTD;
           BILLABLE_BURDENED_COST_ITD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_ITD;
           BILLABLE_BURDENED_COST_YTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_YTD;
           BILLABLE_BURDENED_COST_PP_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_PP;
           BILLABLE_BURDENED_COST_PTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_PTD;
           QUANTITY_ITD_PRE(X_TABLE_INDEX) := SREC.QUANTITY_ITD;
           QUANTITY_YTD_PRE(X_TABLE_INDEX) := SREC.QUANTITY_YTD;
           QUANTITY_PP_PRE(X_TABLE_INDEX)  := SREC. QUANTITY_PP;
           QUANTITY_PTD_PRE(X_TABLE_INDEX) := SREC.QUANTITY_PTD;
           LABOR_HOURS_ITD_PRE(X_TABLE_INDEX) := SREC.LABOR_HOURS_ITD;
           LABOR_HOURS_YTD_PRE(X_TABLE_INDEX) := SREC.LABOR_HOURS_YTD;
           LABOR_HOURS_PP_PRE(X_TABLE_INDEX)  := SREC.LABOR_HOURS_PP;
           LABOR_HOURS_PTD_PRE(X_TABLE_INDEX) := SREC.LABOR_HOURS_PTD;
           BILLABLE_QUANTITY_ITD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_QUANTITY_ITD;
           BILLABLE_QUANTITY_YTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_QUANTITY_YTD;
           BILLABLE_QUANTITY_PP_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_QUANTITY_PP;
           BILLABLE_QUANTITY_PTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_QUANTITY_PTD;
           BILLABLE_LABOR_HOURS_ITD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_LABOR_HOURS_ITD;
           BILLABLE_LABOR_HOURS_YTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_LABOR_HOURS_YTD;
           BILLABLE_LABOR_HOURS_PP_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_LABOR_HOURS_PP;
           BILLABLE_LABOR_HOURS_PTD_PRE(X_TABLE_INDEX)
					   := SREC.BILLABLE_LABOR_HOURS_PTD;
           REVENUE_ITD_PRE(X_TABLE_INDEX) := SREC.REVENUE_ITD;
           REVENUE_YTD_PRE(X_TABLE_INDEX) := SREC.REVENUE_YTD;
           REVENUE_PP_PRE(X_TABLE_INDEX)  := SREC.REVENUE_PP;
           REVENUE_PTD_PRE(X_TABLE_INDEX) := SREC.REVENUE_PTD;

           -- Commitment figures

           CMT_RAW_COST_ITD_PRE(X_TABLE_INDEX) := SREC.CMT_RAW_COST_ITD;
           CMT_RAW_COST_YTD_PRE(X_TABLE_INDEX) := SREC.CMT_RAW_COST_YTD;
           CMT_RAW_COST_PP_PRE(X_TABLE_INDEX)  := SREC.CMT_RAW_COST_PP;
           CMT_RAW_COST_PTD_PRE(X_TABLE_INDEX) := SREC.CMT_RAW_COST_PTD;
           CMT_BURDENED_COST_ITD_PRE(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_ITD;
           CMT_BURDENED_COST_YTD_PRE(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_YTD;
           CMT_BURDENED_COST_PP_PRE(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_PP;
           CMT_BURDENED_COST_PTD_PRE(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_PTD;
           CMT_QUANTITY_ITD_PRE(X_TABLE_INDEX) := SREC.CMT_QUANTITY_ITD;
           CMT_QUANTITY_YTD_PRE(X_TABLE_INDEX) := SREC.CMT_QUANTITY_YTD;
           CMT_QUANTITY_PP_PRE(X_TABLE_INDEX)  := SREC.CMT_QUANTITY_PP;
           CMT_QUANTITY_PTD_PRE(X_TABLE_INDEX) := SREC.CMT_QUANTITY_PTD;

	ELSE

           ACCUM_PERIOD_PST(X_TABLE_INDEX) := SREC.ACCUM_PERIOD;
           RAW_COST_ITD_PST(X_TABLE_INDEX) := SREC.RAW_COST_ITD;
           RAW_COST_YTD_PST(X_TABLE_INDEX) := SREC.RAW_COST_YTD;
           RAW_COST_PP_PST(X_TABLE_INDEX)  := SREC.RAW_COST_PP;
           RAW_COST_PTD_PST(X_TABLE_INDEX) := SREC.RAW_COST_PTD;
           BILLABLE_RAW_COST_ITD_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_ITD;
           BILLABLE_RAW_COST_YTD_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_YTD;
           BILLABLE_RAW_COST_PP_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_PP;
           BILLABLE_RAW_COST_PTD_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_RAW_COST_PTD;
           BURDENED_COST_ITD_PST(X_TABLE_INDEX) := SREC.BURDENED_COST_ITD;
           BURDENED_COST_YTD_PST(X_TABLE_INDEX) := SREC.BURDENED_COST_YTD;
           BURDENED_COST_PP_PST(X_TABLE_INDEX)  := SREC.BURDENED_COST_PP;
           BURDENED_COST_PTD_PST(X_TABLE_INDEX) := SREC.BURDENED_COST_PTD;
           BILLABLE_BURDENED_COST_ITD_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_ITD;
           BILLABLE_BURDENED_COST_YTD_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_YTD;
           BILLABLE_BURDENED_COST_PP_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_PP;
           BILLABLE_BURDENED_COST_PTD_PST(X_TABLE_INDEX)
					   := SREC.BILLABLE_BURDENED_COST_PTD;
           QUANTITY_ITD_PST(X_TABLE_INDEX) := SREC.QUANTITY_ITD;
           QUANTITY_YTD_PST(X_TABLE_INDEX) := SREC.QUANTITY_YTD;
           QUANTITY_PP_PST(X_TABLE_INDEX)  := SREC.QUANTITY_PP;
           QUANTITY_PTD_PST(X_TABLE_INDEX) := SREC.QUANTITY_PTD;
           LABOR_HOURS_ITD_PST(X_TABLE_INDEX) := SREC.LABOR_HOURS_ITD;
           LABOR_HOURS_YTD_PST(X_TABLE_INDEX) := SREC.LABOR_HOURS_YTD;
           LABOR_HOURS_PP_PST(X_TABLE_INDEX)  := SREC.LABOR_HOURS_PP;
           LABOR_HOURS_PTD_PST(X_TABLE_INDEX) := SREC.LABOR_HOURS_PTD;
           BILLABLE_QUANTITY_ITD_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_QUANTITY_ITD;
           BILLABLE_QUANTITY_YTD_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_QUANTITY_YTD;
           BILLABLE_QUANTITY_PP_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_QUANTITY_PP;
           BILLABLE_QUANTITY_PTD_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_QUANTITY_PTD;
           BILLABLE_LABOR_HOURS_ITD_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_LABOR_HOURS_ITD;
           BILLABLE_LABOR_HOURS_YTD_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_LABOR_HOURS_YTD;
           BILLABLE_LABOR_HOURS_PP_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_LABOR_HOURS_PP;
           BILLABLE_LABOR_HOURS_PTD_PST(X_TABLE_INDEX)
					      := SREC.BILLABLE_LABOR_HOURS_PTD;
           REVENUE_ITD_PST(X_TABLE_INDEX) := SREC.REVENUE_ITD;
           REVENUE_YTD_PST(X_TABLE_INDEX) := SREC.REVENUE_YTD;
           REVENUE_PP_PST(X_TABLE_INDEX)  := SREC.REVENUE_PP;
           REVENUE_PTD_PST(X_TABLE_INDEX) := SREC.REVENUE_PTD;

           -- Commitment figures

           CMT_RAW_COST_ITD_PST(X_TABLE_INDEX) := SREC.CMT_RAW_COST_ITD;
           CMT_RAW_COST_YTD_PST(X_TABLE_INDEX) := SREC.CMT_RAW_COST_YTD;
           CMT_RAW_COST_PP_PST(X_TABLE_INDEX)  := SREC.CMT_RAW_COST_PP;
           CMT_RAW_COST_PTD_PST(X_TABLE_INDEX) := SREC.CMT_RAW_COST_PTD;
           CMT_BURDENED_COST_ITD_PST(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_ITD;
           CMT_BURDENED_COST_YTD_PST(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_YTD;
           CMT_BURDENED_COST_PP_PST(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_PP;
           CMT_BURDENED_COST_PTD_PST(X_TABLE_INDEX)
					       := SREC.CMT_BURDENED_COST_PTD;
           CMT_QUANTITY_ITD_PST(X_TABLE_INDEX) := SREC.CMT_QUANTITY_ITD;
           CMT_QUANTITY_YTD_PST(X_TABLE_INDEX) := SREC.CMT_QUANTITY_YTD;
           CMT_QUANTITY_PP_PST(X_TABLE_INDEX)  := SREC.CMT_QUANTITY_PP;
           CMT_QUANTITY_PTD_PST(X_TABLE_INDEX) := SREC.CMT_QUANTITY_PTD;

	END IF;

      END LOOP;

      x_err_stack := x_old_stack;

   EXCEPTION

     WHEN OTHERS THEN
       RAISE;
   END get_project_summary_numbers;

   PROCEDURE report_project_summary_numbers
		      (X_TABLE_INDEX IN NUMBER,
                       X_PROJECT_ID OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_ACCUM_PERIOD_B OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
                       X_RAW_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_ACCUM_PERIOD_A OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
                       X_RAW_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_RAW_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_BURDENED_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_CMT_QUANTITY_PTD_A OUT NOCOPY NUMBER) --File.Sql.39 bug 4440895
   IS
   BEGIN
        X_PROJECT_ID := PROJECT_ID(X_TABLE_INDEX);
        X_ACCUM_PERIOD_B := ACCUM_PERIOD_PRE(X_TABLE_INDEX);
        X_RAW_COST_ITD_B := RAW_COST_ITD_PRE(X_TABLE_INDEX);
        X_RAW_COST_YTD_B := RAW_COST_YTD_PRE(X_TABLE_INDEX);
        X_RAW_COST_PP_B := RAW_COST_PP_PRE(X_TABLE_INDEX);
        X_RAW_COST_PTD_B := RAW_COST_PTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_ITD_B := BILLABLE_RAW_COST_ITD_PRE(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_YTD_B := BILLABLE_RAW_COST_YTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_PP_B := BILLABLE_RAW_COST_PP_PRE(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_PTD_B := BILLABLE_RAW_COST_PTD_PRE(X_TABLE_INDEX);
        X_BURDENED_COST_ITD_B := BURDENED_COST_ITD_PRE(X_TABLE_INDEX);
        X_BURDENED_COST_YTD_B := BURDENED_COST_YTD_PRE(X_TABLE_INDEX);
        X_BURDENED_COST_PP_B := BURDENED_COST_PP_PRE(X_TABLE_INDEX);
        X_BURDENED_COST_PTD_B := BURDENED_COST_PTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_ITD_B := BILLABLE_BURDENED_COST_ITD_PRE(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_YTD_B := BILLABLE_BURDENED_COST_YTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_PP_B := BILLABLE_BURDENED_COST_PP_PRE(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_PTD_B := BILLABLE_BURDENED_COST_PTD_PRE(X_TABLE_INDEX);
        X_QUANTITY_ITD_B := QUANTITY_ITD_PRE(X_TABLE_INDEX);
        X_QUANTITY_YTD_B := QUANTITY_YTD_PRE(X_TABLE_INDEX);
        X_QUANTITY_PP_B := QUANTITY_PP_PRE(X_TABLE_INDEX);
        X_QUANTITY_PTD_B := QUANTITY_PTD_PRE(X_TABLE_INDEX);
        X_LABOR_HOURS_ITD_B := LABOR_HOURS_ITD_PRE(X_TABLE_INDEX);
        X_LABOR_HOURS_YTD_B := LABOR_HOURS_YTD_PRE(X_TABLE_INDEX);
        X_LABOR_HOURS_PP_B := LABOR_HOURS_PP_PRE(X_TABLE_INDEX);
        X_LABOR_HOURS_PTD_B := LABOR_HOURS_PTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_ITD_B := BILLABLE_QUANTITY_ITD_PRE(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_YTD_B := BILLABLE_QUANTITY_YTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_PP_B := BILLABLE_QUANTITY_PP_PRE(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_PTD_B := BILLABLE_QUANTITY_PTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_ITD_B := BILLABLE_LABOR_HOURS_ITD_PRE(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_YTD_B := BILLABLE_LABOR_HOURS_YTD_PRE(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_PP_B := BILLABLE_LABOR_HOURS_PP_PRE(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_PTD_B := BILLABLE_LABOR_HOURS_PTD_PRE(X_TABLE_INDEX);
        X_REVENUE_ITD_B := REVENUE_ITD_PRE(X_TABLE_INDEX);
        X_REVENUE_YTD_B := REVENUE_YTD_PRE(X_TABLE_INDEX);
        X_REVENUE_PP_B := REVENUE_PP_PRE(X_TABLE_INDEX);
        X_REVENUE_PTD_B := REVENUE_PTD_PRE(X_TABLE_INDEX);
        X_CMT_RAW_COST_ITD_B := CMT_RAW_COST_ITD_PRE(X_TABLE_INDEX);
        X_CMT_RAW_COST_YTD_B := CMT_RAW_COST_YTD_PRE(X_TABLE_INDEX);
        X_CMT_RAW_COST_PP_B := CMT_RAW_COST_PP_PRE(X_TABLE_INDEX);
        X_CMT_RAW_COST_PTD_B := CMT_RAW_COST_PTD_PRE(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_ITD_B := CMT_BURDENED_COST_ITD_PRE(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_YTD_B := CMT_BURDENED_COST_YTD_PRE(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_PP_B := CMT_BURDENED_COST_PP_PRE(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_PTD_B := CMT_BURDENED_COST_PTD_PRE(X_TABLE_INDEX);
        X_CMT_QUANTITY_ITD_B := CMT_QUANTITY_ITD_PRE(X_TABLE_INDEX);
        X_CMT_QUANTITY_YTD_B := CMT_QUANTITY_YTD_PRE(X_TABLE_INDEX);
        X_CMT_QUANTITY_PP_B := CMT_QUANTITY_PP_PRE(X_TABLE_INDEX);
        X_CMT_QUANTITY_PTD_B := CMT_QUANTITY_PTD_PRE(X_TABLE_INDEX);
        X_ACCUM_PERIOD_A := ACCUM_PERIOD_PST(X_TABLE_INDEX);
        X_RAW_COST_ITD_A := RAW_COST_ITD_PST(X_TABLE_INDEX);
        X_RAW_COST_YTD_A := RAW_COST_YTD_PST(X_TABLE_INDEX);
        X_RAW_COST_PP_A := RAW_COST_PP_PST(X_TABLE_INDEX);
        X_RAW_COST_PTD_A := RAW_COST_PTD_PST(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_ITD_A := BILLABLE_RAW_COST_ITD_PST(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_YTD_A := BILLABLE_RAW_COST_YTD_PST(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_PP_A := BILLABLE_RAW_COST_PP_PST(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_PTD_A := BILLABLE_RAW_COST_PTD_PST(X_TABLE_INDEX);
        X_BURDENED_COST_ITD_A := BURDENED_COST_ITD_PST(X_TABLE_INDEX);
        X_BURDENED_COST_YTD_A := BURDENED_COST_YTD_PST(X_TABLE_INDEX);
        X_BURDENED_COST_PP_A := BURDENED_COST_PP_PST(X_TABLE_INDEX);
        X_BURDENED_COST_PTD_A := BURDENED_COST_PTD_PST(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_ITD_A := BILLABLE_BURDENED_COST_ITD_PST(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_YTD_A := BILLABLE_BURDENED_COST_YTD_PST(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_PP_A := BILLABLE_BURDENED_COST_PP_PST(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_PTD_A := BILLABLE_BURDENED_COST_PTD_PST(X_TABLE_INDEX);
        X_QUANTITY_ITD_A := QUANTITY_ITD_PST(X_TABLE_INDEX);
        X_QUANTITY_YTD_A := QUANTITY_YTD_PST(X_TABLE_INDEX);
        X_QUANTITY_PP_A := QUANTITY_PP_PST(X_TABLE_INDEX);
        X_QUANTITY_PTD_A := QUANTITY_PTD_PST(X_TABLE_INDEX);
        X_LABOR_HOURS_ITD_A := LABOR_HOURS_ITD_PST(X_TABLE_INDEX);
        X_LABOR_HOURS_YTD_A := LABOR_HOURS_YTD_PST(X_TABLE_INDEX);
        X_LABOR_HOURS_PP_A := LABOR_HOURS_PP_PST(X_TABLE_INDEX);
        X_LABOR_HOURS_PTD_A := LABOR_HOURS_PTD_PST(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_ITD_A := BILLABLE_QUANTITY_ITD_PST(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_YTD_A := BILLABLE_QUANTITY_YTD_PST(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_PP_A := BILLABLE_QUANTITY_PP_PST(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_PTD_A := BILLABLE_QUANTITY_PTD_PST(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_ITD_A := BILLABLE_LABOR_HOURS_ITD_PST(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_YTD_A := BILLABLE_LABOR_HOURS_YTD_PST(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_PP_A := BILLABLE_LABOR_HOURS_PP_PST(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_PTD_A := BILLABLE_LABOR_HOURS_PTD_PST(X_TABLE_INDEX);
        X_REVENUE_ITD_A := REVENUE_ITD_PST(X_TABLE_INDEX);
        X_REVENUE_YTD_A := REVENUE_YTD_PST(X_TABLE_INDEX);
        X_REVENUE_PP_A := REVENUE_PP_PST(X_TABLE_INDEX);
        X_REVENUE_PTD_A := REVENUE_PTD_PST(X_TABLE_INDEX);
        X_CMT_RAW_COST_ITD_A := CMT_RAW_COST_ITD_PST(X_TABLE_INDEX);
        X_CMT_RAW_COST_YTD_A := CMT_RAW_COST_YTD_PST(X_TABLE_INDEX);
        X_CMT_RAW_COST_PP_A := CMT_RAW_COST_PP_PST(X_TABLE_INDEX);
        X_CMT_RAW_COST_PTD_A := CMT_RAW_COST_PTD_PST(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_ITD_A := CMT_BURDENED_COST_ITD_PST(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_YTD_A := CMT_BURDENED_COST_YTD_PST(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_PP_A := CMT_BURDENED_COST_PP_PST(X_TABLE_INDEX);
        X_CMT_BURDENED_COST_PTD_A := CMT_BURDENED_COST_PTD_PST(X_TABLE_INDEX);
        X_CMT_QUANTITY_ITD_A := CMT_QUANTITY_ITD_PST(X_TABLE_INDEX);
        X_CMT_QUANTITY_YTD_A := CMT_QUANTITY_YTD_PST(X_TABLE_INDEX);
        X_CMT_QUANTITY_PP_A := CMT_QUANTITY_PP_PST(X_TABLE_INDEX);
        X_CMT_QUANTITY_PTD_A := CMT_QUANTITY_PTD_PST(X_TABLE_INDEX);

   EXCEPTION
     WHEN OTHERS THEN
       RAISE;
   END report_project_summary_numbers;

   -- Get budgets figures accumulation

   PROCEDURE get_project_budget_numbers
                      (X_PROJECT_ACCUM_ID  IN NUMBER,
                       X_PRE_POST_FLAG     IN VARCHAR2,
                       X_ERR_STACK      IN OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
                       X_ERR_STAGE      IN OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
                       X_ERR_CODE       IN OUT NOCOPY NUMBER) --File.Sql.39 bug 4440895
   IS
     CURSOR selbudgets IS
     SELECT
	 PROJECT_ID,
         BUDGET_TYPE_CODE,
         BASE_RAW_COST_ITD,
         BASE_RAW_COST_YTD,
         BASE_RAW_COST_PP,
         BASE_RAW_COST_PTD,
         BASE_BURDENED_COST_ITD,
         BASE_BURDENED_COST_YTD,
         BASE_BURDENED_COST_PP,
         BASE_BURDENED_COST_PTD,
         ORIG_RAW_COST_ITD,
         ORIG_RAW_COST_YTD,
         ORIG_RAW_COST_PP,
         ORIG_RAW_COST_PTD,
         ORIG_BURDENED_COST_ITD,
         ORIG_BURDENED_COST_YTD,
         ORIG_BURDENED_COST_PP,
         ORIG_BURDENED_COST_PTD,
         BASE_REVENUE_ITD,
         BASE_REVENUE_YTD,
         BASE_REVENUE_PP,
         BASE_REVENUE_PTD,
         ORIG_REVENUE_ITD,
         ORIG_REVENUE_YTD,
         ORIG_REVENUE_PP,
         ORIG_REVENUE_PTD,
         ORIG_LABOR_HOURS_ITD,
         ORIG_LABOR_HOURS_YTD,
         ORIG_LABOR_HOURS_PP,
         ORIG_LABOR_HOURS_PTD,
         BASE_LABOR_HOURS_ITD,
         BASE_LABOR_HOURS_YTD,
         BASE_LABOR_HOURS_PP,
         BASE_LABOR_HOURS_PTD,
         ORIG_QUANTITY_YTD,
         ORIG_QUANTITY_ITD,
         ORIG_QUANTITY_PP,
         ORIG_QUANTITY_PTD,
         BASE_QUANTITY_YTD,
         BASE_QUANTITY_ITD,
         BASE_QUANTITY_PP,
         BASE_QUANTITY_PTD,
         ORIG_LABOR_HOURS_TOT,
         BASE_LABOR_HOURS_TOT,
         ORIG_QUANTITY_TOT,
         BASE_QUANTITY_TOT,
         BASE_RAW_COST_TOT,
         BASE_BURDENED_COST_TOT,
         ORIG_RAW_COST_TOT,
         ORIG_BURDENED_COST_TOT,
         BASE_REVENUE_TOT,
         ORIG_REVENUE_TOT
     FROM
	 PA_PROJECT_ACCUM_HEADERS PAH,
         PA_PROJECT_ACCUM_BUDGETS PAB
     WHERE
	 PAH.PROJECT_ACCUM_ID = PAB.PROJECT_ACCUM_ID -- No outer Join
     and  pab.fin_plan_type_id is null
     AND PAH.PROJECT_ACCUM_ID = X_PROJECT_ACCUM_ID;

     srec             selbudgets%ROWTYPE;
     x_old_stack      varchar2(1000);

   BEGIN

      x_old_stack := x_err_stack;
      x_err_stack := x_err_stack|| '->get_project_budget_numbers';

      pa_debug.debug(x_err_stack);

      FOR srec IN selbudgets LOOP
         IF ( X_PRE_POST_FLAG = 'PRE' ) THEN

            NUMBER_OF_BUDGETS_PRE := NUMBER_OF_BUDGETS_PRE + 1;

	    PROJECT_ID_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.PROJECT_ID;
            BUDGET_TYPE_CODE_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BUDGET_TYPE_CODE;
            BASE_RAW_COST_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_RAW_COST_ITD;
            BASE_RAW_COST_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_RAW_COST_YTD;
            BASE_RAW_COST_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_RAW_COST_PP;
            BASE_RAW_COST_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_RAW_COST_PTD;
            BASE_BURDENED_COST_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_BURDENED_COST_ITD;
            BASE_BURDENED_COST_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_BURDENED_COST_YTD;
            BASE_BURDENED_COST_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_BURDENED_COST_PP;
            BASE_BURDENED_COST_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_BURDENED_COST_PTD;
            ORIG_RAW_COST_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_RAW_COST_ITD;
            ORIG_RAW_COST_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_RAW_COST_YTD;
            ORIG_RAW_COST_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_RAW_COST_PP;
            ORIG_RAW_COST_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_RAW_COST_PTD;
            ORIG_BURDENED_COST_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_BURDENED_COST_ITD;
            ORIG_BURDENED_COST_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_BURDENED_COST_YTD;
            ORIG_BURDENED_COST_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_BURDENED_COST_PP;
            ORIG_BURDENED_COST_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_BURDENED_COST_PTD;
            BASE_REVENUE_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_REVENUE_ITD;
            BASE_REVENUE_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_REVENUE_YTD;
            BASE_REVENUE_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_REVENUE_PP;
            BASE_REVENUE_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_REVENUE_PTD;
            ORIG_REVENUE_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_REVENUE_ITD;
            ORIG_REVENUE_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_REVENUE_YTD;
            ORIG_REVENUE_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_REVENUE_PP;
            ORIG_REVENUE_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_REVENUE_PTD;
            ORIG_LABOR_HOURS_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_LABOR_HOURS_ITD;
            ORIG_LABOR_HOURS_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_LABOR_HOURS_YTD;
            ORIG_LABOR_HOURS_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_LABOR_HOURS_PP;
            ORIG_LABOR_HOURS_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_LABOR_HOURS_PTD;
            BASE_LABOR_HOURS_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_LABOR_HOURS_ITD;
            BASE_LABOR_HOURS_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_LABOR_HOURS_YTD;
            BASE_LABOR_HOURS_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_LABOR_HOURS_PP;
            BASE_LABOR_HOURS_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_LABOR_HOURS_PTD;
            ORIG_QUANTITY_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_QUANTITY_YTD;
            ORIG_QUANTITY_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_QUANTITY_ITD;
            ORIG_QUANTITY_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_QUANTITY_PP;
            ORIG_QUANTITY_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_QUANTITY_PTD;
            BASE_QUANTITY_YTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_QUANTITY_YTD;
            BASE_QUANTITY_ITD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_QUANTITY_ITD;
            BASE_QUANTITY_PP_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_QUANTITY_PP;
            BASE_QUANTITY_PTD_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_QUANTITY_PTD;
            ORIG_LABOR_HOURS_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_LABOR_HOURS_TOT;
            BASE_LABOR_HOURS_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_LABOR_HOURS_TOT;
            ORIG_QUANTITY_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_QUANTITY_TOT;
            BASE_QUANTITY_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_QUANTITY_TOT;
            BASE_RAW_COST_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_RAW_COST_TOT;
            BASE_BURDENED_COST_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_BURDENED_COST_TOT;
            ORIG_RAW_COST_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_RAW_COST_TOT;
            ORIG_BURDENED_COST_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_BURDENED_COST_TOT;
            BASE_REVENUE_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.BASE_REVENUE_TOT;
            ORIG_REVENUE_TOT_PRE(NUMBER_OF_BUDGETS_PRE) := SREC.ORIG_REVENUE_TOT;

         ELSE
            NUMBER_OF_BUDGETS_PST := NUMBER_OF_BUDGETS_PST + 1;

	    PROJECT_ID_PST(NUMBER_OF_BUDGETS_PST) := SREC.PROJECT_ID;
            BUDGET_TYPE_CODE_PST(NUMBER_OF_BUDGETS_PST) := SREC.BUDGET_TYPE_CODE;
            BASE_RAW_COST_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_RAW_COST_ITD;
            BASE_RAW_COST_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_RAW_COST_YTD;
            BASE_RAW_COST_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_RAW_COST_PP;
            BASE_RAW_COST_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_RAW_COST_PTD;
            BASE_BURDENED_COST_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_BURDENED_COST_ITD;
            BASE_BURDENED_COST_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_BURDENED_COST_YTD;
            BASE_BURDENED_COST_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_BURDENED_COST_PP;
            BASE_BURDENED_COST_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_BURDENED_COST_PTD;
            ORIG_RAW_COST_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_RAW_COST_ITD;
            ORIG_RAW_COST_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_RAW_COST_YTD;
            ORIG_RAW_COST_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_RAW_COST_PP;
            ORIG_RAW_COST_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_RAW_COST_PTD;
            ORIG_BURDENED_COST_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_BURDENED_COST_ITD;
            ORIG_BURDENED_COST_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_BURDENED_COST_YTD;
            ORIG_BURDENED_COST_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_BURDENED_COST_PP;
            ORIG_BURDENED_COST_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_BURDENED_COST_PTD;
            BASE_REVENUE_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_REVENUE_ITD;
            BASE_REVENUE_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_REVENUE_YTD;
            BASE_REVENUE_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_REVENUE_PP;
            BASE_REVENUE_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_REVENUE_PTD;
            ORIG_REVENUE_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_REVENUE_ITD;
            ORIG_REVENUE_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_REVENUE_YTD;
            ORIG_REVENUE_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_REVENUE_PP;
            ORIG_REVENUE_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_REVENUE_PTD;
            ORIG_LABOR_HOURS_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_LABOR_HOURS_ITD;
            ORIG_LABOR_HOURS_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_LABOR_HOURS_YTD;
            ORIG_LABOR_HOURS_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_LABOR_HOURS_PP;
            ORIG_LABOR_HOURS_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_LABOR_HOURS_PTD;
            BASE_LABOR_HOURS_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_LABOR_HOURS_ITD;
            BASE_LABOR_HOURS_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_LABOR_HOURS_YTD;
            BASE_LABOR_HOURS_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_LABOR_HOURS_PP;
            BASE_LABOR_HOURS_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_LABOR_HOURS_PTD;
            ORIG_QUANTITY_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_QUANTITY_YTD;
            ORIG_QUANTITY_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_QUANTITY_ITD;
            ORIG_QUANTITY_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_QUANTITY_PP;
            ORIG_QUANTITY_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_QUANTITY_PTD;
            BASE_QUANTITY_YTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_QUANTITY_YTD;
            BASE_QUANTITY_ITD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_QUANTITY_ITD;
            BASE_QUANTITY_PP_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_QUANTITY_PP;
            BASE_QUANTITY_PTD_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_QUANTITY_PTD;
            ORIG_LABOR_HOURS_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_LABOR_HOURS_TOT;
            BASE_LABOR_HOURS_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_LABOR_HOURS_TOT;
            ORIG_QUANTITY_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_QUANTITY_TOT;
            BASE_QUANTITY_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_QUANTITY_TOT;
            BASE_RAW_COST_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_RAW_COST_TOT;
            BASE_BURDENED_COST_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_BURDENED_COST_TOT;
            ORIG_RAW_COST_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_RAW_COST_TOT;
            ORIG_BURDENED_COST_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_BURDENED_COST_TOT;
            BASE_REVENUE_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.BASE_REVENUE_TOT;
            ORIG_REVENUE_TOT_PST(NUMBER_OF_BUDGETS_PST) := SREC.ORIG_REVENUE_TOT;

         END IF;

      END LOOP;

     x_err_stack := x_old_stack;

   EXCEPTION
     WHEN OTHERS THEN
       RAISE;
   END get_project_budget_numbers;

   -- procedure for reporting the budget numbers from the PL/SQL table

   PROCEDURE report_project_budget_numbers
		      (X_TABLE_INDEX IN NUMBER,
		       X_PROJECT_ID OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BUDGET_TYPE_CODE OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_YTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_ITD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_PP_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_PTD_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_TOT_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_YTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_ITD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_PP_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_PTD_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_LABOR_HOURS_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_LABOR_HOURS_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_QUANTITY_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_QUANTITY_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_RAW_COST_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_BURDENED_COST_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_RAW_COST_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_BURDENED_COST_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_BASE_REVENUE_TOT_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
		       X_ORIG_REVENUE_TOT_A OUT NOCOPY NUMBER --File.Sql.39 bug 4440895
		       )
   IS
   BEGIN

       -- First Populate the post processing Numbers;
       X_PROJECT_ID :=  PROJECT_ID_PST(X_TABLE_INDEX);
       X_BUDGET_TYPE_CODE :=  BUDGET_TYPE_CODE_PST(X_TABLE_INDEX);
       X_BASE_RAW_COST_ITD_A :=  BASE_RAW_COST_ITD_PST(X_TABLE_INDEX);
       X_BASE_RAW_COST_YTD_A :=  BASE_RAW_COST_YTD_PST(X_TABLE_INDEX);
       X_BASE_RAW_COST_PP_A :=  BASE_RAW_COST_PP_PST(X_TABLE_INDEX);
       X_BASE_RAW_COST_PTD_A :=  BASE_RAW_COST_PTD_PST(X_TABLE_INDEX);
       X_BASE_BURDENED_COST_ITD_A :=  BASE_BURDENED_COST_ITD_PST(X_TABLE_INDEX);
       X_BASE_BURDENED_COST_YTD_A :=  BASE_BURDENED_COST_YTD_PST(X_TABLE_INDEX);
       X_BASE_BURDENED_COST_PP_A :=  BASE_BURDENED_COST_PP_PST(X_TABLE_INDEX);
       X_BASE_BURDENED_COST_PTD_A :=  BASE_BURDENED_COST_PTD_PST(X_TABLE_INDEX);
       X_ORIG_RAW_COST_ITD_A :=  ORIG_RAW_COST_ITD_PST(X_TABLE_INDEX);
       X_ORIG_RAW_COST_YTD_A :=  ORIG_RAW_COST_YTD_PST(X_TABLE_INDEX);
       X_ORIG_RAW_COST_PP_A :=  ORIG_RAW_COST_PP_PST(X_TABLE_INDEX);
       X_ORIG_RAW_COST_PTD_A :=  ORIG_RAW_COST_PTD_PST(X_TABLE_INDEX);
       X_ORIG_BURDENED_COST_ITD_A :=  ORIG_BURDENED_COST_ITD_PST(X_TABLE_INDEX);
       X_ORIG_BURDENED_COST_YTD_A :=  ORIG_BURDENED_COST_YTD_PST(X_TABLE_INDEX);
       X_ORIG_BURDENED_COST_PP_A :=  ORIG_BURDENED_COST_PP_PST(X_TABLE_INDEX);
       X_ORIG_BURDENED_COST_PTD_A :=  ORIG_BURDENED_COST_PTD_PST(X_TABLE_INDEX);
       X_BASE_REVENUE_ITD_A :=  BASE_REVENUE_ITD_PST(X_TABLE_INDEX);
       X_BASE_REVENUE_YTD_A :=  BASE_REVENUE_YTD_PST(X_TABLE_INDEX);
       X_BASE_REVENUE_PP_A :=  BASE_REVENUE_PP_PST(X_TABLE_INDEX);
       X_BASE_REVENUE_PTD_A :=  BASE_REVENUE_PTD_PST(X_TABLE_INDEX);
       X_ORIG_REVENUE_ITD_A :=  ORIG_REVENUE_ITD_PST(X_TABLE_INDEX);
       X_ORIG_REVENUE_YTD_A :=  ORIG_REVENUE_YTD_PST(X_TABLE_INDEX);
       X_ORIG_REVENUE_PP_A :=  ORIG_REVENUE_PP_PST(X_TABLE_INDEX);
       X_ORIG_REVENUE_PTD_A :=  ORIG_REVENUE_PTD_PST(X_TABLE_INDEX);
       X_ORIG_LABOR_HOURS_ITD_A :=  ORIG_LABOR_HOURS_ITD_PST(X_TABLE_INDEX);
       X_ORIG_LABOR_HOURS_YTD_A :=  ORIG_LABOR_HOURS_YTD_PST(X_TABLE_INDEX);
       X_ORIG_LABOR_HOURS_PP_A :=  ORIG_LABOR_HOURS_PP_PST(X_TABLE_INDEX);
       X_ORIG_LABOR_HOURS_PTD_A :=  ORIG_LABOR_HOURS_PTD_PST(X_TABLE_INDEX);
       X_BASE_LABOR_HOURS_ITD_A :=  BASE_LABOR_HOURS_ITD_PST(X_TABLE_INDEX);
       X_BASE_LABOR_HOURS_YTD_A :=  BASE_LABOR_HOURS_YTD_PST(X_TABLE_INDEX);
       X_BASE_LABOR_HOURS_PP_A :=  BASE_LABOR_HOURS_PP_PST(X_TABLE_INDEX);
       X_BASE_LABOR_HOURS_PTD_A :=  BASE_LABOR_HOURS_PTD_PST(X_TABLE_INDEX);
       X_ORIG_QUANTITY_YTD_A :=  ORIG_QUANTITY_YTD_PST(X_TABLE_INDEX);
       X_ORIG_QUANTITY_ITD_A :=  ORIG_QUANTITY_ITD_PST(X_TABLE_INDEX);
       X_ORIG_QUANTITY_PP_A :=  ORIG_QUANTITY_PP_PST(X_TABLE_INDEX);
       X_ORIG_QUANTITY_PTD_A :=  ORIG_QUANTITY_PTD_PST(X_TABLE_INDEX);
       X_BASE_QUANTITY_YTD_A :=  BASE_QUANTITY_YTD_PST(X_TABLE_INDEX);
       X_BASE_QUANTITY_ITD_A :=  BASE_QUANTITY_ITD_PST(X_TABLE_INDEX);
       X_BASE_QUANTITY_PP_A :=  BASE_QUANTITY_PP_PST(X_TABLE_INDEX);
       X_BASE_QUANTITY_PTD_A :=  BASE_QUANTITY_PTD_PST(X_TABLE_INDEX);
       X_ORIG_LABOR_HOURS_TOT_A :=  ORIG_LABOR_HOURS_TOT_PST(X_TABLE_INDEX);
       X_BASE_LABOR_HOURS_TOT_A :=  BASE_LABOR_HOURS_TOT_PST(X_TABLE_INDEX);
       X_ORIG_QUANTITY_TOT_A :=  ORIG_QUANTITY_TOT_PST(X_TABLE_INDEX);
       X_BASE_QUANTITY_TOT_A :=  BASE_QUANTITY_TOT_PST(X_TABLE_INDEX);
       X_BASE_RAW_COST_TOT_A :=  BASE_RAW_COST_TOT_PST(X_TABLE_INDEX);
       X_BASE_BURDENED_COST_TOT_A :=  BASE_BURDENED_COST_TOT_PST(X_TABLE_INDEX);
       X_ORIG_RAW_COST_TOT_A :=  ORIG_RAW_COST_TOT_PST(X_TABLE_INDEX);
       X_ORIG_BURDENED_COST_TOT_A :=  ORIG_BURDENED_COST_TOT_PST(X_TABLE_INDEX);
       X_BASE_REVENUE_TOT_A :=  BASE_REVENUE_TOT_PST(X_TABLE_INDEX);
       X_ORIG_REVENUE_TOT_A :=  ORIG_REVENUE_TOT_PST(X_TABLE_INDEX);

       -- Determine the PL/SQL table index for this project_id and buget_type_code
       -- in the pl/sql which was created before processing
       -- It may be possible that the index is not found
       -- When the index is not found than it means the budget has been
       -- accumulated for the first time

       FOR i IN 1..number_of_budgets_pre LOOP

	 IF( PROJECT_ID_PRE(i) = PROJECT_ID_PST(X_TABLE_INDEX)
	     AND BUDGET_TYPE_CODE_PRE(i) = BUDGET_TYPE_CODE_PST(X_TABLE_INDEX) ) THEN

	   -- Numbers were available for this project and budget_type_code before processing
           X_BASE_RAW_COST_ITD_B :=  BASE_RAW_COST_ITD_PRE(i);
           X_BASE_RAW_COST_YTD_B :=  BASE_RAW_COST_YTD_PRE(i);
           X_BASE_RAW_COST_PP_B :=  BASE_RAW_COST_PP_PRE(i);
           X_BASE_RAW_COST_PTD_B :=  BASE_RAW_COST_PTD_PRE(i);
           X_BASE_BURDENED_COST_ITD_B :=  BASE_BURDENED_COST_ITD_PRE(i);
           X_BASE_BURDENED_COST_YTD_B :=  BASE_BURDENED_COST_YTD_PRE(i);
           X_BASE_BURDENED_COST_PP_B :=  BASE_BURDENED_COST_PP_PRE(i);
           X_BASE_BURDENED_COST_PTD_B :=  BASE_BURDENED_COST_PTD_PRE(i);
           X_ORIG_RAW_COST_ITD_B :=  ORIG_RAW_COST_ITD_PRE(i);
           X_ORIG_RAW_COST_YTD_B :=  ORIG_RAW_COST_YTD_PRE(i);
           X_ORIG_RAW_COST_PP_B :=  ORIG_RAW_COST_PP_PRE(i);
           X_ORIG_RAW_COST_PTD_B :=  ORIG_RAW_COST_PTD_PRE(i);
           X_ORIG_BURDENED_COST_ITD_B :=  ORIG_BURDENED_COST_ITD_PRE(i);
           X_ORIG_BURDENED_COST_YTD_B :=  ORIG_BURDENED_COST_YTD_PRE(i);
           X_ORIG_BURDENED_COST_PP_B :=  ORIG_BURDENED_COST_PP_PRE(i);
           X_ORIG_BURDENED_COST_PTD_B :=  ORIG_BURDENED_COST_PTD_PRE(i);
           X_BASE_REVENUE_ITD_B :=  BASE_REVENUE_ITD_PRE(i);
           X_BASE_REVENUE_YTD_B :=  BASE_REVENUE_YTD_PRE(i);
           X_BASE_REVENUE_PP_B :=  BASE_REVENUE_PP_PRE(i);
           X_BASE_REVENUE_PTD_B :=  BASE_REVENUE_PTD_PRE(i);
           X_ORIG_REVENUE_ITD_B :=  ORIG_REVENUE_ITD_PRE(i);
           X_ORIG_REVENUE_YTD_B :=  ORIG_REVENUE_YTD_PRE(i);
           X_ORIG_REVENUE_PP_B :=  ORIG_REVENUE_PP_PRE(i);
           X_ORIG_REVENUE_PTD_B :=  ORIG_REVENUE_PTD_PRE(i);
           X_ORIG_LABOR_HOURS_ITD_B :=  ORIG_LABOR_HOURS_ITD_PRE(i);
           X_ORIG_LABOR_HOURS_YTD_B :=  ORIG_LABOR_HOURS_YTD_PRE(i);
           X_ORIG_LABOR_HOURS_PP_B :=  ORIG_LABOR_HOURS_PP_PRE(i);
           X_ORIG_LABOR_HOURS_PTD_B :=  ORIG_LABOR_HOURS_PTD_PRE(i);
           X_BASE_LABOR_HOURS_ITD_B :=  BASE_LABOR_HOURS_ITD_PRE(i);
           X_BASE_LABOR_HOURS_YTD_B :=  BASE_LABOR_HOURS_YTD_PRE(i);
           X_BASE_LABOR_HOURS_PP_B :=  BASE_LABOR_HOURS_PP_PRE(i);
           X_BASE_LABOR_HOURS_PTD_B :=  BASE_LABOR_HOURS_PTD_PRE(i);
           X_ORIG_QUANTITY_YTD_B :=  ORIG_QUANTITY_YTD_PRE(i);
           X_ORIG_QUANTITY_ITD_B :=  ORIG_QUANTITY_ITD_PRE(i);
           X_ORIG_QUANTITY_PP_B :=  ORIG_QUANTITY_PP_PRE(i);
           X_ORIG_QUANTITY_PTD_B :=  ORIG_QUANTITY_PTD_PRE(i);
           X_BASE_QUANTITY_YTD_B :=  BASE_QUANTITY_YTD_PRE(i);
           X_BASE_QUANTITY_ITD_B :=  BASE_QUANTITY_ITD_PRE(i);
           X_BASE_QUANTITY_PP_B :=  BASE_QUANTITY_PP_PRE(i);
           X_BASE_QUANTITY_PTD_B :=  BASE_QUANTITY_PTD_PRE(i);
           X_ORIG_LABOR_HOURS_TOT_B :=  ORIG_LABOR_HOURS_TOT_PRE(i);
           X_BASE_LABOR_HOURS_TOT_B :=  BASE_LABOR_HOURS_TOT_PRE(i);
           X_ORIG_QUANTITY_TOT_B :=  ORIG_QUANTITY_TOT_PRE(i);
           X_BASE_QUANTITY_TOT_B :=  BASE_QUANTITY_TOT_PRE(i);
           X_BASE_RAW_COST_TOT_B :=  BASE_RAW_COST_TOT_PRE(i);
           X_BASE_BURDENED_COST_TOT_B :=  BASE_BURDENED_COST_TOT_PRE(i);
           X_ORIG_RAW_COST_TOT_B :=  ORIG_RAW_COST_TOT_PRE(i);
           X_ORIG_BURDENED_COST_TOT_B :=  ORIG_BURDENED_COST_TOT_PRE(i);
           X_BASE_REVENUE_TOT_B :=  BASE_REVENUE_TOT_PRE(i);
           X_ORIG_REVENUE_TOT_B :=  ORIG_REVENUE_TOT_PRE(i);

	 END IF;
       END LOOP;

   EXCEPTION
     WHEN OTHERS THEN
       RAISE;
   END report_project_budget_numbers;

   PROCEDURE get_project_txn_numbers
		      (X_PROJECT_ID        IN NUMBER,
		       X_PRE_POST_FLAG     IN VARCHAR2,
		       X_TABLE_INDEX       IN NUMBER,
		       X_ERR_STACK      IN OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
		       X_ERR_STAGE      IN OUT NOCOPY VARCHAR2, --File.Sql.39 bug 4440895
		       X_ERR_CODE       IN OUT NOCOPY NUMBER) --File.Sql.39 bug 4440895
   IS

     CURSOR selsumtxns IS
     SELECT
      PROJECT_ID,
      NVL(SUM(TOT_REVENUE),0) + NVL(SUM(I_TOT_REVENUE),0) TXN_REVENUE,
      NVL(SUM(TOT_RAW_COST),0)+ NVL(SUM(I_TOT_RAW_COST),0) TXN_RAW_COST,
      NVL(SUM(TOT_BURDENED_COST),0)+ NVL(SUM(I_TOT_BURDENED_COST),0) TXN_BURDENED_COST,
      NVL(SUM(TOT_QUANTITY),0)+ NVL(SUM(I_TOT_QUANTITY),0) TXN_QUANTITY,
      NVL(SUM(TOT_LABOR_HOURS),0) + NVL(SUM(I_TOT_LABOR_HOURS),0) TXN_LABOR_HOURS,
      NVL(SUM(TOT_BILLABLE_RAW_COST),0)
	+ NVL(SUM(I_TOT_BILLABLE_RAW_COST),0) TXN_BILLABLE_RAW_COST,
      NVL(SUM(TOT_BILLABLE_BURDENED_COST),0)
	+ NVL(SUM(I_TOT_BILLABLE_BURDENED_COST),0) TXN_BILLABLE_BURDENED_COST,
      NVL(SUM(TOT_BILLABLE_QUANTITY),0)
	+ NVL(SUM(I_TOT_BILLABLE_QUANTITY),0) TXN_BILLABLE_QUANTITY,
      NVL(SUM(TOT_BILLABLE_LABOR_HOURS),0)
	+ NVL(SUM(I_TOT_BILLABLE_LABOR_HOURS),0) TXN_BILLABLE_LABOR_HOURS
     FROM
      PA_TXN_ACCUM PTA
     WHERE
      PROJECT_ID = X_PROJECT_ID
     AND exists
          ( SELECT 'Yes'
            FROM   pa_txn_accum_details ptad
            WHERE  pta.txn_accum_id = ptad.txn_accum_id
            AND    ptad.line_type IN ('C','R','E')
          )
     GROUP BY PROJECT_ID;

     srec             selsumtxns%ROWTYPE;
     x_old_stack      varchar2(1000);

   BEGIN

      x_old_stack := x_err_stack;
      x_err_stack := x_err_stack|| '->get_project_txn_numbers';

      pa_debug.debug(x_err_stack);

      -- initialize the numbers to zero in case the cursor does not return any row

      IF ( X_PRE_POST_FLAG = 'PRE' ) THEN
        PROJECT_ID(X_TABLE_INDEX) := SREC.PROJECT_ID;

        TXN_RAW_COST_PRE(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_RAW_COST_PRE(X_TABLE_INDEX) := 0;
        TXN_BURDENED_COST_PRE(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_BURDENED_COST_PRE(X_TABLE_INDEX) := 0;
        TXN_QUANTITY_PRE(X_TABLE_INDEX) := 0;
        TXN_LABOR_HOURS_PRE(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_QUANTITY_PRE(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_LABOR_HOURS_PRE(X_TABLE_INDEX) := 0;
        TXN_REVENUE_PRE(X_TABLE_INDEX) := 0;
      ELSE

        TXN_RAW_COST_PST(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_RAW_COST_PST(X_TABLE_INDEX) := 0;
        TXN_BURDENED_COST_PST(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_BURDENED_COST_PST(X_TABLE_INDEX) := 0;
        TXN_QUANTITY_PST(X_TABLE_INDEX) := 0;
        TXN_LABOR_HOURS_PST(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_QUANTITY_PST(X_TABLE_INDEX) := 0;
        TXN_BILLABLE_LABOR_HOURS_PST(X_TABLE_INDEX) := 0;
        TXN_REVENUE_PST(X_TABLE_INDEX) := 0;
      END IF;

      FOR srec IN selsumtxns LOOP

	IF ( X_PRE_POST_FLAG = 'PRE' ) THEN

	   -- initialize the numbers before processing
	   PROJECT_ID(X_TABLE_INDEX) := SREC.PROJECT_ID;

           TXN_RAW_COST_PRE(X_TABLE_INDEX) := SREC.TXN_RAW_COST;
           TXN_BILLABLE_RAW_COST_PRE(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_RAW_COST;
           TXN_BURDENED_COST_PRE(X_TABLE_INDEX) := SREC.TXN_BURDENED_COST;
           TXN_BILLABLE_BURDENED_COST_PRE(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_BURDENED_COST;
           TXN_QUANTITY_PRE(X_TABLE_INDEX) := SREC.TXN_QUANTITY;
           TXN_LABOR_HOURS_PRE(X_TABLE_INDEX) := SREC.TXN_LABOR_HOURS;
           TXN_BILLABLE_QUANTITY_PRE(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_QUANTITY;
           TXN_BILLABLE_LABOR_HOURS_PRE(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_LABOR_HOURS;
           TXN_REVENUE_PRE(X_TABLE_INDEX) := SREC.TXN_REVENUE;

	ELSE

           TXN_RAW_COST_PST(X_TABLE_INDEX) := SREC.TXN_RAW_COST;
           TXN_BILLABLE_RAW_COST_PST(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_RAW_COST;
           TXN_BURDENED_COST_PST(X_TABLE_INDEX) := SREC.TXN_BURDENED_COST;
           TXN_BILLABLE_BURDENED_COST_PST(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_BURDENED_COST;
           TXN_QUANTITY_PST(X_TABLE_INDEX) := SREC.TXN_QUANTITY;
           TXN_LABOR_HOURS_PST(X_TABLE_INDEX) := SREC.TXN_LABOR_HOURS;
           TXN_BILLABLE_QUANTITY_PST(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_QUANTITY;
           TXN_BILLABLE_LABOR_HOURS_PST(X_TABLE_INDEX)
					   := SREC.TXN_BILLABLE_LABOR_HOURS;
           TXN_REVENUE_PST(X_TABLE_INDEX) := SREC.TXN_REVENUE;

	END IF;

      END LOOP;

      x_err_stack := x_old_stack;

   EXCEPTION

     WHEN OTHERS THEN
       RAISE;
   END get_project_txn_numbers;

   PROCEDURE report_project_txn_numbers
		      (X_TABLE_INDEX IN NUMBER,
                       X_PROJECT_ID OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_B OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_RAW_COST_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_RAW_COST_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BURDENED_COST_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_BURDENED_COST_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_QUANTITY_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_LABOR_HOURS_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_QUANTITY_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_BILLABLE_LABOR_HOURS_A OUT NOCOPY NUMBER, --File.Sql.39 bug 4440895
                       X_REVENUE_A OUT NOCOPY NUMBER) --File.Sql.39 bug 4440895
   IS
   BEGIN
        X_PROJECT_ID := PROJECT_ID(X_TABLE_INDEX);

        X_RAW_COST_B := TXN_RAW_COST_PRE(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_B := TXN_BILLABLE_RAW_COST_PRE(X_TABLE_INDEX);
        X_BURDENED_COST_B := TXN_BURDENED_COST_PRE(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_B := TXN_BILLABLE_BURDENED_COST_PRE(X_TABLE_INDEX);
        X_QUANTITY_B := TXN_QUANTITY_PRE(X_TABLE_INDEX);
        X_LABOR_HOURS_B := TXN_LABOR_HOURS_PRE(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_B := TXN_BILLABLE_QUANTITY_PRE(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_B := TXN_BILLABLE_LABOR_HOURS_PRE(X_TABLE_INDEX);
        X_REVENUE_B := TXN_REVENUE_PRE(X_TABLE_INDEX);

        X_RAW_COST_A := TXN_RAW_COST_PST(X_TABLE_INDEX);
        X_BILLABLE_RAW_COST_A := TXN_BILLABLE_RAW_COST_PST(X_TABLE_INDEX);
        X_BURDENED_COST_A := TXN_BURDENED_COST_PST(X_TABLE_INDEX);
        X_BILLABLE_BURDENED_COST_A := TXN_BILLABLE_BURDENED_COST_PST(X_TABLE_INDEX);
        X_QUANTITY_A := TXN_QUANTITY_PST(X_TABLE_INDEX);
        X_LABOR_HOURS_A := TXN_LABOR_HOURS_PST(X_TABLE_INDEX);
        X_BILLABLE_QUANTITY_A := TXN_BILLABLE_QUANTITY_PST(X_TABLE_INDEX);
        X_BILLABLE_LABOR_HOURS_A := TXN_BILLABLE_LABOR_HOURS_PST(X_TABLE_INDEX);
        X_REVENUE_A := TXN_REVENUE_PST(X_TABLE_INDEX);

   EXCEPTION
     WHEN OTHERS THEN
       RAISE;
   END report_project_txn_numbers;

END PA_ACCUM_SRW;

/
