--------------------------------------------------------
--  DDL for Package Body CSI_II_RELATIONSHIPS_H_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."CSI_II_RELATIONSHIPS_H_PKG" AS
/* $Header: csitirhb.pls 115.14 2003/09/04 00:20:36 sguthiva ship $ */
-- start of comments
-- package name     : csi_ii_relationships_h_pkg
-- purpose          :
-- history          :
-- note             :
-- end of comments


g_pkg_name CONSTANT VARCHAR2(30):= 'csi_ii_relationships_h_pkg';
g_file_name CONSTANT VARCHAR2(12) := 'csitirhb.pls';

PROCEDURE insert_row(
          px_relationship_history_id   IN OUT NOCOPY NUMBER  ,
          p_relationship_id                   NUMBER  ,
          p_transaction_id                    NUMBER  ,
          p_old_subject_id                    NUMBER  ,
          p_new_subject_id                    NUMBER  ,
          p_old_position_reference            VARCHAR2,
          p_new_position_reference            VARCHAR2,
          p_old_active_start_date             DATE    ,
          p_new_active_start_date             DATE    ,
          p_old_active_end_date               DATE    ,
          p_new_active_end_date               DATE    ,
          p_old_mandatory_flag                VARCHAR2,
          p_new_mandatory_flag                VARCHAR2,
          p_old_context                       VARCHAR2,
          p_new_context                       VARCHAR2,
          p_old_attribute1                    VARCHAR2,
          p_new_attribute1                    VARCHAR2,
          p_old_attribute2                    VARCHAR2,
          p_new_attribute2                    VARCHAR2,
          p_old_attribute3                    VARCHAR2,
          p_new_attribute3                    VARCHAR2,
          p_old_attribute4                    VARCHAR2,
          p_new_attribute4                    VARCHAR2,
          p_old_attribute5                    VARCHAR2,
          p_new_attribute5                    VARCHAR2,
          p_old_attribute6                    VARCHAR2,
          p_new_attribute6                    VARCHAR2,
          p_old_attribute7                    VARCHAR2,
          p_new_attribute7                    VARCHAR2,
          p_old_attribute8                    VARCHAR2,
          p_new_attribute8                    VARCHAR2,
          p_old_attribute9                    VARCHAR2,
          p_new_attribute9                    VARCHAR2,
          p_old_attribute10                   VARCHAR2,
          p_new_attribute10                   VARCHAR2,
          p_old_attribute11                   VARCHAR2,
          p_new_attribute11                   VARCHAR2,
          p_old_attribute12                   VARCHAR2,
          p_new_attribute12                   VARCHAR2,
          p_old_attribute13                   VARCHAR2,
          p_new_attribute13                   VARCHAR2,
          p_old_attribute14                   VARCHAR2,
          p_new_attribute14                   VARCHAR2,
          p_old_attribute15                   VARCHAR2,
          p_new_attribute15                   VARCHAR2,
          p_full_dump_flag                    VARCHAR2,
          p_created_by                        NUMBER  ,
          p_creation_date                     DATE    ,
          p_last_updated_by                   NUMBER  ,
          p_last_update_date                  DATE    ,
          p_last_update_login                 NUMBER  ,
          p_object_version_number             NUMBER  )

 IS
   CURSOR c2 IS SELECT csi_ii_relationships_h_s.NEXTVAL FROM sys.dual;
BEGIN
   IF (px_relationship_history_id IS NULL) OR (px_relationship_history_id = fnd_api.g_miss_num) THEN
       OPEN c2;
       FETCH c2 INTO px_relationship_history_id;
       CLOSE c2;
   END IF;
   INSERT INTO csi_ii_relationships_h(
           relationship_history_id,
           relationship_id,
           transaction_id,
           old_subject_id,
           new_subject_id,
           old_position_reference,
           new_position_reference,
           old_active_start_date,
           new_active_start_date,
           old_active_end_date,
           new_active_end_date,
           old_mandatory_flag,
           new_mandatory_flag,
           old_context,
           new_context,
           old_attribute1,
           new_attribute1,
           old_attribute2,
           new_attribute2,
           old_attribute3,
           new_attribute3,
           old_attribute4,
           new_attribute4,
           old_attribute5,
           new_attribute5,
           old_attribute6,
           new_attribute6,
           old_attribute7,
           new_attribute7,
           old_attribute8,
           new_attribute8,
           old_attribute9,
           new_attribute9,
           old_attribute10,
           new_attribute10,
           old_attribute11,
           new_attribute11,
           old_attribute12,
           new_attribute12,
           old_attribute13,
           new_attribute13,
           old_attribute14,
           new_attribute14,
           old_attribute15,
           new_attribute15,
           full_dump_flag,
           created_by,
           creation_date,
           last_updated_by,
           last_update_date,
           last_update_login,
           object_version_number
          ) VALUES (
           px_relationship_history_id,
           DECODE( p_relationship_id, fnd_api.g_miss_num, NULL, p_relationship_id),
           DECODE( p_transaction_id, fnd_api.g_miss_num, NULL, p_transaction_id),
           DECODE( p_old_subject_id, fnd_api.g_miss_num, NULL, p_old_subject_id),
           DECODE( p_new_subject_id, fnd_api.g_miss_num, NULL, p_new_subject_id),
           DECODE( p_old_position_reference, fnd_api.g_miss_char, NULL, p_old_position_reference),
           DECODE( p_new_position_reference, fnd_api.g_miss_char, NULL, p_new_position_reference),
           DECODE( p_old_active_start_date, fnd_api.g_miss_date, TO_DATE(NULL), p_old_active_start_date),
           DECODE( p_new_active_start_date, fnd_api.g_miss_date, TO_DATE(NULL), p_new_active_start_date),
           DECODE( p_old_active_end_date, fnd_api.g_miss_date, TO_DATE(NULL), p_old_active_end_date),
           DECODE( p_new_active_end_date, fnd_api.g_miss_date, TO_DATE(NULL), p_new_active_end_date),
           DECODE( p_old_mandatory_flag, fnd_api.g_miss_char, NULL, p_old_mandatory_flag),
           DECODE( p_new_mandatory_flag, fnd_api.g_miss_char, NULL, p_new_mandatory_flag),
           DECODE( p_old_context, fnd_api.g_miss_char, NULL, p_old_context),
           DECODE( p_new_context, fnd_api.g_miss_char, NULL, p_new_context),
           DECODE( p_old_attribute1, fnd_api.g_miss_char, NULL, p_old_attribute1),
           DECODE( p_new_attribute1, fnd_api.g_miss_char, NULL, p_new_attribute1),
           DECODE( p_old_attribute2, fnd_api.g_miss_char, NULL, p_old_attribute2),
           DECODE( p_new_attribute2, fnd_api.g_miss_char, NULL, p_new_attribute2),
           DECODE( p_old_attribute3, fnd_api.g_miss_char, NULL, p_old_attribute3),
           DECODE( p_new_attribute3, fnd_api.g_miss_char, NULL, p_new_attribute3),
           DECODE( p_old_attribute4, fnd_api.g_miss_char, NULL, p_old_attribute4),
           DECODE( p_new_attribute4, fnd_api.g_miss_char, NULL, p_new_attribute4),
           DECODE( p_old_attribute5, fnd_api.g_miss_char, NULL, p_old_attribute5),
           DECODE( p_new_attribute5, fnd_api.g_miss_char, NULL, p_new_attribute5),
           DECODE( p_old_attribute6, fnd_api.g_miss_char, NULL, p_old_attribute6),
           DECODE( p_new_attribute6, fnd_api.g_miss_char, NULL, p_new_attribute6),
           DECODE( p_old_attribute7, fnd_api.g_miss_char, NULL, p_old_attribute7),
           DECODE( p_new_attribute7, fnd_api.g_miss_char, NULL, p_new_attribute7),
           DECODE( p_old_attribute8, fnd_api.g_miss_char, NULL, p_old_attribute8),
           DECODE( p_new_attribute8, fnd_api.g_miss_char, NULL, p_new_attribute8),
           DECODE( p_old_attribute9, fnd_api.g_miss_char, NULL, p_old_attribute9),
           DECODE( p_new_attribute9, fnd_api.g_miss_char, NULL, p_new_attribute9),
           DECODE( p_old_attribute10, fnd_api.g_miss_char, NULL, p_old_attribute10),
           DECODE( p_new_attribute10, fnd_api.g_miss_char, NULL, p_new_attribute10),
           DECODE( p_old_attribute11, fnd_api.g_miss_char, NULL, p_old_attribute11),
           DECODE( p_new_attribute11, fnd_api.g_miss_char, NULL, p_new_attribute11),
           DECODE( p_old_attribute12, fnd_api.g_miss_char, NULL, p_old_attribute12),
           DECODE( p_new_attribute12, fnd_api.g_miss_char, NULL, p_new_attribute12),
           DECODE( p_old_attribute13, fnd_api.g_miss_char, NULL, p_old_attribute13),
           DECODE( p_new_attribute13, fnd_api.g_miss_char, NULL, p_new_attribute13),
           DECODE( p_old_attribute14, fnd_api.g_miss_char, NULL, p_old_attribute14),
           DECODE( p_new_attribute14, fnd_api.g_miss_char, NULL, p_new_attribute14),
           DECODE( p_old_attribute15, fnd_api.g_miss_char, NULL, p_old_attribute15),
           DECODE( p_new_attribute15, fnd_api.g_miss_char, NULL, p_new_attribute15),
           DECODE( p_full_dump_flag, fnd_api.g_miss_char, NULL, p_full_dump_flag),
           DECODE( p_created_by, fnd_api.g_miss_num, NULL, p_created_by),
           DECODE( p_creation_date, fnd_api.g_miss_date, TO_DATE(NULL), p_creation_date),
           DECODE( p_last_updated_by, fnd_api.g_miss_num, NULL, p_last_updated_by),
           DECODE( p_last_update_date, fnd_api.g_miss_date, TO_DATE(NULL), p_last_update_date),
           DECODE( p_last_update_login, fnd_api.g_miss_num, NULL, p_last_update_login),
           DECODE( p_object_version_number, fnd_api.g_miss_num, NULL, p_object_version_number));
END insert_row;


PROCEDURE update_row(
          p_relationship_history_id           NUMBER  ,
          p_relationship_id                   NUMBER  ,
          p_transaction_id                    NUMBER  ,
          p_old_subject_id                    NUMBER  ,
          p_new_subject_id                    NUMBER  ,
          p_old_position_reference            VARCHAR2,
          p_new_position_reference            VARCHAR2,
          p_old_active_start_date             DATE    ,
          p_new_active_start_date             DATE    ,
          p_old_active_end_date               DATE    ,
          p_new_active_end_date               DATE    ,
          p_old_mandatory_flag                VARCHAR2,
          p_new_mandatory_flag                VARCHAR2,
          p_old_context                       VARCHAR2,
          p_new_context                       VARCHAR2,
          p_old_attribute1                    VARCHAR2,
          p_new_attribute1                    VARCHAR2,
          p_old_attribute2                    VARCHAR2,
          p_new_attribute2                    VARCHAR2,
          p_old_attribute3                    VARCHAR2,
          p_new_attribute3                    VARCHAR2,
          p_old_attribute4                    VARCHAR2,
          p_new_attribute4                    VARCHAR2,
          p_old_attribute5                    VARCHAR2,
          p_new_attribute5                    VARCHAR2,
          p_old_attribute6                    VARCHAR2,
          p_new_attribute6                    VARCHAR2,
          p_old_attribute7                    VARCHAR2,
          p_new_attribute7                    VARCHAR2,
          p_old_attribute8                    VARCHAR2,
          p_new_attribute8                    VARCHAR2,
          p_old_attribute9                    VARCHAR2,
          p_new_attribute9                    VARCHAR2,
          p_old_attribute10                   VARCHAR2,
          p_new_attribute10                   VARCHAR2,
          p_old_attribute11                   VARCHAR2,
          p_new_attribute11                   VARCHAR2,
          p_old_attribute12                   VARCHAR2,
          p_new_attribute12                   VARCHAR2,
          p_old_attribute13                   VARCHAR2,
          p_new_attribute13                   VARCHAR2,
          p_old_attribute14                   VARCHAR2,
          p_new_attribute14                   VARCHAR2,
          p_old_attribute15                   VARCHAR2,
          p_new_attribute15                   VARCHAR2,
          p_full_dump_flag                    VARCHAR2,
          p_created_by                        NUMBER  ,
          p_creation_date                     DATE    ,
          p_last_updated_by                   NUMBER  ,
          p_last_update_date                  DATE    ,
          p_last_update_login                 NUMBER  ,
          p_object_version_number             NUMBER  )

 IS
 BEGIN
    UPDATE csi_ii_relationships_h
    SET
              relationship_id = DECODE( p_relationship_id, fnd_api.g_miss_num, relationship_id, p_relationship_id),
              transaction_id = DECODE( p_transaction_id, fnd_api.g_miss_num, transaction_id, p_transaction_id),
              old_subject_id = DECODE( p_old_subject_id, fnd_api.g_miss_num, old_subject_id, p_old_subject_id),
              new_subject_id = DECODE( p_new_subject_id, fnd_api.g_miss_num, new_subject_id, p_new_subject_id),
              old_position_reference = DECODE( p_old_position_reference, fnd_api.g_miss_char, old_position_reference, p_old_position_reference),
              new_position_reference = DECODE( p_new_position_reference, fnd_api.g_miss_char, new_position_reference, p_new_position_reference),
              old_active_start_date = DECODE( p_old_active_start_date, fnd_api.g_miss_date, old_active_start_date, p_old_active_start_date),
              new_active_start_date = DECODE( p_new_active_start_date, fnd_api.g_miss_date, new_active_start_date, p_new_active_start_date),
              old_active_end_date = DECODE( p_old_active_end_date, fnd_api.g_miss_date, old_active_end_date, p_old_active_end_date),
              new_active_end_date = DECODE( p_new_active_end_date, fnd_api.g_miss_date, new_active_end_date, p_new_active_end_date),
              old_mandatory_flag = DECODE( p_old_mandatory_flag, fnd_api.g_miss_char, old_mandatory_flag, p_old_mandatory_flag),
              new_mandatory_flag = DECODE( p_new_mandatory_flag, fnd_api.g_miss_char, new_mandatory_flag, p_new_mandatory_flag),
              old_context = DECODE( p_old_context, fnd_api.g_miss_char, old_context, p_old_context),
              new_context = DECODE( p_new_context, fnd_api.g_miss_char, new_context, p_new_context),
              old_attribute1 = DECODE( p_old_attribute1, fnd_api.g_miss_char, old_attribute1, p_old_attribute1),
              new_attribute1 = DECODE( p_new_attribute1, fnd_api.g_miss_char, new_attribute1, p_new_attribute1),
              old_attribute2 = DECODE( p_old_attribute2, fnd_api.g_miss_char, old_attribute2, p_old_attribute2),
              new_attribute2 = DECODE( p_new_attribute2, fnd_api.g_miss_char, new_attribute2, p_new_attribute2),
              old_attribute3 = DECODE( p_old_attribute3, fnd_api.g_miss_char, old_attribute3, p_old_attribute3),
              new_attribute3 = DECODE( p_new_attribute3, fnd_api.g_miss_char, new_attribute3, p_new_attribute3),
              old_attribute4 = DECODE( p_old_attribute4, fnd_api.g_miss_char, old_attribute4, p_old_attribute4),
              new_attribute4 = DECODE( p_new_attribute4, fnd_api.g_miss_char, new_attribute4, p_new_attribute4),
              old_attribute5 = DECODE( p_old_attribute5, fnd_api.g_miss_char, old_attribute5, p_old_attribute5),
              new_attribute5 = DECODE( p_new_attribute5, fnd_api.g_miss_char, new_attribute5, p_new_attribute5),
              old_attribute6 = DECODE( p_old_attribute6, fnd_api.g_miss_char, old_attribute6, p_old_attribute6),
              new_attribute6 = DECODE( p_new_attribute6, fnd_api.g_miss_char, new_attribute6, p_new_attribute6),
              old_attribute7 = DECODE( p_old_attribute7, fnd_api.g_miss_char, old_attribute7, p_old_attribute7),
              new_attribute7 = DECODE( p_new_attribute7, fnd_api.g_miss_char, new_attribute7, p_new_attribute7),
              old_attribute8 = DECODE( p_old_attribute8, fnd_api.g_miss_char, old_attribute8, p_old_attribute8),
              new_attribute8 = DECODE( p_new_attribute8, fnd_api.g_miss_char, new_attribute8, p_new_attribute8),
              old_attribute9 = DECODE( p_old_attribute9, fnd_api.g_miss_char, old_attribute9, p_old_attribute9),
              new_attribute9 = DECODE( p_new_attribute9, fnd_api.g_miss_char, new_attribute9, p_new_attribute9),
              old_attribute10 = DECODE( p_old_attribute10, fnd_api.g_miss_char, old_attribute10, p_old_attribute10),
              new_attribute10 = DECODE( p_new_attribute10, fnd_api.g_miss_char, new_attribute10, p_new_attribute10),
              old_attribute11 = DECODE( p_old_attribute11, fnd_api.g_miss_char, old_attribute11, p_old_attribute11),
              new_attribute11 = DECODE( p_new_attribute11, fnd_api.g_miss_char, new_attribute11, p_new_attribute11),
              old_attribute12 = DECODE( p_old_attribute12, fnd_api.g_miss_char, old_attribute12, p_old_attribute12),
              new_attribute12 = DECODE( p_new_attribute12, fnd_api.g_miss_char, new_attribute12, p_new_attribute12),
              old_attribute13 = DECODE( p_old_attribute13, fnd_api.g_miss_char, old_attribute13, p_old_attribute13),
              new_attribute13 = DECODE( p_new_attribute13, fnd_api.g_miss_char, new_attribute13, p_new_attribute13),
              old_attribute14 = DECODE( p_old_attribute14, fnd_api.g_miss_char, old_attribute14, p_old_attribute14),
              new_attribute14 = DECODE( p_new_attribute14, fnd_api.g_miss_char, new_attribute14, p_new_attribute14),
              old_attribute15 = DECODE( p_old_attribute15, fnd_api.g_miss_char, old_attribute15, p_old_attribute15),
              new_attribute15 = DECODE( p_new_attribute15, fnd_api.g_miss_char, new_attribute15, p_new_attribute15),
              full_dump_flag = DECODE( p_full_dump_flag, fnd_api.g_miss_char, full_dump_flag, p_full_dump_flag),
              created_by = DECODE( p_created_by, fnd_api.g_miss_num, created_by, p_created_by),
              creation_date = DECODE( p_creation_date, fnd_api.g_miss_date, creation_date, p_creation_date),
              last_updated_by = DECODE( p_last_updated_by, fnd_api.g_miss_num, last_updated_by, p_last_updated_by),
              last_update_date = DECODE( p_last_update_date, fnd_api.g_miss_date, last_update_date, p_last_update_date),
              last_update_login = DECODE( p_last_update_login, fnd_api.g_miss_num, last_update_login, p_last_update_login),
              --object_version_number = DECODE( p_object_version_number, fnd_api.g_miss_num, object_version_number, p_object_version_number)
              object_version_number = object_version_number + 1
    WHERE relationship_history_id = p_relationship_history_id;

    IF (SQL%NOTFOUND) THEN
        RAISE NO_DATA_FOUND;
    END IF;
END Update_Row;

END csi_ii_relationships_h_pkg;

/
