--------------------------------------------------------
--  DDL for Package Body FA_FAS811_XMLP_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."FA_FAS811_XMLP_PKG" AS
/* $Header: FAS811B.pls 120.0.12010000.1 2008/07/28 13:15:36 appldev ship $ */
  FUNCTION REPORT_NAMEFORMULA(COMPANY_NAME IN VARCHAR2
                             ,C_CAT_FORMATTED IN VARCHAR2) RETURN VARCHAR2 IS
  BEGIN
    DECLARE
      L_REPORT_NAME VARCHAR2(80);
    BEGIN
      RP_COMPANY_NAME := COMPANY_NAME;
      C_CATEGORY := C_CAT_FORMATTED;
      SELECT
        CP.USER_CONCURRENT_PROGRAM_NAME
      INTO
        L_REPORT_NAME
      FROM
        FND_CONCURRENT_PROGRAMS_VL CP,
        FND_CONCURRENT_REQUESTS CR
      WHERE CR.REQUEST_ID = P_CONC_REQUEST_ID
        AND CP.APPLICATION_ID = CR.PROGRAM_APPLICATION_ID
        AND CP.CONCURRENT_PROGRAM_ID = CR.CONCURRENT_PROGRAM_ID;
      l_report_name := substr(l_report_name,1,instr(l_report_name,' (XML)'));
      RP_REPORT_NAME := L_REPORT_NAME;
      RETURN (L_REPORT_NAME);
    EXCEPTION
      WHEN OTHERS THEN
        RP_REPORT_NAME := 'MASS TRANSFERS PREVIEW REPORT';
        RETURN ('MASS TRANSFERS PREVIEW REPORT');
    END;
    RETURN NULL;
  END REPORT_NAMEFORMULA;
  FUNCTION AFTERREPORT RETURN BOOLEAN IS
  BEGIN
    RETURN (TRUE);
  END AFTERREPORT;
  FUNCTION FROM_GL_CONDFORMULA(FROM_GL_CCID IN NUMBER) RETURN VARCHAR2 IS
  BEGIN
    IF (FROM_GL_CCID IS NULL) THEN
      RETURN ('1=1');
    ELSE
      RETURN ('DH.Code_Combination_ID = ' || TO_CHAR(FROM_GL_CCID));
    END IF;
    RETURN NULL;
  END FROM_GL_CONDFORMULA;
  FUNCTION FROM_LOC_CONDFORMULA(FROM_LOCATION_ID IN NUMBER) RETURN VARCHAR2 IS
  BEGIN
    IF (FROM_LOCATION_ID IS NULL) THEN
    From_Loc_Cond:='1=1';
      RETURN ('1=1');
    ELSE
    From_Loc_Cond:='DH.Location_ID = ' || TO_CHAR(FROM_LOCATION_ID);
      RETURN ('DH.Location_ID = ' || TO_CHAR(FROM_LOCATION_ID));
    END IF;
    RETURN NULL;
  END FROM_LOC_CONDFORMULA;
  FUNCTION FROM_EMP_CONDFORMULA(FROM_EMPLOYEE_ID IN NUMBER) RETURN VARCHAR2 IS
  BEGIN
    IF (FROM_EMPLOYEE_ID IS NULL) THEN
    From_Emp_Cond:='and 1=1';
      RETURN ('1=1');
    ELSE
     From_Emp_Cond:='DH.Assigned_To = ' || TO_CHAR(FROM_EMPLOYEE_ID);
      RETURN ('DH.Assigned_To = ' || TO_CHAR(FROM_EMPLOYEE_ID));
    END IF;
    RETURN NULL;
  END FROM_EMP_CONDFORMULA;
  FUNCTION C_BREAKFORMULA RETURN NUMBER IS
  BEGIN
    RETURN (1);
  END C_BREAKFORMULA;
  FUNCTION CP_1FORMULA RETURN NUMBER IS
  BEGIN
    RETURN (100);
  END CP_1FORMULA;
  FUNCTION ACCT_BAL_APROMPT_P RETURN VARCHAR2 IS
  BEGIN
    RETURN ACCT_BAL_APROMPT;
  END ACCT_BAL_APROMPT_P;
  FUNCTION ACCT_CC_APROMPT_P RETURN VARCHAR2 IS
  BEGIN
    RETURN ACCT_CC_APROMPT;
  END ACCT_CC_APROMPT_P;
  FUNCTION CAT_MAJ_RPROMPT_P RETURN VARCHAR2 IS
  BEGIN
    RETURN CAT_MAJ_RPROMPT;
  END CAT_MAJ_RPROMPT_P;
  FUNCTION CP_100_P RETURN NUMBER IS
  BEGIN
    RETURN CP_100;
  END CP_100_P;
  FUNCTION RP_COMPANY_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN RP_COMPANY_NAME;
  END RP_COMPANY_NAME_P;
  FUNCTION RP_REPORT_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN RP_REPORT_NAME;
  END RP_REPORT_NAME_P;
  FUNCTION C_CATEGORY_P RETURN VARCHAR2 IS
  BEGIN
    RETURN C_CATEGORY;
  END C_CATEGORY_P;
  --added
  function BeforeReport return boolean is
begin
  P_CONC_REQUEST_ID := FND_GLOBAL.CONC_REQUEST_ID;
SELECT
SUBSTR(ARGUMENT1,INSTR(ARGUMENT1,'"',1,1)+1,(INSTR(ARGUMENT1,'"',1,2)-INSTR(ARGUMENT1,'"',1,1) -1)),
SUBSTR(ARGUMENT2,INSTR(ARGUMENT2,'"',1,1)+1,INSTR(ARGUMENT2,'"',1,2)-INSTR(ARGUMENT2,'"',1,1) -1)
into P_BOOK1,P_MASS_TRANSFER_ID1
FROM FND_CONCURRENT_REQUESTS
WHERE REQUEST_ID =P_CONC_REQUEST_ID;
/*SRW.USER_EXIT('FND SRWINIT');
select category_flex_structure
into :P_CAT_FLEX_STRUCT
from fa_system_controls;
SRW.USER_EXIT('FND FLEXSQL CODE="CAT#"
                           NUM=":P_CAT_FLEX_STRUCT"
                           APPL_SHORT_NAME="OFA"
                           TABLEALIAS="cat"
                           OUTPUT=":P_CAT_SEGS"
                           MODE="SELECT"
                           DISPLAY="ALL"');*/
  return (TRUE);
end;
END FA_FAS811_XMLP_PKG;


/
