--------------------------------------------------------
--  DDL for Package Body JTY_TRANS_USG_PGM_DETAILS_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."JTY_TRANS_USG_PGM_DETAILS_PKG" as
/* $Header: jtftupdb.pls 120.1 2005/11/18 11:37:23 achanda noship $ */

PROCEDURE Insert_Row(
              X_ROW_ID                           IN OUT NOCOPY VARCHAR2,
              X_TRANS_USG_PGM_DETAILS_ID         IN OUT NOCOPY NUMBER,
              P_SOURCE_ID                        IN NUMBER,
              P_TRANS_TYPE_ID                    IN NUMBER,
              P_PROGRAM_NAME                     IN VARCHAR2,
              P_LAST_UPDATE_DATE                 IN DATE,
              P_LAST_UPDATED_BY                  IN NUMBER,
              P_CREATION_DATE                    IN DATE,
              P_CREATED_BY                       IN NUMBER,
              P_LAST_UPDATE_LOGIN                IN NUMBER,
              P_PARAM_PASSING_MECHANISM          IN VARCHAR2,
              P_REAL_TIME_ENABLE_FLAG            IN VARCHAR2,
              P_BATCH_ENABLE_FLAG                IN VARCHAR2,
              P_MULTI_LEVEL_WINNING_FLAG         IN VARCHAR2,
              P_REAL_TIME_TRANS_TABLE            IN VARCHAR2,
              P_BATCH_TRANS_TABLE                IN VARCHAR2,
              P_BATCH_NM_TRANS_TABLE             IN VARCHAR2,
              P_BATCH_DEA_TRANS_TABLE            IN VARCHAR2,
              P_BATCH_MATCH_TABLE                IN VARCHAR2,
              P_BATCH_UNIQUE_MATCH_TABLE         IN VARCHAR2,
              P_BATCH_WINNER_TABLE               IN VARCHAR2,
              P_BATCH_UNIQUE_WINNER_TABLE        IN VARCHAR2,
              P_BATCH_L1_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L2_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L3_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L4_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L5_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_WT_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_MP_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_DMC_WINNER_TABLE           IN VARCHAR2,
              P_INDEX_EXTN                       IN VARCHAR2) IS

   CURSOR C1 IS
   SELECT rowid
   FROM JTY_TRANS_USG_PGM_DETAILS
   WHERE TRANS_USG_PGM_DETAILS_ID = X_TRANS_USG_PGM_DETAILS_ID;

   CURSOR C2 IS SELECT jty_trans_usg_pgm_details_s.nextval FROM sys.dual;

BEGIN
   If (X_TRANS_USG_PGM_DETAILS_ID IS NULL) then
       OPEN C2;
       FETCH C2 INTO X_TRANS_USG_PGM_DETAILS_ID;
       CLOSE C2;
   End If;

   INSERT INTO JTY_TRANS_USG_PGM_DETAILS(
           TRANS_USG_PGM_DETAILS_ID,
           SOURCE_ID,
           TRANS_TYPE_ID,
           PROGRAM_NAME,
           LAST_UPDATE_DATE,
           LAST_UPDATED_BY,
           CREATION_DATE,
           CREATED_BY,
           LAST_UPDATE_LOGIN,
           PARAM_PASSING_MECHANISM,
           REAL_TIME_ENABLE_FLAG,
           BATCH_ENABLE_FLAG,
           MULTI_LEVEL_WINNING_FLAG,
           REAL_TIME_TRANS_TABLE_NAME,
           BATCH_TRANS_TABLE_NAME,
           BATCH_NM_TRANS_TABLE_NAME,
           BATCH_DEA_TRANS_TABLE_NAME,
           BATCH_MATCH_TABLE_NAME,
           BATCH_UNIQUE_MATCH_TABLE_NAME,
           BATCH_WINNER_TABLE_NAME,
           BATCH_UNIQUE_WINNER_TABLE_NAME,
           BATCH_L1_WINNER_TABLE_NAME,
           BATCH_L2_WINNER_TABLE_NAME,
           BATCH_L3_WINNER_TABLE_NAME,
           BATCH_L4_WINNER_TABLE_NAME,
           BATCH_L5_WINNER_TABLE_NAME,
           BATCH_WT_WINNER_TABLE_NAME,
           BATCH_MP_WINNER_TABLE_NAME,
           BATCH_DMC_WINNER_TABLE_NAME,
           INDEX_EXTN)
   VALUES  (X_TRANS_USG_PGM_DETAILS_ID,
            decode( P_SOURCE_ID, FND_API.G_MISS_NUM, NULL, P_SOURCE_ID),
            decode( P_TRANS_TYPE_ID, FND_API.G_MISS_NUM, NULL, P_TRANS_TYPE_ID),
            decode( P_PROGRAM_NAME, FND_API.G_MISS_CHAR, NULL,P_PROGRAM_NAME),
            decode( P_LAST_UPDATE_DATE, FND_API.G_MISS_DATE, TO_DATE(NULL),P_LAST_UPDATE_DATE),
            decode( P_LAST_UPDATED_BY, FND_API.G_MISS_NUM, NULL,P_LAST_UPDATED_BY),
            decode( P_CREATION_DATE, FND_API.G_MISS_DATE, TO_DATE(NULL),P_CREATION_DATE),
            decode( P_CREATED_BY, FND_API.G_MISS_NUM, NULL,P_CREATED_BY),
            decode( P_LAST_UPDATE_LOGIN, FND_API.G_MISS_NUM, NULL,P_LAST_UPDATE_LOGIN),
            decode( P_PARAM_PASSING_MECHANISM, FND_API.G_MISS_CHAR, NULL,P_PARAM_PASSING_MECHANISM),
            decode( P_REAL_TIME_ENABLE_FLAG, FND_API.G_MISS_CHAR, NULL,P_REAL_TIME_ENABLE_FLAG),
            decode( P_BATCH_ENABLE_FLAG, FND_API.G_MISS_CHAR, NULL,P_BATCH_ENABLE_FLAG),
            decode( P_MULTI_LEVEL_WINNING_FLAG, FND_API.G_MISS_CHAR, NULL,P_MULTI_LEVEL_WINNING_FLAG),
            decode( P_REAL_TIME_TRANS_TABLE, FND_API.G_MISS_CHAR, NULL,P_REAL_TIME_TRANS_TABLE),
            decode( P_BATCH_TRANS_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_TRANS_TABLE),
            decode( P_BATCH_NM_TRANS_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_NM_TRANS_TABLE),
            decode( P_BATCH_DEA_TRANS_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_DEA_TRANS_TABLE),
            decode( P_BATCH_MATCH_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_MATCH_TABLE),
            decode( P_BATCH_UNIQUE_MATCH_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_UNIQUE_MATCH_TABLE),
            decode( P_BATCH_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_WINNER_TABLE),
            decode( P_BATCH_UNIQUE_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_UNIQUE_WINNER_TABLE),
            decode( P_BATCH_L1_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_L1_WINNER_TABLE),
            decode( P_BATCH_L2_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_L2_WINNER_TABLE),
            decode( P_BATCH_L3_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_L3_WINNER_TABLE),
            decode( P_BATCH_L4_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_L4_WINNER_TABLE),
            decode( P_BATCH_L5_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_L5_WINNER_TABLE),
            decode( P_BATCH_WT_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_WT_WINNER_TABLE),
            decode( P_BATCH_MP_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_MP_WINNER_TABLE),
            decode( P_BATCH_DMC_WINNER_TABLE, FND_API.G_MISS_CHAR, NULL,P_BATCH_DMC_WINNER_TABLE),
            decode( P_INDEX_EXTN, FND_API.G_MISS_CHAR, NULL,P_INDEX_EXTN));

   OPEN C1;
   FETCH C1 INTO X_Row_id;
   If (C1%NOTFOUND) then
       CLOSE C1;
       RAISE NO_DATA_FOUND;
   End If;
End Insert_Row;

PROCEDURE Update_Row(
              P_ROW_ID                           IN VARCHAR2,
              P_TRANS_USG_PGM_DETAILS_ID         IN NUMBER,
              P_SOURCE_ID                        IN NUMBER,
              P_TRANS_TYPE_ID                    IN NUMBER,
              P_PROGRAM_NAME                     IN VARCHAR2,
              P_LAST_UPDATE_DATE                 IN DATE,
              P_LAST_UPDATED_BY                  IN NUMBER,
              P_CREATION_DATE                    IN DATE,
              P_CREATED_BY                       IN NUMBER,
              P_LAST_UPDATE_LOGIN                IN NUMBER,
              P_PARAM_PASSING_MECHANISM          IN VARCHAR2,
              P_REAL_TIME_ENABLE_FLAG            IN VARCHAR2,
              P_BATCH_ENABLE_FLAG                IN VARCHAR2,
              P_MULTI_LEVEL_WINNING_FLAG         IN VARCHAR2,
              P_REAL_TIME_TRANS_TABLE            IN VARCHAR2,
              P_BATCH_TRANS_TABLE                IN VARCHAR2,
              P_BATCH_NM_TRANS_TABLE             IN VARCHAR2,
              P_BATCH_DEA_TRANS_TABLE            IN VARCHAR2,
              P_BATCH_MATCH_TABLE                IN VARCHAR2,
              P_BATCH_UNIQUE_MATCH_TABLE         IN VARCHAR2,
              P_BATCH_WINNER_TABLE               IN VARCHAR2,
              P_BATCH_UNIQUE_WINNER_TABLE        IN VARCHAR2,
              P_BATCH_L1_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L2_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L3_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L4_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_L5_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_WT_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_MP_WINNER_TABLE            IN VARCHAR2,
              P_BATCH_DMC_WINNER_TABLE           IN VARCHAR2,
              P_INDEX_EXTN                       IN VARCHAR2) IS
BEGIN
   Update JTY_TRANS_USG_PGM_DETAILS
   SET
   SOURCE_ID = decode(P_SOURCE_ID, FND_API.G_MISS_NUM, SOURCE_ID, P_SOURCE_ID),
   TRANS_TYPE_ID = decode(P_TRANS_TYPE_ID, FND_API.G_MISS_NUM, TRANS_TYPE_ID, P_TRANS_TYPE_ID),
   PROGRAM_NAME = decode(P_PROGRAM_NAME, FND_API.G_MISS_CHAR, PROGRAM_NAME, P_PROGRAM_NAME),
   LAST_UPDATE_DATE = decode(P_LAST_UPDATE_DATE, FND_API.G_MISS_DATE, LAST_UPDATE_DATE, P_LAST_UPDATE_DATE),
   LAST_UPDATED_BY = decode(P_LAST_UPDATED_BY, FND_API.G_MISS_NUM, LAST_UPDATED_BY, P_LAST_UPDATED_BY),
   CREATION_DATE = decode(P_CREATION_DATE, FND_API.G_MISS_DATE, CREATION_DATE, P_CREATION_DATE),
   CREATED_BY = decode(P_CREATED_BY, FND_API.G_MISS_NUM, CREATED_BY, P_CREATED_BY),
   LAST_UPDATE_LOGIN = decode(P_LAST_UPDATE_LOGIN, FND_API.G_MISS_NUM, LAST_UPDATE_LOGIN, P_LAST_UPDATE_LOGIN),
   PARAM_PASSING_MECHANISM = decode(P_PARAM_PASSING_MECHANISM,FND_API.G_MISS_CHAR,
                                    PARAM_PASSING_MECHANISM,P_PARAM_PASSING_MECHANISM),
   REAL_TIME_ENABLE_FLAG = decode(P_REAL_TIME_ENABLE_FLAG, FND_API.G_MISS_CHAR, REAL_TIME_ENABLE_FLAG, P_REAL_TIME_ENABLE_FLAG),
   BATCH_ENABLE_FLAG = decode(P_BATCH_ENABLE_FLAG, FND_API.G_MISS_CHAR, BATCH_ENABLE_FLAG, P_BATCH_ENABLE_FLAG),
   MULTI_LEVEL_WINNING_FLAG = decode(P_MULTI_LEVEL_WINNING_FLAG,FND_API.G_MISS_CHAR,
                                     MULTI_LEVEL_WINNING_FLAG,P_MULTI_LEVEL_WINNING_FLAG),
   REAL_TIME_TRANS_TABLE_NAME = decode(P_REAL_TIME_TRANS_TABLE, FND_API.G_MISS_CHAR,
                                       REAL_TIME_TRANS_TABLE_NAME, P_REAL_TIME_TRANS_TABLE),
   BATCH_TRANS_TABLE_NAME = decode(P_BATCH_TRANS_TABLE, FND_API.G_MISS_CHAR, BATCH_TRANS_TABLE_NAME, P_BATCH_TRANS_TABLE),
   BATCH_NM_TRANS_TABLE_NAME = decode(P_BATCH_NM_TRANS_TABLE, FND_API.G_MISS_CHAR,
                                      BATCH_NM_TRANS_TABLE_NAME, P_BATCH_NM_TRANS_TABLE),
   BATCH_DEA_TRANS_TABLE_NAME = decode(P_BATCH_DEA_TRANS_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_DEA_TRANS_TABLE_NAME, P_BATCH_DEA_TRANS_TABLE),
   BATCH_MATCH_TABLE_NAME = decode(P_BATCH_MATCH_TABLE, FND_API.G_MISS_CHAR, BATCH_MATCH_TABLE_NAME, P_BATCH_MATCH_TABLE),
   BATCH_UNIQUE_MATCH_TABLE_NAME = decode(P_BATCH_UNIQUE_MATCH_TABLE,FND_API.G_MISS_CHAR,
                                          BATCH_UNIQUE_MATCH_TABLE_NAME,P_BATCH_UNIQUE_MATCH_TABLE),
   BATCH_WINNER_TABLE_NAME = decode(P_BATCH_WINNER_TABLE, FND_API.G_MISS_CHAR, BATCH_WINNER_TABLE_NAME, P_BATCH_WINNER_TABLE),
   BATCH_UNIQUE_WINNER_TABLE_NAME = decode(P_BATCH_UNIQUE_WINNER_TABLE,FND_API.G_MISS_CHAR,
                                           BATCH_UNIQUE_WINNER_TABLE_NAME,P_BATCH_UNIQUE_WINNER_TABLE),
   BATCH_L1_WINNER_TABLE_NAME = decode(P_BATCH_L1_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_L1_WINNER_TABLE_NAME, P_BATCH_L1_WINNER_TABLE),
   BATCH_L2_WINNER_TABLE_NAME = decode(P_BATCH_L2_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_L2_WINNER_TABLE_NAME, P_BATCH_L2_WINNER_TABLE),
   BATCH_L3_WINNER_TABLE_NAME = decode(P_BATCH_L3_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_L3_WINNER_TABLE_NAME, P_BATCH_L3_WINNER_TABLE),
   BATCH_L4_WINNER_TABLE_NAME = decode(P_BATCH_L4_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_L4_WINNER_TABLE_NAME, P_BATCH_L4_WINNER_TABLE),
   BATCH_L5_WINNER_TABLE_NAME = decode(P_BATCH_L5_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_L5_WINNER_TABLE_NAME, P_BATCH_L5_WINNER_TABLE),
   BATCH_WT_WINNER_TABLE_NAME = decode(P_BATCH_WT_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_WT_WINNER_TABLE_NAME, P_BATCH_WT_WINNER_TABLE),
   BATCH_MP_WINNER_TABLE_NAME = decode(P_BATCH_MP_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_MP_WINNER_TABLE_NAME, P_BATCH_MP_WINNER_TABLE),
   BATCH_DMC_WINNER_TABLE_NAME = decode(P_BATCH_DMC_WINNER_TABLE, FND_API.G_MISS_CHAR,
                                       BATCH_DMC_WINNER_TABLE_NAME, P_BATCH_DMC_WINNER_TABLE),
   INDEX_EXTN = decode(P_INDEX_EXTN, FND_API.G_MISS_CHAR,
                                       INDEX_EXTN, P_INDEX_EXTN)
   where TRANS_USG_PGM_DETAILS_ID = P_TRANS_USG_PGM_DETAILS_ID;

   If (SQL%NOTFOUND) then
      RAISE NO_DATA_FOUND;
   End If;
END Update_Row;

PROCEDURE Delete_Row(P_TRANS_USG_PGM_DETAILS_ID IN NUMBER) IS
BEGIN
   DELETE FROM JTY_TRANS_USG_PGM_DETAILS
   WHERE TRANS_USG_PGM_DETAILS_ID = P_TRANS_USG_PGM_DETAILS_ID;
   If (SQL%NOTFOUND) then
      RAISE NO_DATA_FOUND;
   End If;
END Delete_Row;

END JTY_TRANS_USG_PGM_DETAILS_PKG;

/
