--------------------------------------------------------
--  DDL for Package Body AR_EBI_INVOICE_PUB
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."AR_EBI_INVOICE_PUB" AS
/* $Header: AREIINVB.pls 120.2.12010000.6 2009/02/17 11:05:42 rsamanta noship $ */

/************************************************************************************
 --     API name        : ar_get_trx_type
 --     Type            : Private
 --     Function        :
 --     This API is used to querry transaction type from transaction name
 --
 ************************************************************************************/
PROCEDURE ar_get_trx_type
( p_cust_trx_type_name  IN VARCHAR2
, p_org_id       	IN NUMBER
, x_trx_type        	OUT NOCOPY VARCHAR2
, x_err_msg             OUT NOCOPY VARCHAR2
, x_return_status       OUT NOCOPY VARCHAR2
) AS
CURSOR c_cust_trx_types IS
  SELECT type
  FROM   ra_cust_trx_types_all
  WHERE  name 	= p_cust_trx_type_name
  AND 	 org_id = p_org_id;

BEGIN
  x_return_status := FND_API.G_RET_STS_SUCCESS;
  IF c_cust_trx_types%ISOPEN THEN
    CLOSE c_cust_trx_types;
  END IF;

  OPEN c_cust_trx_types;
  FETCH c_cust_trx_types into x_trx_type;
  IF c_cust_trx_types%NOTFOUND THEN
       x_trx_type := NULL;
  END IF;
  CLOSE c_cust_trx_types;
EXCEPTION
  WHEN OTHERS THEN
    IF c_cust_trx_types%ISOPEN THEN
      CLOSE c_cust_trx_types;
    END IF;
    x_trx_type := NULL;
    x_return_status := FND_API.G_RET_STS_UNEXP_ERROR;
    x_err_msg       := SQLERRM ||' at EBI_AR_PKG.ar_get_trx_type ';
END ar_get_trx_type;

/************************************************************************************
 --     API name        : ar_invoice_submission
 --     Type            : Public
 --     Function        :
 --     This API is used to submit Auto Invoice from AIA Layer
 --
 ************************************************************************************/
PROCEDURE ar_invoice_submission
( p_lines_all           IN AR_EBI_RA_INT_LINES_ALL_LIST
, p_distributions       IN AR_EBI_RA_INT_DIST_LIST
, p_salescredits        IN AR_EBI_RA_INT_SALESCREDIT_LIST
, p_run_autoinvoice_cp  IN VARCHAR2 := FND_API.g_true
, p_commit     		IN VARCHAR2 := FND_API.g_false
, x_conc_req_ids        OUT NOCOPY FND_TABLE_OF_NUMBER
, x_err_msg             OUT NOCOPY VARCHAR2
, x_return_status       OUT NOCOPY VARCHAR2
) AS

l_bill_to_address_id NUMBER;
l_ship_to_address_id NUMBER;
l_payment_term_id    NUMBER;
l_conversion_type    VARCHAR2(30);
l_conversion_date    DATE;
l_conversion_rate    NUMBER;

l_default_bill_to_address_id NUMBER;
l_default_ship_to_address_id NUMBER;
l_default_payment_term_id    NUMBER;
l_default_conversion_type    VARCHAR2(30);
l_default_conversion_date    DATE;
l_default_conversion_rate    NUMBER;

l_msg_count   NUMBER;
l_conc_req_id NUMBER;

l_batch_source_id NUMBER(15);

l_trx_type VARCHAR2(20);
BEGIN
  x_return_status := FND_API.G_RET_STS_SUCCESS;

  SAVEPOINT ar_ebi_invoice_sub_save_pnt;
  FND_MSG_PUB.initialize;

  /* Inserting into ra_interface_lines_all Tables */
  FOR r_lines_all IN
  (SELECT INTERFACE_LINE_ID       ,
    INTERFACE_LINE_CONTEXT        ,
    INTERFACE_LINE_ATTRIBUTE1     ,
    INTERFACE_LINE_ATTRIBUTE2     ,
    INTERFACE_LINE_ATTRIBUTE3     ,
    INTERFACE_LINE_ATTRIBUTE4     ,
    INTERFACE_LINE_ATTRIBUTE5     ,
    INTERFACE_LINE_ATTRIBUTE6     ,
    INTERFACE_LINE_ATTRIBUTE7     ,
    INTERFACE_LINE_ATTRIBUTE8     ,
    BATCH_SOURCE_NAME             ,
    SET_OF_BOOKS_ID               ,
    LINE_TYPE                     ,
    DESCRIPTION                   ,
    CURRENCY_CODE                 ,
    AMOUNT                        ,
    CUST_TRX_TYPE_NAME            ,
    CUST_TRX_TYPE_ID              ,
    TERM_NAME                     ,
    TERM_ID                       ,
    ORIG_SYSTEM_BATCH_NAME        ,
    ORIG_SYSTEM_BILL_CUSTOMER_REF ,
    ORIG_SYSTEM_BILL_CUSTOMER_ID  ,
    ORIG_SYSTEM_BILL_ADDRESS_REF  ,
    ORIG_SYSTEM_BILL_ADDRESS_ID   ,
    ORIG_SYSTEM_BILL_CONTACT_REF  ,
    ORIG_SYSTEM_BILL_CONTACT_ID   ,
    ORIG_SYSTEM_SHIP_CUSTOMER_REF ,
    ORIG_SYSTEM_SHIP_CUSTOMER_ID  ,
    ORIG_SYSTEM_SHIP_ADDRESS_REF  ,
    ORIG_SYSTEM_SHIP_ADDRESS_ID   ,
    ORIG_SYSTEM_SHIP_CONTACT_REF  ,
    ORIG_SYSTEM_SHIP_CONTACT_ID   ,
    ORIG_SYSTEM_SOLD_CUSTOMER_REF ,
    ORIG_SYSTEM_SOLD_CUSTOMER_ID  ,
    LINK_TO_LINE_ID               ,
    LINK_TO_LINE_CONTEXT          ,
    LINK_TO_LINE_ATTRIBUTE1       ,
    LINK_TO_LINE_ATTRIBUTE2       ,
    LINK_TO_LINE_ATTRIBUTE3       ,
    LINK_TO_LINE_ATTRIBUTE4       ,
    LINK_TO_LINE_ATTRIBUTE5       ,
    LINK_TO_LINE_ATTRIBUTE6       ,
    LINK_TO_LINE_ATTRIBUTE7       ,
    RECEIPT_METHOD_NAME           ,
    RECEIPT_METHOD_ID             ,
    CONVERSION_TYPE               ,
    CONVERSION_DATE               ,
    CONVERSION_RATE               ,
    CUSTOMER_TRX_ID               ,
    TRX_DATE                      ,
    GL_DATE                       ,
    DOCUMENT_NUMBER               ,
    TRX_NUMBER                    ,
    LINE_NUMBER                   ,
    QUANTITY                      ,
    QUANTITY_ORDERED              ,
    UNIT_SELLING_PRICE            ,
    UNIT_STANDARD_PRICE           ,
    PRINTING_OPTION               ,
    INTERFACE_STATUS              ,
    REQUEST_ID                    ,
    RELATED_BATCH_SOURCE_NAME     ,
    RELATED_TRX_NUMBER            ,
    RELATED_CUSTOMER_TRX_ID       ,
    PREVIOUS_CUSTOMER_TRX_ID      ,
    CREDIT_METHOD_FOR_ACCT_RULE   ,
    CREDIT_METHOD_FOR_INSTALLMENTS,
    REASON_CODE                   ,
    TAX_RATE                      ,
    TAX_CODE                      ,
    TAX_PRECEDENCE                ,
    EXCEPTION_ID                  ,
    EXEMPTION_ID                  ,
    SHIP_DATE_ACTUAL              ,
    FOB_POINT                     ,
    SHIP_VIA                      ,
    WAYBILL_NUMBER                ,
    INVOICING_RULE_NAME           ,
    INVOICING_RULE_ID             ,
    ACCOUNTING_RULE_NAME          ,
    ACCOUNTING_RULE_ID            ,
    ACCOUNTING_RULE_DURATION      ,
    RULE_START_DATE               ,
    PRIMARY_SALESREP_NUMBER       ,
    PRIMARY_SALESREP_ID           ,
    SALES_ORDER                   ,
    SALES_ORDER_LINE              ,
    SALES_ORDER_DATE              ,
    SALES_ORDER_SOURCE            ,
    SALES_ORDER_REVISION          ,
    PURCHASE_ORDER                ,
    PURCHASE_ORDER_REVISION       ,
    PURCHASE_ORDER_DATE           ,
    AGREEMENT_NAME                ,
    AGREEMENT_ID                  ,
    MEMO_LINE_NAME                ,
    MEMO_LINE_ID                  ,
    INVENTORY_ITEM_ID             ,
    MTL_SYSTEM_ITEMS_SEG1         ,
    MTL_SYSTEM_ITEMS_SEG2         ,
    MTL_SYSTEM_ITEMS_SEG3         ,
    MTL_SYSTEM_ITEMS_SEG4         ,
    MTL_SYSTEM_ITEMS_SEG5         ,
    MTL_SYSTEM_ITEMS_SEG6         ,
    MTL_SYSTEM_ITEMS_SEG7         ,
    MTL_SYSTEM_ITEMS_SEG8         ,
    MTL_SYSTEM_ITEMS_SEG9         ,
    MTL_SYSTEM_ITEMS_SEG10        ,
    MTL_SYSTEM_ITEMS_SEG11        ,
    MTL_SYSTEM_ITEMS_SEG12        ,
    MTL_SYSTEM_ITEMS_SEG13        ,
    MTL_SYSTEM_ITEMS_SEG14        ,
    MTL_SYSTEM_ITEMS_SEG15        ,
    MTL_SYSTEM_ITEMS_SEG16        ,
    MTL_SYSTEM_ITEMS_SEG17        ,
    MTL_SYSTEM_ITEMS_SEG18        ,
    MTL_SYSTEM_ITEMS_SEG19        ,
    MTL_SYSTEM_ITEMS_SEG20        ,
    REFERENCE_LINE_ID             ,
    REFERENCE_LINE_CONTEXT        ,
    REFERENCE_LINE_ATTRIBUTE1     ,
    REFERENCE_LINE_ATTRIBUTE2     ,
    REFERENCE_LINE_ATTRIBUTE3     ,
    REFERENCE_LINE_ATTRIBUTE4     ,
    REFERENCE_LINE_ATTRIBUTE5     ,
    REFERENCE_LINE_ATTRIBUTE6     ,
    REFERENCE_LINE_ATTRIBUTE7     ,
    TERRITORY_ID                  ,
    TERRITORY_SEGMENT1            ,
    TERRITORY_SEGMENT2            ,
    TERRITORY_SEGMENT3            ,
    TERRITORY_SEGMENT4            ,
    TERRITORY_SEGMENT5            ,
    TERRITORY_SEGMENT6            ,
    TERRITORY_SEGMENT7            ,
    TERRITORY_SEGMENT8            ,
    TERRITORY_SEGMENT9            ,
    TERRITORY_SEGMENT10           ,
    TERRITORY_SEGMENT11           ,
    TERRITORY_SEGMENT12           ,
    TERRITORY_SEGMENT13           ,
    TERRITORY_SEGMENT14           ,
    TERRITORY_SEGMENT15           ,
    TERRITORY_SEGMENT16           ,
    TERRITORY_SEGMENT17           ,
    TERRITORY_SEGMENT18           ,
    TERRITORY_SEGMENT19           ,
    TERRITORY_SEGMENT20           ,
    ATTRIBUTE_CATEGORY            ,
    ATTRIBUTE1                    ,
    ATTRIBUTE2                    ,
    ATTRIBUTE3                    ,
    ATTRIBUTE4                    ,
    ATTRIBUTE5                    ,
    ATTRIBUTE6                    ,
    ATTRIBUTE7                    ,
    ATTRIBUTE8                    ,
    ATTRIBUTE9                    ,
    ATTRIBUTE10                   ,
    ATTRIBUTE11                   ,
    ATTRIBUTE12                   ,
    ATTRIBUTE13                   ,
    ATTRIBUTE14                   ,
    ATTRIBUTE15                   ,
    HEADER_ATTRIBUTE_CATEGORY     ,
    HEADER_ATTRIBUTE1             ,
    HEADER_ATTRIBUTE2             ,
    HEADER_ATTRIBUTE3             ,
    HEADER_ATTRIBUTE4             ,
    HEADER_ATTRIBUTE5             ,
    HEADER_ATTRIBUTE6             ,
    HEADER_ATTRIBUTE7             ,
    HEADER_ATTRIBUTE8             ,
    HEADER_ATTRIBUTE9             ,
    HEADER_ATTRIBUTE10            ,
    HEADER_ATTRIBUTE11            ,
    HEADER_ATTRIBUTE12            ,
    HEADER_ATTRIBUTE13            ,
    HEADER_ATTRIBUTE14            ,
    HEADER_ATTRIBUTE15            ,
    COMMENTS                      ,
    INTERNAL_NOTES                ,
    INITIAL_CUSTOMER_TRX_ID       ,
    USSGL_TRANSACTION_CODE_CONTEXT,
    USSGL_TRANSACTION_CODE        ,
    ACCTD_AMOUNT                  ,
    CUSTOMER_BANK_ACCOUNT_ID      ,
    CUSTOMER_BANK_ACCOUNT_NAME    ,
    UOM_CODE                      ,
    UOM_NAME                      ,
    DOCUMENT_NUMBER_SEQUENCE_ID   ,
    LINK_TO_LINE_ATTRIBUTE10      ,
    LINK_TO_LINE_ATTRIBUTE11      ,
    LINK_TO_LINE_ATTRIBUTE12      ,
    LINK_TO_LINE_ATTRIBUTE13      ,
    LINK_TO_LINE_ATTRIBUTE14      ,
    LINK_TO_LINE_ATTRIBUTE15      ,
    LINK_TO_LINE_ATTRIBUTE8       ,
    LINK_TO_LINE_ATTRIBUTE9       ,
    REFERENCE_LINE_ATTRIBUTE10    ,
    REFERENCE_LINE_ATTRIBUTE11    ,
    REFERENCE_LINE_ATTRIBUTE12    ,
    REFERENCE_LINE_ATTRIBUTE13    ,
    REFERENCE_LINE_ATTRIBUTE14    ,
    REFERENCE_LINE_ATTRIBUTE15    ,
    REFERENCE_LINE_ATTRIBUTE8     ,
    REFERENCE_LINE_ATTRIBUTE9     ,
    INTERFACE_LINE_ATTRIBUTE10    ,
    INTERFACE_LINE_ATTRIBUTE11    ,
    INTERFACE_LINE_ATTRIBUTE12    ,
    INTERFACE_LINE_ATTRIBUTE13    ,
    INTERFACE_LINE_ATTRIBUTE14    ,
    INTERFACE_LINE_ATTRIBUTE15    ,
    INTERFACE_LINE_ATTRIBUTE9     ,
    VAT_TAX_ID                    ,
    REASON_CODE_MEANING           ,
    LAST_PERIOD_TO_CREDIT         ,
    PAYING_CUSTOMER_ID            ,
    PAYING_SITE_USE_ID            ,
    TAX_EXEMPT_FLAG               ,
    TAX_EXEMPT_REASON_CODE        ,
    TAX_EXEMPT_REASON_CODE_MEANING,
    TAX_EXEMPT_NUMBER             ,
    SALES_TAX_ID                  ,
    CREATED_BY                    ,
    CREATION_DATE                 ,
    LAST_UPDATED_BY               ,
    LAST_UPDATE_DATE              ,
    LAST_UPDATE_LOGIN             ,
    LOCATION_SEGMENT_ID           ,
    MOVEMENT_ID                   ,
    ORG_ID                        ,
    AMOUNT_INCLUDES_TAX_FLAG      ,
    HEADER_GDF_ATTR_CATEGORY      ,
    HEADER_GDF_ATTRIBUTE1         ,
    HEADER_GDF_ATTRIBUTE2         ,
    HEADER_GDF_ATTRIBUTE3         ,
    HEADER_GDF_ATTRIBUTE4         ,
    HEADER_GDF_ATTRIBUTE5         ,
    HEADER_GDF_ATTRIBUTE6         ,
    HEADER_GDF_ATTRIBUTE7         ,
    HEADER_GDF_ATTRIBUTE8         ,
    HEADER_GDF_ATTRIBUTE9         ,
    HEADER_GDF_ATTRIBUTE10        ,
    HEADER_GDF_ATTRIBUTE11        ,
    HEADER_GDF_ATTRIBUTE12        ,
    HEADER_GDF_ATTRIBUTE13        ,
    HEADER_GDF_ATTRIBUTE14        ,
    HEADER_GDF_ATTRIBUTE15        ,
    HEADER_GDF_ATTRIBUTE16        ,
    HEADER_GDF_ATTRIBUTE17        ,
    HEADER_GDF_ATTRIBUTE18        ,
    HEADER_GDF_ATTRIBUTE19        ,
    HEADER_GDF_ATTRIBUTE20        ,
    HEADER_GDF_ATTRIBUTE21        ,
    HEADER_GDF_ATTRIBUTE22        ,
    HEADER_GDF_ATTRIBUTE23        ,
    HEADER_GDF_ATTRIBUTE24        ,
    HEADER_GDF_ATTRIBUTE25        ,
    HEADER_GDF_ATTRIBUTE26        ,
    HEADER_GDF_ATTRIBUTE27        ,
    HEADER_GDF_ATTRIBUTE28        ,
    HEADER_GDF_ATTRIBUTE29        ,
    HEADER_GDF_ATTRIBUTE30        ,
    LINE_GDF_ATTR_CATEGORY        ,
    LINE_GDF_ATTRIBUTE1           ,
    LINE_GDF_ATTRIBUTE2           ,
    LINE_GDF_ATTRIBUTE3           ,
    LINE_GDF_ATTRIBUTE4           ,
    LINE_GDF_ATTRIBUTE5           ,
    LINE_GDF_ATTRIBUTE6           ,
    LINE_GDF_ATTRIBUTE7           ,
    LINE_GDF_ATTRIBUTE8           ,
    LINE_GDF_ATTRIBUTE9           ,
    LINE_GDF_ATTRIBUTE10          ,
    LINE_GDF_ATTRIBUTE11          ,
    LINE_GDF_ATTRIBUTE12          ,
    LINE_GDF_ATTRIBUTE13          ,
    LINE_GDF_ATTRIBUTE14          ,
    LINE_GDF_ATTRIBUTE15          ,
    LINE_GDF_ATTRIBUTE16          ,
    LINE_GDF_ATTRIBUTE17          ,
    LINE_GDF_ATTRIBUTE18          ,
    LINE_GDF_ATTRIBUTE19          ,
    LINE_GDF_ATTRIBUTE20          ,
    RESET_TRX_DATE_FLAG           ,
    PAYMENT_SERVER_ORDER_NUM      ,
    APPROVAL_CODE                 ,
    ADDRESS_VERIFICATION_CODE     ,
    WAREHOUSE_ID                  ,
    TRANSLATED_DESCRIPTION        ,
    CONS_BILLING_NUMBER           ,
    PROMISED_COMMITMENT_AMOUNT    ,
    PAYMENT_SET_ID                ,
    ORIGINAL_GL_DATE              ,
    CONTRACT_LINE_ID              ,
    CONTRACT_ID                   ,
    SOURCE_DATA_KEY1              ,
    SOURCE_DATA_KEY2              ,
    SOURCE_DATA_KEY3              ,
    SOURCE_DATA_KEY4              ,
    SOURCE_DATA_KEY5              ,
    INVOICED_LINE_ACCTG_LEVEL     ,
    OVERRIDE_AUTO_ACCOUNTING_FLAG ,
    SOURCE_APPLICATION_ID         ,
    SOURCE_EVENT_CLASS_CODE       ,
    SOURCE_ENTITY_CODE            ,
    SOURCE_TRX_ID                 ,
    SOURCE_TRX_LINE_ID            ,
    SOURCE_TRX_LINE_TYPE          ,
    SOURCE_TRX_DETAIL_TAX_LINE_ID ,
    HISTORICAL_FLAG               ,
    TAX_REGIME_CODE               ,
    TAX                           ,
    TAX_STATUS_CODE               ,
    TAX_RATE_CODE                 ,
    TAX_JURISDICTION_CODE         ,
    TAXABLE_AMOUNT                ,
    TAXABLE_FLAG                  ,
    LEGAL_ENTITY_ID               ,
    PARENT_LINE_ID                ,
    DEFERRAL_EXCLUSION_FLAG       ,
    PAYMENT_TRXN_EXTENSION_ID     ,
    RULE_END_DATE                 ,
    PAYMENT_ATTRIBUTES            ,
    APPLICATION_ID                ,
    BILLING_DATE
     FROM TABLE(p_lines_all)
  )
  LOOP

     l_bill_to_address_id := r_lines_all.ORIG_SYSTEM_BILL_ADDRESS_ID;
     l_ship_to_address_id := r_lines_all.ORIG_SYSTEM_SHIP_ADDRESS_ID;
     l_payment_term_id := r_lines_all.TERM_ID;
     l_conversion_type := r_lines_all.CONVERSION_TYPE;
     l_conversion_date := r_lines_all.CONVERSION_DATE;
     l_conversion_rate := r_lines_all.CONVERSION_RATE;


     AR_AI_INTEG_PKG.DEFAULT_ATTRIBUTES(
     	p_org_id 	      		=> r_lines_all.ORG_ID,
        p_bill_to_customer_account_id 	=> r_lines_all.ORIG_SYSTEM_BILL_CUSTOMER_ID,
        p_ship_to_customer_account_id	=> r_lines_all.ORIG_SYSTEM_SHIP_CUSTOMER_ID,
        p_currency_code    		=> r_lines_all.CURRENCY_CODE,
        x_bill_to_address_id 		=> l_default_bill_to_address_id,
        x_ship_to_address_id 		=> l_default_ship_to_address_id,
        x_payment_term_id 		=> l_default_payment_term_id,
        x_conversion_type 		=> l_default_conversion_type,
        x_conversion_date 		=> l_default_conversion_date,
        x_conversion_rate 		=> l_default_conversion_rate,
        x_return_status 		=> x_return_status,
        x_msg_data 			=> x_err_msg
     );

     IF (x_return_status <> FND_API.G_RET_STS_SUCCESS) THEN
       RAISE  FND_API.G_EXC_UNEXPECTED_ERROR;
     END IF;

     IF(l_bill_to_address_id IS NULL OR l_bill_to_address_id = FND_API.G_MISS_NUM) THEN
       l_bill_to_address_id := l_default_bill_to_address_id;
     END IF;

     IF(l_ship_to_address_id IS NULL OR l_ship_to_address_id = FND_API.G_MISS_NUM) THEN
       l_ship_to_address_id := l_default_ship_to_address_id;
     END IF;

     IF(l_payment_term_id IS NULL OR l_payment_term_id = FND_API.G_MISS_NUM) THEN

       /* If the Trx name is null no need to default the l_payment_term_id value*/
       IF(r_lines_all.CUST_TRX_TYPE_NAME IS NOT NULL) THEN

         AR_EBI_INVOICE_PUB.ar_get_trx_type(
          p_cust_trx_type_name 	=> r_lines_all.CUST_TRX_TYPE_NAME
         ,p_org_id		=> r_lines_all.ORG_ID
         ,x_trx_type		=> l_trx_type
         ,x_return_status	=> x_return_status
         ,x_err_msg		=> x_err_msg
         );

         IF(x_return_status <> FND_API.G_RET_STS_SUCCESS) THEN
	   RAISE  FND_API.G_EXC_UNEXPECTED_ERROR;
     	 END IF;

         /* Trx type is Credit Memo We should not default the values*/
         IF(l_trx_type IS NOT NULL AND l_trx_type <> 'CM') THEN
           l_payment_term_id := l_default_payment_term_id;
         END IF;
       END IF;
     END IF;

     IF(l_conversion_type IS NULL OR l_conversion_type = FND_API.G_MISS_CHAR) THEN
       l_conversion_type := l_default_conversion_type;
     END IF;

     IF(l_conversion_date IS NULL OR l_conversion_date = FND_API.G_MISS_DATE) THEN
       l_conversion_date := l_default_conversion_date;
     END IF;

     IF(l_conversion_rate IS NULL OR l_conversion_rate = FND_API.G_MISS_NUM) THEN
       l_conversion_rate := l_default_conversion_rate;
     END IF;


     INSERT
       INTO ra_interface_lines_all
      (
        INTERFACE_LINE_ID             ,
        INTERFACE_LINE_CONTEXT        ,
        INTERFACE_LINE_ATTRIBUTE1     ,
        INTERFACE_LINE_ATTRIBUTE2     ,
        INTERFACE_LINE_ATTRIBUTE3     ,
        INTERFACE_LINE_ATTRIBUTE4     ,
        INTERFACE_LINE_ATTRIBUTE5     ,
        INTERFACE_LINE_ATTRIBUTE6     ,
        INTERFACE_LINE_ATTRIBUTE7     ,
        INTERFACE_LINE_ATTRIBUTE8     ,
        BATCH_SOURCE_NAME             ,
        SET_OF_BOOKS_ID               ,
        LINE_TYPE                     ,
        DESCRIPTION                   ,
        CURRENCY_CODE                 ,
        AMOUNT                        ,
        CUST_TRX_TYPE_NAME            ,
        CUST_TRX_TYPE_ID              ,
        TERM_NAME                     ,
        TERM_ID                       ,
        ORIG_SYSTEM_BATCH_NAME        ,
        ORIG_SYSTEM_BILL_CUSTOMER_REF ,
        ORIG_SYSTEM_BILL_CUSTOMER_ID  ,
        ORIG_SYSTEM_BILL_ADDRESS_REF  ,
        ORIG_SYSTEM_BILL_ADDRESS_ID   ,
        ORIG_SYSTEM_BILL_CONTACT_REF  ,
        ORIG_SYSTEM_BILL_CONTACT_ID   ,
        ORIG_SYSTEM_SHIP_CUSTOMER_REF ,
        ORIG_SYSTEM_SHIP_CUSTOMER_ID  ,
        ORIG_SYSTEM_SHIP_ADDRESS_REF  ,
        ORIG_SYSTEM_SHIP_ADDRESS_ID   ,
        ORIG_SYSTEM_SHIP_CONTACT_REF  ,
        ORIG_SYSTEM_SHIP_CONTACT_ID   ,
        ORIG_SYSTEM_SOLD_CUSTOMER_REF ,
        ORIG_SYSTEM_SOLD_CUSTOMER_ID  ,
        LINK_TO_LINE_ID               ,
        LINK_TO_LINE_CONTEXT          ,
        LINK_TO_LINE_ATTRIBUTE1       ,
        LINK_TO_LINE_ATTRIBUTE2       ,
        LINK_TO_LINE_ATTRIBUTE3       ,
        LINK_TO_LINE_ATTRIBUTE4       ,
        LINK_TO_LINE_ATTRIBUTE5       ,
        LINK_TO_LINE_ATTRIBUTE6       ,
        LINK_TO_LINE_ATTRIBUTE7       ,
        RECEIPT_METHOD_NAME           ,
        RECEIPT_METHOD_ID             ,
        CONVERSION_TYPE               ,
        CONVERSION_DATE               ,
        CONVERSION_RATE               ,
        CUSTOMER_TRX_ID               ,
        TRX_DATE                      ,
        GL_DATE                       ,
        DOCUMENT_NUMBER               ,
        TRX_NUMBER                    ,
        LINE_NUMBER                   ,
        QUANTITY                      ,
        QUANTITY_ORDERED              ,
        UNIT_SELLING_PRICE            ,
        UNIT_STANDARD_PRICE           ,
        PRINTING_OPTION               ,
        INTERFACE_STATUS              ,
        REQUEST_ID                    ,
        RELATED_BATCH_SOURCE_NAME     ,
        RELATED_TRX_NUMBER            ,
        RELATED_CUSTOMER_TRX_ID       ,
        PREVIOUS_CUSTOMER_TRX_ID      ,
        CREDIT_METHOD_FOR_ACCT_RULE   ,
        CREDIT_METHOD_FOR_INSTALLMENTS,
        REASON_CODE                   ,
        TAX_RATE                      ,
        TAX_CODE                      ,
        TAX_PRECEDENCE                ,
        EXCEPTION_ID                  ,
        EXEMPTION_ID                  ,
        SHIP_DATE_ACTUAL              ,
        FOB_POINT                     ,
        SHIP_VIA                      ,
        WAYBILL_NUMBER                ,
        INVOICING_RULE_NAME           ,
        INVOICING_RULE_ID             ,
        ACCOUNTING_RULE_NAME          ,
        ACCOUNTING_RULE_ID            ,
        ACCOUNTING_RULE_DURATION      ,
        RULE_START_DATE               ,
        PRIMARY_SALESREP_NUMBER       ,
        PRIMARY_SALESREP_ID           ,
        SALES_ORDER                   ,
        SALES_ORDER_LINE              ,
        SALES_ORDER_DATE              ,
        SALES_ORDER_SOURCE            ,
        SALES_ORDER_REVISION          ,
        PURCHASE_ORDER                ,
        PURCHASE_ORDER_REVISION       ,
        PURCHASE_ORDER_DATE           ,
        AGREEMENT_NAME                ,
        AGREEMENT_ID                  ,
        MEMO_LINE_NAME                ,
        MEMO_LINE_ID                  ,
        INVENTORY_ITEM_ID             ,
        MTL_SYSTEM_ITEMS_SEG1         ,
        MTL_SYSTEM_ITEMS_SEG2         ,
        MTL_SYSTEM_ITEMS_SEG3         ,
        MTL_SYSTEM_ITEMS_SEG4         ,
        MTL_SYSTEM_ITEMS_SEG5         ,
        MTL_SYSTEM_ITEMS_SEG6         ,
        MTL_SYSTEM_ITEMS_SEG7         ,
        MTL_SYSTEM_ITEMS_SEG8         ,
        MTL_SYSTEM_ITEMS_SEG9         ,
        MTL_SYSTEM_ITEMS_SEG10        ,
        MTL_SYSTEM_ITEMS_SEG11        ,
        MTL_SYSTEM_ITEMS_SEG12        ,
        MTL_SYSTEM_ITEMS_SEG13        ,
        MTL_SYSTEM_ITEMS_SEG14        ,
        MTL_SYSTEM_ITEMS_SEG15        ,
        MTL_SYSTEM_ITEMS_SEG16        ,
        MTL_SYSTEM_ITEMS_SEG17        ,
        MTL_SYSTEM_ITEMS_SEG18        ,
        MTL_SYSTEM_ITEMS_SEG19        ,
        MTL_SYSTEM_ITEMS_SEG20        ,
        REFERENCE_LINE_ID             ,
        REFERENCE_LINE_CONTEXT        ,
        REFERENCE_LINE_ATTRIBUTE1     ,
        REFERENCE_LINE_ATTRIBUTE2     ,
        REFERENCE_LINE_ATTRIBUTE3     ,
        REFERENCE_LINE_ATTRIBUTE4     ,
        REFERENCE_LINE_ATTRIBUTE5     ,
        REFERENCE_LINE_ATTRIBUTE6     ,
        REFERENCE_LINE_ATTRIBUTE7     ,
        TERRITORY_ID                  ,
        TERRITORY_SEGMENT1            ,
        TERRITORY_SEGMENT2            ,
        TERRITORY_SEGMENT3            ,
        TERRITORY_SEGMENT4            ,
        TERRITORY_SEGMENT5            ,
        TERRITORY_SEGMENT6            ,
        TERRITORY_SEGMENT7            ,
        TERRITORY_SEGMENT8            ,
        TERRITORY_SEGMENT9            ,
        TERRITORY_SEGMENT10           ,
        TERRITORY_SEGMENT11           ,
        TERRITORY_SEGMENT12           ,
        TERRITORY_SEGMENT13           ,
        TERRITORY_SEGMENT14           ,
        TERRITORY_SEGMENT15           ,
        TERRITORY_SEGMENT16           ,
        TERRITORY_SEGMENT17           ,
        TERRITORY_SEGMENT18           ,
        TERRITORY_SEGMENT19           ,
        TERRITORY_SEGMENT20           ,
        ATTRIBUTE_CATEGORY            ,
        ATTRIBUTE1                    ,
        ATTRIBUTE2                    ,
        ATTRIBUTE3                    ,
        ATTRIBUTE4                    ,
        ATTRIBUTE5                    ,
        ATTRIBUTE6                    ,
        ATTRIBUTE7                    ,
        ATTRIBUTE8                    ,
        ATTRIBUTE9                    ,
        ATTRIBUTE10                   ,
        ATTRIBUTE11                   ,
        ATTRIBUTE12                   ,
        ATTRIBUTE13                   ,
        ATTRIBUTE14                   ,
        ATTRIBUTE15                   ,
        HEADER_ATTRIBUTE_CATEGORY     ,
        HEADER_ATTRIBUTE1             ,
        HEADER_ATTRIBUTE2             ,
        HEADER_ATTRIBUTE3             ,
        HEADER_ATTRIBUTE4             ,
        HEADER_ATTRIBUTE5             ,
        HEADER_ATTRIBUTE6             ,
        HEADER_ATTRIBUTE7             ,
        HEADER_ATTRIBUTE8             ,
        HEADER_ATTRIBUTE9             ,
        HEADER_ATTRIBUTE10            ,
        HEADER_ATTRIBUTE11            ,
        HEADER_ATTRIBUTE12            ,
        HEADER_ATTRIBUTE13            ,
        HEADER_ATTRIBUTE14            ,
        HEADER_ATTRIBUTE15            ,
        COMMENTS                      ,
        INTERNAL_NOTES                ,
        INITIAL_CUSTOMER_TRX_ID       ,
        USSGL_TRANSACTION_CODE_CONTEXT,
        USSGL_TRANSACTION_CODE        ,
        ACCTD_AMOUNT                  ,
        CUSTOMER_BANK_ACCOUNT_ID      ,
        CUSTOMER_BANK_ACCOUNT_NAME    ,
        UOM_CODE                      ,
        UOM_NAME                      ,
        DOCUMENT_NUMBER_SEQUENCE_ID   ,
        LINK_TO_LINE_ATTRIBUTE10      ,
        LINK_TO_LINE_ATTRIBUTE11      ,
        LINK_TO_LINE_ATTRIBUTE12      ,
        LINK_TO_LINE_ATTRIBUTE13      ,
        LINK_TO_LINE_ATTRIBUTE14      ,
        LINK_TO_LINE_ATTRIBUTE15      ,
        LINK_TO_LINE_ATTRIBUTE8       ,
        LINK_TO_LINE_ATTRIBUTE9       ,
        REFERENCE_LINE_ATTRIBUTE10    ,
        REFERENCE_LINE_ATTRIBUTE11    ,
        REFERENCE_LINE_ATTRIBUTE12    ,
        REFERENCE_LINE_ATTRIBUTE13    ,
        REFERENCE_LINE_ATTRIBUTE14    ,
        REFERENCE_LINE_ATTRIBUTE15    ,
        REFERENCE_LINE_ATTRIBUTE8     ,
        REFERENCE_LINE_ATTRIBUTE9     ,
        INTERFACE_LINE_ATTRIBUTE10    ,
        INTERFACE_LINE_ATTRIBUTE11    ,
        INTERFACE_LINE_ATTRIBUTE12    ,
        INTERFACE_LINE_ATTRIBUTE13    ,
        INTERFACE_LINE_ATTRIBUTE14    ,
        INTERFACE_LINE_ATTRIBUTE15    ,
        INTERFACE_LINE_ATTRIBUTE9     ,
        VAT_TAX_ID                    ,
        REASON_CODE_MEANING           ,
        LAST_PERIOD_TO_CREDIT         ,
        PAYING_CUSTOMER_ID            ,
        PAYING_SITE_USE_ID            ,
        TAX_EXEMPT_FLAG               ,
        TAX_EXEMPT_REASON_CODE        ,
        TAX_EXEMPT_REASON_CODE_MEANING,
        TAX_EXEMPT_NUMBER             ,
        SALES_TAX_ID                  ,
        CREATED_BY                    ,
        CREATION_DATE                 ,
        LAST_UPDATED_BY               ,
        LAST_UPDATE_DATE              ,
        LAST_UPDATE_LOGIN             ,
        LOCATION_SEGMENT_ID           ,
        MOVEMENT_ID                   ,
        ORG_ID                        ,
        AMOUNT_INCLUDES_TAX_FLAG      ,
        HEADER_GDF_ATTR_CATEGORY      ,
        HEADER_GDF_ATTRIBUTE1         ,
        HEADER_GDF_ATTRIBUTE2         ,
        HEADER_GDF_ATTRIBUTE3         ,
        HEADER_GDF_ATTRIBUTE4         ,
        HEADER_GDF_ATTRIBUTE5         ,
        HEADER_GDF_ATTRIBUTE6         ,
        HEADER_GDF_ATTRIBUTE7         ,
        HEADER_GDF_ATTRIBUTE8         ,
        HEADER_GDF_ATTRIBUTE9         ,
        HEADER_GDF_ATTRIBUTE10        ,
        HEADER_GDF_ATTRIBUTE11        ,
        HEADER_GDF_ATTRIBUTE12        ,
        HEADER_GDF_ATTRIBUTE13        ,
        HEADER_GDF_ATTRIBUTE14        ,
        HEADER_GDF_ATTRIBUTE15        ,
        HEADER_GDF_ATTRIBUTE16        ,
        HEADER_GDF_ATTRIBUTE17        ,
        HEADER_GDF_ATTRIBUTE18        ,
        HEADER_GDF_ATTRIBUTE19        ,
        HEADER_GDF_ATTRIBUTE20        ,
        HEADER_GDF_ATTRIBUTE21        ,
        HEADER_GDF_ATTRIBUTE22        ,
        HEADER_GDF_ATTRIBUTE23        ,
        HEADER_GDF_ATTRIBUTE24        ,
        HEADER_GDF_ATTRIBUTE25        ,
        HEADER_GDF_ATTRIBUTE26        ,
        HEADER_GDF_ATTRIBUTE27        ,
        HEADER_GDF_ATTRIBUTE28        ,
        HEADER_GDF_ATTRIBUTE29        ,
        HEADER_GDF_ATTRIBUTE30        ,
        LINE_GDF_ATTR_CATEGORY        ,
        LINE_GDF_ATTRIBUTE1           ,
        LINE_GDF_ATTRIBUTE2           ,
        LINE_GDF_ATTRIBUTE3           ,
        LINE_GDF_ATTRIBUTE4           ,
        LINE_GDF_ATTRIBUTE5           ,
        LINE_GDF_ATTRIBUTE6           ,
        LINE_GDF_ATTRIBUTE7           ,
        LINE_GDF_ATTRIBUTE8           ,
        LINE_GDF_ATTRIBUTE9           ,
        LINE_GDF_ATTRIBUTE10          ,
        LINE_GDF_ATTRIBUTE11          ,
        LINE_GDF_ATTRIBUTE12          ,
        LINE_GDF_ATTRIBUTE13          ,
        LINE_GDF_ATTRIBUTE14          ,
        LINE_GDF_ATTRIBUTE15          ,
        LINE_GDF_ATTRIBUTE16          ,
        LINE_GDF_ATTRIBUTE17          ,
        LINE_GDF_ATTRIBUTE18          ,
        LINE_GDF_ATTRIBUTE19          ,
        LINE_GDF_ATTRIBUTE20          ,
        RESET_TRX_DATE_FLAG           ,
        PAYMENT_SERVER_ORDER_NUM      ,
        APPROVAL_CODE                 ,
        ADDRESS_VERIFICATION_CODE     ,
        WAREHOUSE_ID                  ,
        TRANSLATED_DESCRIPTION        ,
        CONS_BILLING_NUMBER           ,
        PROMISED_COMMITMENT_AMOUNT    ,
        PAYMENT_SET_ID                ,
        ORIGINAL_GL_DATE              ,
        CONTRACT_LINE_ID              ,
        CONTRACT_ID                   ,
        SOURCE_DATA_KEY1              ,
        SOURCE_DATA_KEY2              ,
        SOURCE_DATA_KEY3              ,
        SOURCE_DATA_KEY4              ,
        SOURCE_DATA_KEY5              ,
        INVOICED_LINE_ACCTG_LEVEL     ,
        OVERRIDE_AUTO_ACCOUNTING_FLAG ,
        SOURCE_APPLICATION_ID         ,
        SOURCE_EVENT_CLASS_CODE       ,
        SOURCE_ENTITY_CODE            ,
        SOURCE_TRX_ID                 ,
        SOURCE_TRX_LINE_ID            ,
        SOURCE_TRX_LINE_TYPE          ,
        SOURCE_TRX_DETAIL_TAX_LINE_ID ,
        HISTORICAL_FLAG               ,
        TAX_REGIME_CODE               ,
        TAX                           ,
        TAX_STATUS_CODE               ,
        TAX_RATE_CODE                 ,
        TAX_JURISDICTION_CODE         ,
        TAXABLE_AMOUNT                ,
        TAXABLE_FLAG                  ,
        LEGAL_ENTITY_ID               ,
        PARENT_LINE_ID                ,
        DEFERRAL_EXCLUSION_FLAG       ,
        PAYMENT_TRXN_EXTENSION_ID     ,
        RULE_END_DATE                 ,
        PAYMENT_ATTRIBUTES            ,
        APPLICATION_ID                ,
        BILLING_DATE
      )
      VALUES
      (
        r_lines_all.INTERFACE_LINE_ID             ,
        r_lines_all.INTERFACE_LINE_CONTEXT        ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE1     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE2     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE3     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE4     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE5     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE6     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE7     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE8     ,
        r_lines_all.BATCH_SOURCE_NAME             ,
        r_lines_all.SET_OF_BOOKS_ID               ,
        r_lines_all.LINE_TYPE                     ,
        r_lines_all.DESCRIPTION                   ,
        r_lines_all.CURRENCY_CODE                 ,
        r_lines_all.AMOUNT                        ,
        r_lines_all.CUST_TRX_TYPE_NAME            ,
        r_lines_all.CUST_TRX_TYPE_ID              ,
        r_lines_all.TERM_NAME                     ,
        l_payment_term_id                       ,
        r_lines_all.ORIG_SYSTEM_BATCH_NAME        ,
        r_lines_all.ORIG_SYSTEM_BILL_CUSTOMER_REF ,
        r_lines_all.ORIG_SYSTEM_BILL_CUSTOMER_ID  ,
        r_lines_all.ORIG_SYSTEM_BILL_ADDRESS_REF  ,
        l_bill_to_address_id    ,
        r_lines_all.ORIG_SYSTEM_BILL_CONTACT_REF  ,
        r_lines_all.ORIG_SYSTEM_BILL_CONTACT_ID   ,
        r_lines_all.ORIG_SYSTEM_SHIP_CUSTOMER_REF ,
        r_lines_all.ORIG_SYSTEM_SHIP_CUSTOMER_ID  ,
        r_lines_all.ORIG_SYSTEM_SHIP_ADDRESS_REF  ,
        l_ship_to_address_id  ,
        r_lines_all.ORIG_SYSTEM_SHIP_CONTACT_REF  ,
        r_lines_all.ORIG_SYSTEM_SHIP_CONTACT_ID   ,
        r_lines_all.ORIG_SYSTEM_SOLD_CUSTOMER_REF ,
        r_lines_all.ORIG_SYSTEM_SOLD_CUSTOMER_ID  ,
        r_lines_all.LINK_TO_LINE_ID               ,
        r_lines_all.LINK_TO_LINE_CONTEXT          ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE1       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE2       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE3       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE4       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE5       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE6       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE7       ,
        r_lines_all.RECEIPT_METHOD_NAME           ,
        r_lines_all.RECEIPT_METHOD_ID             ,
        l_conversion_type               ,
        l_conversion_date               ,
        l_conversion_rate               ,
        r_lines_all.CUSTOMER_TRX_ID               ,
        r_lines_all.TRX_DATE                      ,
        r_lines_all.GL_DATE                       ,
        r_lines_all.DOCUMENT_NUMBER               ,
        r_lines_all.TRX_NUMBER                    ,
        r_lines_all.LINE_NUMBER                   ,
        r_lines_all.QUANTITY                      ,
        r_lines_all.QUANTITY_ORDERED              ,
        r_lines_all.UNIT_SELLING_PRICE            ,
        r_lines_all.UNIT_STANDARD_PRICE           ,
        r_lines_all.PRINTING_OPTION               ,
        r_lines_all.INTERFACE_STATUS              ,
        r_lines_all.REQUEST_ID                    ,
        r_lines_all.RELATED_BATCH_SOURCE_NAME     ,
        r_lines_all.RELATED_TRX_NUMBER            ,
        r_lines_all.RELATED_CUSTOMER_TRX_ID       ,
        r_lines_all.PREVIOUS_CUSTOMER_TRX_ID      ,
        r_lines_all.CREDIT_METHOD_FOR_ACCT_RULE   ,
        r_lines_all.CREDIT_METHOD_FOR_INSTALLMENTS,
        r_lines_all.REASON_CODE                   ,
        r_lines_all.TAX_RATE                      ,
        r_lines_all.TAX_CODE                      ,
        r_lines_all.TAX_PRECEDENCE                ,
        r_lines_all.EXCEPTION_ID                  ,
        r_lines_all.EXEMPTION_ID                  ,
        r_lines_all.SHIP_DATE_ACTUAL              ,
        r_lines_all.FOB_POINT                     ,
        r_lines_all.SHIP_VIA                      ,
        r_lines_all.WAYBILL_NUMBER                ,
        r_lines_all.INVOICING_RULE_NAME           ,
        r_lines_all.INVOICING_RULE_ID             ,
        r_lines_all.ACCOUNTING_RULE_NAME          ,
        r_lines_all.ACCOUNTING_RULE_ID            ,
        r_lines_all.ACCOUNTING_RULE_DURATION      ,
        r_lines_all.RULE_START_DATE               ,
        r_lines_all.PRIMARY_SALESREP_NUMBER       ,
        r_lines_all.PRIMARY_SALESREP_ID           ,
        r_lines_all.SALES_ORDER                   ,
        r_lines_all.SALES_ORDER_LINE              ,
        r_lines_all.SALES_ORDER_DATE              ,
        r_lines_all.SALES_ORDER_SOURCE            ,
        r_lines_all.SALES_ORDER_REVISION          ,
        r_lines_all.PURCHASE_ORDER                ,
        r_lines_all.PURCHASE_ORDER_REVISION       ,
        r_lines_all.PURCHASE_ORDER_DATE           ,
        r_lines_all.AGREEMENT_NAME                ,
        r_lines_all.AGREEMENT_ID                  ,
        r_lines_all.MEMO_LINE_NAME                ,
        r_lines_all.MEMO_LINE_ID                  ,
        r_lines_all.INVENTORY_ITEM_ID             ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG1         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG2         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG3         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG4         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG5         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG6         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG7         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG8         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG9         ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG10        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG11        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG12        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG13        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG14        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG15        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG16        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG17        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG18        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG19        ,
        r_lines_all.MTL_SYSTEM_ITEMS_SEG20        ,
        r_lines_all.REFERENCE_LINE_ID             ,
        r_lines_all.REFERENCE_LINE_CONTEXT        ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE1     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE2     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE3     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE4     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE5     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE6     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE7     ,
        r_lines_all.TERRITORY_ID                  ,
        r_lines_all.TERRITORY_SEGMENT1            ,
        r_lines_all.TERRITORY_SEGMENT2            ,
        r_lines_all.TERRITORY_SEGMENT3            ,
        r_lines_all.TERRITORY_SEGMENT4            ,
        r_lines_all.TERRITORY_SEGMENT5            ,
        r_lines_all.TERRITORY_SEGMENT6            ,
        r_lines_all.TERRITORY_SEGMENT7            ,
        r_lines_all.TERRITORY_SEGMENT8            ,
        r_lines_all.TERRITORY_SEGMENT9            ,
        r_lines_all.TERRITORY_SEGMENT10           ,
        r_lines_all.TERRITORY_SEGMENT11           ,
        r_lines_all.TERRITORY_SEGMENT12           ,
        r_lines_all.TERRITORY_SEGMENT13           ,
        r_lines_all.TERRITORY_SEGMENT14           ,
        r_lines_all.TERRITORY_SEGMENT15           ,
        r_lines_all.TERRITORY_SEGMENT16           ,
        r_lines_all.TERRITORY_SEGMENT17           ,
        r_lines_all.TERRITORY_SEGMENT18           ,
        r_lines_all.TERRITORY_SEGMENT19           ,
        r_lines_all.TERRITORY_SEGMENT20           ,
        r_lines_all.ATTRIBUTE_CATEGORY            ,
        r_lines_all.ATTRIBUTE1                    ,
        r_lines_all.ATTRIBUTE2                    ,
        r_lines_all.ATTRIBUTE3                    ,
        r_lines_all.ATTRIBUTE4                    ,
        r_lines_all.ATTRIBUTE5                    ,
        r_lines_all.ATTRIBUTE6                    ,
        r_lines_all.ATTRIBUTE7                    ,
        r_lines_all.ATTRIBUTE8                    ,
        r_lines_all.ATTRIBUTE9                    ,
        r_lines_all.ATTRIBUTE10                   ,
        r_lines_all.ATTRIBUTE11                   ,
        r_lines_all.ATTRIBUTE12                   ,
        r_lines_all.ATTRIBUTE13                   ,
        r_lines_all.ATTRIBUTE14                   ,
        r_lines_all.ATTRIBUTE15                   ,
        r_lines_all.HEADER_ATTRIBUTE_CATEGORY     ,
        r_lines_all.HEADER_ATTRIBUTE1             ,
        r_lines_all.HEADER_ATTRIBUTE2             ,
        r_lines_all.HEADER_ATTRIBUTE3             ,
        r_lines_all.HEADER_ATTRIBUTE4             ,
        r_lines_all.HEADER_ATTRIBUTE5             ,
        r_lines_all.HEADER_ATTRIBUTE6             ,
        r_lines_all.HEADER_ATTRIBUTE7             ,
        r_lines_all.HEADER_ATTRIBUTE8             ,
        r_lines_all.HEADER_ATTRIBUTE9             ,
        r_lines_all.HEADER_ATTRIBUTE10            ,
        r_lines_all.HEADER_ATTRIBUTE11            ,
        r_lines_all.HEADER_ATTRIBUTE12            ,
        r_lines_all.HEADER_ATTRIBUTE13            ,
        r_lines_all.HEADER_ATTRIBUTE14            ,
        r_lines_all.HEADER_ATTRIBUTE15            ,
        r_lines_all.COMMENTS                      ,
        r_lines_all.INTERNAL_NOTES                ,
        r_lines_all.INITIAL_CUSTOMER_TRX_ID       ,
        r_lines_all.USSGL_TRANSACTION_CODE_CONTEXT,
        r_lines_all.USSGL_TRANSACTION_CODE        ,
        r_lines_all.ACCTD_AMOUNT                  ,
        r_lines_all.CUSTOMER_BANK_ACCOUNT_ID      ,
        r_lines_all.CUSTOMER_BANK_ACCOUNT_NAME    ,
        r_lines_all.UOM_CODE                      ,
        r_lines_all.UOM_NAME                      ,
        r_lines_all.DOCUMENT_NUMBER_SEQUENCE_ID   ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE10      ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE11      ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE12      ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE13      ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE14      ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE15      ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE8       ,
        r_lines_all.LINK_TO_LINE_ATTRIBUTE9       ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE10    ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE11    ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE12    ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE13    ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE14    ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE15    ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE8     ,
        r_lines_all.REFERENCE_LINE_ATTRIBUTE9     ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE10    ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE11    ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE12    ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE13    ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE14    ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE15    ,
        r_lines_all.INTERFACE_LINE_ATTRIBUTE9     ,
        r_lines_all.VAT_TAX_ID                    ,
        r_lines_all.REASON_CODE_MEANING           ,
        r_lines_all.LAST_PERIOD_TO_CREDIT         ,
        r_lines_all.PAYING_CUSTOMER_ID            ,
        r_lines_all.PAYING_SITE_USE_ID            ,
        r_lines_all.TAX_EXEMPT_FLAG               ,
        r_lines_all.TAX_EXEMPT_REASON_CODE        ,
        r_lines_all.TAX_EXEMPT_REASON_CODE_MEANING,
        r_lines_all.TAX_EXEMPT_NUMBER             ,
        r_lines_all.SALES_TAX_ID                  ,
        r_lines_all.CREATED_BY                    ,
        r_lines_all.CREATION_DATE                 ,
        r_lines_all.LAST_UPDATED_BY               ,
        r_lines_all.LAST_UPDATE_DATE              ,
        r_lines_all.LAST_UPDATE_LOGIN             ,
        r_lines_all.LOCATION_SEGMENT_ID           ,
        r_lines_all.MOVEMENT_ID                   ,
        r_lines_all.ORG_ID                        ,
        r_lines_all.AMOUNT_INCLUDES_TAX_FLAG      ,
        r_lines_all.HEADER_GDF_ATTR_CATEGORY      ,
        r_lines_all.HEADER_GDF_ATTRIBUTE1         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE2         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE3         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE4         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE5         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE6         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE7         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE8         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE9         ,
        r_lines_all.HEADER_GDF_ATTRIBUTE10        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE11        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE12        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE13        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE14        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE15        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE16        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE17        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE18        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE19        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE20        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE21        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE22        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE23        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE24        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE25        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE26        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE27        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE28        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE29        ,
        r_lines_all.HEADER_GDF_ATTRIBUTE30        ,
        r_lines_all.LINE_GDF_ATTR_CATEGORY        ,
        r_lines_all.LINE_GDF_ATTRIBUTE1           ,
        r_lines_all.LINE_GDF_ATTRIBUTE2           ,
        r_lines_all.LINE_GDF_ATTRIBUTE3           ,
        r_lines_all.LINE_GDF_ATTRIBUTE4           ,
        r_lines_all.LINE_GDF_ATTRIBUTE5           ,
        r_lines_all.LINE_GDF_ATTRIBUTE6           ,
        r_lines_all.LINE_GDF_ATTRIBUTE7           ,
        r_lines_all.LINE_GDF_ATTRIBUTE8           ,
        r_lines_all.LINE_GDF_ATTRIBUTE9           ,
        r_lines_all.LINE_GDF_ATTRIBUTE10          ,
        r_lines_all.LINE_GDF_ATTRIBUTE11          ,
        r_lines_all.LINE_GDF_ATTRIBUTE12          ,
        r_lines_all.LINE_GDF_ATTRIBUTE13          ,
        r_lines_all.LINE_GDF_ATTRIBUTE14          ,
        r_lines_all.LINE_GDF_ATTRIBUTE15          ,
        r_lines_all.LINE_GDF_ATTRIBUTE16          ,
        r_lines_all.LINE_GDF_ATTRIBUTE17          ,
        r_lines_all.LINE_GDF_ATTRIBUTE18          ,
        r_lines_all.LINE_GDF_ATTRIBUTE19          ,
        r_lines_all.LINE_GDF_ATTRIBUTE20          ,
        r_lines_all.RESET_TRX_DATE_FLAG           ,
        r_lines_all.PAYMENT_SERVER_ORDER_NUM      ,
        r_lines_all.APPROVAL_CODE                 ,
        r_lines_all.ADDRESS_VERIFICATION_CODE     ,
        r_lines_all.WAREHOUSE_ID                  ,
        r_lines_all.TRANSLATED_DESCRIPTION        ,
        r_lines_all.CONS_BILLING_NUMBER           ,
        r_lines_all.PROMISED_COMMITMENT_AMOUNT    ,
        r_lines_all.PAYMENT_SET_ID                ,
        r_lines_all.ORIGINAL_GL_DATE              ,
        r_lines_all.CONTRACT_LINE_ID              ,
        r_lines_all.CONTRACT_ID                   ,
        r_lines_all.SOURCE_DATA_KEY1              ,
        r_lines_all.SOURCE_DATA_KEY2              ,
        r_lines_all.SOURCE_DATA_KEY3              ,
        r_lines_all.SOURCE_DATA_KEY4              ,
        r_lines_all.SOURCE_DATA_KEY5              ,
        r_lines_all.INVOICED_LINE_ACCTG_LEVEL     ,
        r_lines_all.OVERRIDE_AUTO_ACCOUNTING_FLAG ,
        r_lines_all.SOURCE_APPLICATION_ID         ,
        r_lines_all.SOURCE_EVENT_CLASS_CODE       ,
        r_lines_all.SOURCE_ENTITY_CODE            ,
        r_lines_all.SOURCE_TRX_ID                 ,
        r_lines_all.SOURCE_TRX_LINE_ID            ,
        r_lines_all.SOURCE_TRX_LINE_TYPE          ,
        r_lines_all.SOURCE_TRX_DETAIL_TAX_LINE_ID ,
        r_lines_all.HISTORICAL_FLAG               ,
        r_lines_all.TAX_REGIME_CODE               ,
        r_lines_all.TAX                           ,
        r_lines_all.TAX_STATUS_CODE               ,
        r_lines_all.TAX_RATE_CODE                 ,
        r_lines_all.TAX_JURISDICTION_CODE         ,
        r_lines_all.TAXABLE_AMOUNT                ,
        r_lines_all.TAXABLE_FLAG                  ,
        r_lines_all.LEGAL_ENTITY_ID               ,
        r_lines_all.PARENT_LINE_ID                ,
        r_lines_all.DEFERRAL_EXCLUSION_FLAG       ,
        r_lines_all.PAYMENT_TRXN_EXTENSION_ID     ,
        r_lines_all.RULE_END_DATE                 ,
        r_lines_all.PAYMENT_ATTRIBUTES            ,
        r_lines_all.APPLICATION_ID                ,
        r_lines_all.BILLING_DATE
      );
  END LOOP;
  /* Inserting into ra_interface_distributions_all Tables */
  FOR r_distributions IN
  (SELECT INTERFACE_DISTRIBUTION_ID ,
      INTERFACE_LINE_ID             ,
      INTERFACE_LINE_CONTEXT        ,
      INTERFACE_LINE_ATTRIBUTE1     ,
      INTERFACE_LINE_ATTRIBUTE2     ,
      INTERFACE_LINE_ATTRIBUTE3     ,
      INTERFACE_LINE_ATTRIBUTE4     ,
      INTERFACE_LINE_ATTRIBUTE5     ,
      INTERFACE_LINE_ATTRIBUTE6     ,
      INTERFACE_LINE_ATTRIBUTE7     ,
      INTERFACE_LINE_ATTRIBUTE8     ,
      ACCOUNT_CLASS                 ,
      AMOUNT                        ,
      PERCENT                       ,
      INTERFACE_STATUS              ,
      REQUEST_ID                    ,
      CODE_COMBINATION_ID           ,
      SEGMENT1                      ,
      SEGMENT2                      ,
      SEGMENT3                      ,
      SEGMENT4                      ,
      SEGMENT5                      ,
      SEGMENT6                      ,
      SEGMENT7                      ,
      SEGMENT8                      ,
      SEGMENT9                      ,
      SEGMENT10                     ,
      SEGMENT11                     ,
      SEGMENT12                     ,
      SEGMENT13                     ,
      SEGMENT14                     ,
      SEGMENT15                     ,
      SEGMENT16                     ,
      SEGMENT17                     ,
      SEGMENT18                     ,
      SEGMENT19                     ,
      SEGMENT20                     ,
      SEGMENT21                     ,
      SEGMENT22                     ,
      SEGMENT23                     ,
      SEGMENT24                     ,
      SEGMENT25                     ,
      SEGMENT26                     ,
      SEGMENT27                     ,
      SEGMENT28                     ,
      SEGMENT29                     ,
      SEGMENT30                     ,
      COMMENTS                      ,
      ATTRIBUTE_CATEGORY            ,
      ATTRIBUTE1                    ,
      ATTRIBUTE2                    ,
      ATTRIBUTE3                    ,
      ATTRIBUTE4                    ,
      ATTRIBUTE5                    ,
      ATTRIBUTE6                    ,
      ATTRIBUTE7                    ,
      ATTRIBUTE8                    ,
      ATTRIBUTE9                    ,
      ATTRIBUTE10                   ,
      ATTRIBUTE11                   ,
      ATTRIBUTE12                   ,
      ATTRIBUTE13                   ,
      ATTRIBUTE14                   ,
      ATTRIBUTE15                   ,
      ACCTD_AMOUNT                  ,
      INTERFACE_LINE_ATTRIBUTE10    ,
      INTERFACE_LINE_ATTRIBUTE11    ,
      INTERFACE_LINE_ATTRIBUTE12    ,
      INTERFACE_LINE_ATTRIBUTE13    ,
      INTERFACE_LINE_ATTRIBUTE14    ,
      INTERFACE_LINE_ATTRIBUTE15    ,
      INTERFACE_LINE_ATTRIBUTE9     ,
      CREATED_BY                    ,
      CREATION_DATE                 ,
      LAST_UPDATED_BY               ,
      LAST_UPDATE_DATE              ,
      LAST_UPDATE_LOGIN             ,
      ORG_ID                        ,
      INTERIM_TAX_CCID              ,
      INTERIM_TAX_SEGMENT1          ,
      INTERIM_TAX_SEGMENT2          ,
      INTERIM_TAX_SEGMENT3          ,
      INTERIM_TAX_SEGMENT4          ,
      INTERIM_TAX_SEGMENT5          ,
      INTERIM_TAX_SEGMENT6          ,
      INTERIM_TAX_SEGMENT7          ,
      INTERIM_TAX_SEGMENT8          ,
      INTERIM_TAX_SEGMENT9          ,
      INTERIM_TAX_SEGMENT10         ,
      INTERIM_TAX_SEGMENT11         ,
      INTERIM_TAX_SEGMENT12         ,
      INTERIM_TAX_SEGMENT13         ,
      INTERIM_TAX_SEGMENT14         ,
      INTERIM_TAX_SEGMENT15         ,
      INTERIM_TAX_SEGMENT16         ,
      INTERIM_TAX_SEGMENT17         ,
      INTERIM_TAX_SEGMENT18         ,
      INTERIM_TAX_SEGMENT19         ,
      INTERIM_TAX_SEGMENT20         ,
      INTERIM_TAX_SEGMENT21         ,
      INTERIM_TAX_SEGMENT22         ,
      INTERIM_TAX_SEGMENT23         ,
      INTERIM_TAX_SEGMENT24         ,
      INTERIM_TAX_SEGMENT25         ,
      INTERIM_TAX_SEGMENT26         ,
      INTERIM_TAX_SEGMENT27         ,
      INTERIM_TAX_SEGMENT28         ,
      INTERIM_TAX_SEGMENT29         ,
      INTERIM_TAX_SEGMENT30
       FROM TABLE( p_distributions)
  )
  LOOP
     INSERT
       INTO ra_interface_distributions_all
      (
        INTERFACE_DISTRIBUTION_ID  ,
        INTERFACE_LINE_ID          ,
        INTERFACE_LINE_CONTEXT     ,
        INTERFACE_LINE_ATTRIBUTE1  ,
        INTERFACE_LINE_ATTRIBUTE2  ,
        INTERFACE_LINE_ATTRIBUTE3  ,
        INTERFACE_LINE_ATTRIBUTE4  ,
        INTERFACE_LINE_ATTRIBUTE5  ,
        INTERFACE_LINE_ATTRIBUTE6  ,
        INTERFACE_LINE_ATTRIBUTE7  ,
        INTERFACE_LINE_ATTRIBUTE8  ,
        ACCOUNT_CLASS              ,
        AMOUNT                     ,
        PERCENT                    ,
        INTERFACE_STATUS           ,
        REQUEST_ID                 ,
        CODE_COMBINATION_ID        ,
        SEGMENT1                   ,
        SEGMENT2                   ,
        SEGMENT3                   ,
        SEGMENT4                   ,
        SEGMENT5                   ,
        SEGMENT6                   ,
        SEGMENT7                   ,
        SEGMENT8                   ,
        SEGMENT9                   ,
        SEGMENT10                  ,
        SEGMENT11                  ,
        SEGMENT12                  ,
        SEGMENT13                  ,
        SEGMENT14                  ,
        SEGMENT15                  ,
        SEGMENT16                  ,
        SEGMENT17                  ,
        SEGMENT18                  ,
        SEGMENT19                  ,
        SEGMENT20                  ,
        SEGMENT21                  ,
        SEGMENT22                  ,
        SEGMENT23                  ,
        SEGMENT24                  ,
        SEGMENT25                  ,
        SEGMENT26                  ,
        SEGMENT27                  ,
        SEGMENT28                  ,
        SEGMENT29                  ,
        SEGMENT30                  ,
        COMMENTS                   ,
        ATTRIBUTE_CATEGORY         ,
        ATTRIBUTE1                 ,
        ATTRIBUTE2                 ,
        ATTRIBUTE3                 ,
        ATTRIBUTE4                 ,
        ATTRIBUTE5                 ,
        ATTRIBUTE6                 ,
        ATTRIBUTE7                 ,
        ATTRIBUTE8                 ,
        ATTRIBUTE9                 ,
        ATTRIBUTE10                ,
        ATTRIBUTE11                ,
        ATTRIBUTE12                ,
        ATTRIBUTE13                ,
        ATTRIBUTE14                ,
        ATTRIBUTE15                ,
        ACCTD_AMOUNT               ,
        INTERFACE_LINE_ATTRIBUTE10 ,
        INTERFACE_LINE_ATTRIBUTE11 ,
        INTERFACE_LINE_ATTRIBUTE12 ,
        INTERFACE_LINE_ATTRIBUTE13 ,
        INTERFACE_LINE_ATTRIBUTE14 ,
        INTERFACE_LINE_ATTRIBUTE15 ,
        INTERFACE_LINE_ATTRIBUTE9  ,
        CREATED_BY                 ,
        CREATION_DATE              ,
        LAST_UPDATED_BY            ,
        LAST_UPDATE_DATE           ,
        LAST_UPDATE_LOGIN          ,
        ORG_ID                     ,
        INTERIM_TAX_CCID           ,
        INTERIM_TAX_SEGMENT1       ,
        INTERIM_TAX_SEGMENT2       ,
        INTERIM_TAX_SEGMENT3       ,
        INTERIM_TAX_SEGMENT4       ,
        INTERIM_TAX_SEGMENT5       ,
        INTERIM_TAX_SEGMENT6       ,
        INTERIM_TAX_SEGMENT7       ,
        INTERIM_TAX_SEGMENT8       ,
        INTERIM_TAX_SEGMENT9       ,
        INTERIM_TAX_SEGMENT10      ,
        INTERIM_TAX_SEGMENT11      ,
        INTERIM_TAX_SEGMENT12      ,
        INTERIM_TAX_SEGMENT13      ,
        INTERIM_TAX_SEGMENT14      ,
        INTERIM_TAX_SEGMENT15      ,
        INTERIM_TAX_SEGMENT16      ,
        INTERIM_TAX_SEGMENT17      ,
        INTERIM_TAX_SEGMENT18      ,
        INTERIM_TAX_SEGMENT19      ,
        INTERIM_TAX_SEGMENT20      ,
        INTERIM_TAX_SEGMENT21      ,
        INTERIM_TAX_SEGMENT22      ,
        INTERIM_TAX_SEGMENT23      ,
        INTERIM_TAX_SEGMENT24      ,
        INTERIM_TAX_SEGMENT25      ,
        INTERIM_TAX_SEGMENT26      ,
        INTERIM_TAX_SEGMENT27      ,
        INTERIM_TAX_SEGMENT28      ,
        INTERIM_TAX_SEGMENT29      ,
        INTERIM_TAX_SEGMENT30
      )
      VALUES
      (
        r_distributions.INTERFACE_DISTRIBUTION_ID  ,
        r_distributions.INTERFACE_LINE_ID          ,
        r_distributions.INTERFACE_LINE_CONTEXT     ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE1  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE2  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE3  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE4  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE5  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE6  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE7  ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE8  ,
        r_distributions.ACCOUNT_CLASS              ,
        r_distributions.AMOUNT                     ,
        r_distributions.PERCENT                    ,
        r_distributions.INTERFACE_STATUS           ,
        r_distributions.REQUEST_ID                 ,
        r_distributions.CODE_COMBINATION_ID        ,
        r_distributions.SEGMENT1                   ,
        r_distributions.SEGMENT2                   ,
        r_distributions.SEGMENT3                   ,
        r_distributions.SEGMENT4                   ,
        r_distributions.SEGMENT5                   ,
        r_distributions.SEGMENT6                   ,
        r_distributions.SEGMENT7                   ,
        r_distributions.SEGMENT8                   ,
        r_distributions.SEGMENT9                   ,
        r_distributions.SEGMENT10                  ,
        r_distributions.SEGMENT11                  ,
        r_distributions.SEGMENT12                  ,
        r_distributions.SEGMENT13                  ,
        r_distributions.SEGMENT14                  ,
        r_distributions.SEGMENT15                  ,
        r_distributions.SEGMENT16                  ,
        r_distributions.SEGMENT17                  ,
        r_distributions.SEGMENT18                  ,
        r_distributions.SEGMENT19                  ,
        r_distributions.SEGMENT20                  ,
        r_distributions.SEGMENT21                  ,
        r_distributions.SEGMENT22                  ,
        r_distributions.SEGMENT23                  ,
        r_distributions.SEGMENT24                  ,
        r_distributions.SEGMENT25                  ,
        r_distributions.SEGMENT26                  ,
        r_distributions.SEGMENT27                  ,
        r_distributions.SEGMENT28                  ,
        r_distributions.SEGMENT29                  ,
        r_distributions.SEGMENT30                  ,
        r_distributions.COMMENTS                   ,
        r_distributions.ATTRIBUTE_CATEGORY         ,
        r_distributions.ATTRIBUTE1                 ,
        r_distributions.ATTRIBUTE2                 ,
        r_distributions.ATTRIBUTE3                 ,
        r_distributions.ATTRIBUTE4                 ,
        r_distributions.ATTRIBUTE5                 ,
        r_distributions.ATTRIBUTE6                 ,
        r_distributions.ATTRIBUTE7                 ,
        r_distributions.ATTRIBUTE8                 ,
        r_distributions.ATTRIBUTE9                 ,
        r_distributions.ATTRIBUTE10                ,
        r_distributions.ATTRIBUTE11                ,
        r_distributions.ATTRIBUTE12                ,
        r_distributions.ATTRIBUTE13                ,
        r_distributions.ATTRIBUTE14                ,
        r_distributions.ATTRIBUTE15                ,
        r_distributions.ACCTD_AMOUNT               ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE10 ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE11 ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE12 ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE13 ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE14 ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE15 ,
        r_distributions.INTERFACE_LINE_ATTRIBUTE9  ,
        r_distributions.CREATED_BY                 ,
        r_distributions.CREATION_DATE              ,
        r_distributions.LAST_UPDATED_BY            ,
        r_distributions.LAST_UPDATE_DATE           ,
        r_distributions.LAST_UPDATE_LOGIN          ,
        r_distributions.ORG_ID                     ,
        r_distributions.INTERIM_TAX_CCID           ,
        r_distributions.INTERIM_TAX_SEGMENT1       ,
        r_distributions.INTERIM_TAX_SEGMENT2       ,
        r_distributions.INTERIM_TAX_SEGMENT3       ,
        r_distributions.INTERIM_TAX_SEGMENT4       ,
        r_distributions.INTERIM_TAX_SEGMENT5       ,
        r_distributions.INTERIM_TAX_SEGMENT6       ,
        r_distributions.INTERIM_TAX_SEGMENT7       ,
        r_distributions.INTERIM_TAX_SEGMENT8       ,
        r_distributions.INTERIM_TAX_SEGMENT9       ,
        r_distributions.INTERIM_TAX_SEGMENT10      ,
        r_distributions.INTERIM_TAX_SEGMENT11      ,
        r_distributions.INTERIM_TAX_SEGMENT12      ,
        r_distributions.INTERIM_TAX_SEGMENT13      ,
        r_distributions.INTERIM_TAX_SEGMENT14      ,
        r_distributions.INTERIM_TAX_SEGMENT15      ,
        r_distributions.INTERIM_TAX_SEGMENT16      ,
        r_distributions.INTERIM_TAX_SEGMENT17      ,
        r_distributions.INTERIM_TAX_SEGMENT18      ,
        r_distributions.INTERIM_TAX_SEGMENT19      ,
        r_distributions.INTERIM_TAX_SEGMENT20      ,
        r_distributions.INTERIM_TAX_SEGMENT21      ,
        r_distributions.INTERIM_TAX_SEGMENT22      ,
        r_distributions.INTERIM_TAX_SEGMENT23      ,
        r_distributions.INTERIM_TAX_SEGMENT24      ,
        r_distributions.INTERIM_TAX_SEGMENT25      ,
        r_distributions.INTERIM_TAX_SEGMENT26      ,
        r_distributions.INTERIM_TAX_SEGMENT27      ,
        r_distributions.INTERIM_TAX_SEGMENT28      ,
        r_distributions.INTERIM_TAX_SEGMENT29      ,
        r_distributions.INTERIM_TAX_SEGMENT30
      );
  END LOOP;
  /* Inserting into ra_interface_salescredits_all Tables */
  FOR r_salescredits IN
  (SELECT INTERFACE_SALESCREDIT_ID ,
      INTERFACE_LINE_ID            ,
      INTERFACE_LINE_CONTEXT       ,
      INTERFACE_LINE_ATTRIBUTE1    ,
      INTERFACE_LINE_ATTRIBUTE2    ,
      INTERFACE_LINE_ATTRIBUTE3    ,
      INTERFACE_LINE_ATTRIBUTE4    ,
      INTERFACE_LINE_ATTRIBUTE5    ,
      INTERFACE_LINE_ATTRIBUTE6    ,
      INTERFACE_LINE_ATTRIBUTE7    ,
      INTERFACE_LINE_ATTRIBUTE8    ,
      SALESREP_NUMBER              ,
      SALESREP_ID                  ,
      SALES_CREDIT_TYPE_NAME       ,
      SALES_CREDIT_TYPE_ID         ,
      SALES_CREDIT_AMOUNT_SPLIT    ,
      SALES_CREDIT_PERCENT_SPLIT   ,
      INTERFACE_STATUS             ,
      REQUEST_ID                   ,
      ATTRIBUTE_CATEGORY           ,
      ATTRIBUTE1                   ,
      ATTRIBUTE2                   ,
      ATTRIBUTE3                   ,
      ATTRIBUTE4                   ,
      ATTRIBUTE5                   ,
      ATTRIBUTE6                   ,
      ATTRIBUTE7                   ,
      ATTRIBUTE8                   ,
      ATTRIBUTE9                   ,
      ATTRIBUTE10                  ,
      ATTRIBUTE11                  ,
      ATTRIBUTE12                  ,
      ATTRIBUTE13                  ,
      ATTRIBUTE14                  ,
      ATTRIBUTE15                  ,
      INTERFACE_LINE_ATTRIBUTE10   ,
      INTERFACE_LINE_ATTRIBUTE11   ,
      INTERFACE_LINE_ATTRIBUTE12   ,
      INTERFACE_LINE_ATTRIBUTE13   ,
      INTERFACE_LINE_ATTRIBUTE14   ,
      INTERFACE_LINE_ATTRIBUTE15   ,
      INTERFACE_LINE_ATTRIBUTE9    ,
      CREATED_BY                   ,
      CREATION_DATE                ,
      LAST_UPDATED_BY              ,
      LAST_UPDATE_DATE             ,
      LAST_UPDATE_LOGIN            ,
      ORG_ID                       ,
      SALESGROUP_ID
       FROM TABLE( p_salescredits)
  )
  LOOP
     INSERT
       INTO ra_interface_salescredits_all
      (
        INTERFACE_SALESCREDIT_ID   ,
        INTERFACE_LINE_ID          ,
        INTERFACE_LINE_CONTEXT     ,
        INTERFACE_LINE_ATTRIBUTE1  ,
        INTERFACE_LINE_ATTRIBUTE2  ,
        INTERFACE_LINE_ATTRIBUTE3  ,
        INTERFACE_LINE_ATTRIBUTE4  ,
        INTERFACE_LINE_ATTRIBUTE5  ,
        INTERFACE_LINE_ATTRIBUTE6  ,
        INTERFACE_LINE_ATTRIBUTE7  ,
        INTERFACE_LINE_ATTRIBUTE8  ,
        SALESREP_NUMBER            ,
        SALESREP_ID                ,
        SALES_CREDIT_TYPE_NAME     ,
        SALES_CREDIT_TYPE_ID       ,
        SALES_CREDIT_AMOUNT_SPLIT  ,
        SALES_CREDIT_PERCENT_SPLIT ,
        INTERFACE_STATUS           ,
        REQUEST_ID                 ,
        ATTRIBUTE_CATEGORY         ,
        ATTRIBUTE1                 ,
        ATTRIBUTE2                 ,
        ATTRIBUTE3                 ,
        ATTRIBUTE4                 ,
        ATTRIBUTE5                 ,
        ATTRIBUTE6                 ,
        ATTRIBUTE7                 ,
        ATTRIBUTE8                 ,
        ATTRIBUTE9                 ,
        ATTRIBUTE10                ,
        ATTRIBUTE11                ,
        ATTRIBUTE12                ,
        ATTRIBUTE13                ,
        ATTRIBUTE14                ,
        ATTRIBUTE15                ,
        INTERFACE_LINE_ATTRIBUTE10 ,
        INTERFACE_LINE_ATTRIBUTE11 ,
        INTERFACE_LINE_ATTRIBUTE12 ,
        INTERFACE_LINE_ATTRIBUTE13 ,
        INTERFACE_LINE_ATTRIBUTE14 ,
        INTERFACE_LINE_ATTRIBUTE15 ,
        INTERFACE_LINE_ATTRIBUTE9  ,
        CREATED_BY                 ,
        CREATION_DATE              ,
        LAST_UPDATED_BY            ,
        LAST_UPDATE_DATE           ,
        LAST_UPDATE_LOGIN          ,
        ORG_ID                     ,
        SALESGROUP_ID
      )
      VALUES
      (
        r_salescredits.INTERFACE_SALESCREDIT_ID   ,
        r_salescredits.INTERFACE_LINE_ID          ,
        r_salescredits.INTERFACE_LINE_CONTEXT     ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE1  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE2  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE3  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE4  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE5  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE6  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE7  ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE8  ,
        r_salescredits.SALESREP_NUMBER            ,
        r_salescredits.SALESREP_ID                ,
        r_salescredits.SALES_CREDIT_TYPE_NAME     ,
        r_salescredits.SALES_CREDIT_TYPE_ID       ,
        r_salescredits.SALES_CREDIT_AMOUNT_SPLIT  ,
        r_salescredits.SALES_CREDIT_PERCENT_SPLIT ,
        r_salescredits.INTERFACE_STATUS           ,
        r_salescredits.REQUEST_ID                 ,
        r_salescredits.ATTRIBUTE_CATEGORY         ,
        r_salescredits.ATTRIBUTE1                 ,
        r_salescredits.ATTRIBUTE2                 ,
        r_salescredits.ATTRIBUTE3                 ,
        r_salescredits.ATTRIBUTE4                 ,
        r_salescredits.ATTRIBUTE5                 ,
        r_salescredits.ATTRIBUTE6                 ,
        r_salescredits.ATTRIBUTE7                 ,
        r_salescredits.ATTRIBUTE8                 ,
        r_salescredits.ATTRIBUTE9                 ,
        r_salescredits.ATTRIBUTE10                ,
        r_salescredits.ATTRIBUTE11                ,
        r_salescredits.ATTRIBUTE12                ,
        r_salescredits.ATTRIBUTE13                ,
        r_salescredits.ATTRIBUTE14                ,
        r_salescredits.ATTRIBUTE15                ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE10 ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE11 ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE12 ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE13 ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE14 ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE15 ,
        r_salescredits.INTERFACE_LINE_ATTRIBUTE9  ,
        r_salescredits.CREATED_BY                 ,
        r_salescredits.CREATION_DATE              ,
        r_salescredits.LAST_UPDATED_BY            ,
        r_salescredits.LAST_UPDATE_DATE           ,
        r_salescredits.LAST_UPDATE_LOGIN          ,
        r_salescredits.ORG_ID                     ,
        r_salescredits.SALESGROUP_ID
      );
  END LOOP;

  /* Calling the Auto Invoice Concurrent Program */
  IF FND_API.to_boolean(p_run_autoinvoice_cp) THEN
    x_conc_req_ids := FND_TABLE_OF_NUMBER();
    FOR r_cp_input IN
    ( SELECT  DISTINCT 	org_id,
    			batch_source_name
     FROM TABLE(p_lines_all)
     )
    LOOP
      SELECT  batch_source_id INTO l_batch_source_id
      FROM ra_batch_sources_all
      WHERE ORG_ID = r_cp_input.ORG_ID
      AND NAME = r_cp_input.BATCH_SOURCE_NAME;


      apps.mo_global.init('AR');
      mo_global.set_policy_context('S',r_cp_input.ORG_ID);
      arp_global.init_global(r_cp_input.ORG_ID);
      arp_standard.init_standard(r_cp_input.ORG_ID);

      l_conc_req_id := FND_REQUEST.SUBMIT_REQUEST
      (
	 'AR'                           -- Application
	,'RAXMTR'                       -- Program : Autoinvoice Master Program
	,NULL
	,NULL
	,FALSE                          -- Sub_request
	,1       			-- No of AI instances.
	,r_cp_input.ORG_ID              -- Org Id.
	,l_batch_source_id             	-- Batch Source Id.
	,r_cp_input.BATCH_SOURCE_NAME   -- Batch Source Name.
	,FND_DATE.DATE_TO_CANONICAL(TRUNC(SYSDATE))    -- Default Date.
	,NULL                           -- Trxn Flexfield.
	,NULL                           -- Trxn Type.
	,NULL                           -- Bill To Customer Number Low.
	,NULL                           -- Bill To Customer Number High.
	,NULL                           -- Bill To Customer Name Low.
	,NULL                           -- Bill To Customer Name High.
	,NULL                           -- GL Date Low.
	,NULL                           -- GL Date High.
	,NULL                           -- Ship Date Low.
	,NULL                           -- Ship Date High.
	,NULL                           -- Trx Number Low. l_trx_number_low
	,NULL                           -- Trx Number High. l_trx_number_high
	,NULL                           -- Sales Order Low.
	,NULL                           -- Sales Order High.
	,NULL                           -- Trx Date Low.
	,NULL                           -- Trx Date High.
	,NULL                           -- Ship To Customer Number Low.
	,NULL                           -- Ship To Customer Number High.
	,NULL                           -- Ship To Customer Name Low.
	,NULL                           -- Ship To Customer Name High.
	,'Y'                            -- Base Due Date On Trx Date Flag.
	,NULL                           -- Due Date Adjustment Days.
	,CHR(0)                         -- End of Parameter List Indicator.
	,'', '', '', '', '', '', ''
	,'', '', '', '', '', '', '', '', '', ''
	,'', '', '', '', '', '', '', '', '', ''
	,'', '', '', '', '', '', '', '', '', ''
	,'', '', '', '', '', '', '', '', '', ''
	,'', '', '', '', '', '', '', '', '', ''
	,'', '', '', '', '', '', '', '', '', '');

      IF l_conc_req_id = 0 THEN
        FND_MESSAGE.set_name('AR','AR_EBI_CONC_PRO_SUBMIT_FAILED'); /*Concurrent program submission failed!!!!!*/
        FND_MSG_PUB.add;
        RAISE FND_API.G_EXC_UNEXPECTED_ERROR;
      END IF;

      x_conc_req_ids.EXTEND;
      x_conc_req_ids(x_conc_req_ids.COUNT) :=l_conc_req_id;
    END LOOP;
  END IF;

  IF FND_API.to_boolean(p_commit) THEN
    COMMIT;
  END IF;

EXCEPTION
  WHEN FND_API.G_EXC_UNEXPECTED_ERROR THEN
    x_return_status := FND_API.G_RET_STS_ERROR;
    IF (x_err_msg IS NULL) THEN
      FND_MSG_PUB.count_and_get(
         p_encoded => FND_API.G_FALSE,
         p_count => l_msg_count,
         p_data => x_err_msg
      );
    END IF;
    ROLLBACK TO ar_ebi_invoice_sub_save_pnt;

  WHEN OTHERS THEN
    x_return_status := FND_API.G_RET_STS_UNEXP_ERROR;
    x_err_msg       := SQLERRM ||' at EBI_AR_PKG.ar_invoice_submission ';
    ROLLBACK TO ar_ebi_invoice_sub_save_pnt;

END ar_invoice_submission;


END AR_EBI_INVOICE_PUB;


/
