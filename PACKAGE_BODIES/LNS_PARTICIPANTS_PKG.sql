--------------------------------------------------------
--  DDL for Package Body LNS_PARTICIPANTS_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."LNS_PARTICIPANTS_PKG" AS
/* $Header: LNS_PART_TBLH_B.pls 120.2 2006/01/18 19:59:48 karamach noship $ */

/* Insert_Row procedure */
PROCEDURE Insert_Row(x_PARTICIPANT_ID       IN OUT NOCOPY NUMBER
    ,p_LOAN_ID              NUMBER
    ,p_HZ_PARTY_ID          NUMBER
	,p_LOAN_PARTICIPANT_TYPE		VARCHAR2
	,p_START_DATE_ACTIVE		DATE
	,p_END_DATE_ACTIVE		DATE
	,p_CUST_ACCOUNT_ID		NUMBER
	,p_BILL_TO_ACCT_SITE_ID 	NUMBER
	,p_OBJECT_VERSION_NUMBER        NUMBER
	,p_ATTRIBUTE_CATEGORY		VARCHAR2
	,p_ATTRIBUTE1		VARCHAR2
	,p_ATTRIBUTE2		VARCHAR2
	,p_ATTRIBUTE3		VARCHAR2
	,p_ATTRIBUTE4		VARCHAR2
	,p_ATTRIBUTE5		VARCHAR2
	,p_ATTRIBUTE6		VARCHAR2
	,p_ATTRIBUTE7		VARCHAR2
	,p_ATTRIBUTE8		VARCHAR2
	,p_ATTRIBUTE9		VARCHAR2
	,p_ATTRIBUTE10		VARCHAR2
	,p_ATTRIBUTE11		VARCHAR2
	,p_ATTRIBUTE12		VARCHAR2
	,p_ATTRIBUTE13		VARCHAR2
	,p_ATTRIBUTE14		VARCHAR2
	,p_ATTRIBUTE15		VARCHAR2
	,p_ATTRIBUTE16		VARCHAR2
	,p_ATTRIBUTE17		VARCHAR2
	,p_ATTRIBUTE18		VARCHAR2
	,p_ATTRIBUTE19		VARCHAR2
	,p_ATTRIBUTE20		VARCHAR2
	,p_CONTACT_REL_PARTY_ID  NUMBER
	,p_CONTACT_PERS_PARTY_ID NUMBER
 ,p_CREDIT_REQUEST_ID	NUMBER
 ,p_CASE_FOLDER_ID				NUMBER
 ,p_review_type VARCHAR2
 ,p_credit_classification VARCHAR2
) IS

BEGIN

	INSERT INTO LNS_PARTICIPANTS
	(
		PARTICIPANT_ID
		,LOAN_ID
		,HZ_PARTY_ID
		,LOAN_PARTICIPANT_TYPE
		,START_DATE_ACTIVE
		,END_DATE_ACTIVE
		,CUST_ACCOUNT_ID
		,BILL_TO_ACCT_SITE_ID
		,CREATED_BY
		,CREATION_DATE
		,LAST_UPDATED_BY
		,LAST_UPDATE_DATE
		,LAST_UPDATE_LOGIN
		,OBJECT_VERSION_NUMBER
		,ATTRIBUTE_CATEGORY
		,ATTRIBUTE1
		,ATTRIBUTE2
		,ATTRIBUTE3
		,ATTRIBUTE4
		,ATTRIBUTE5
		,ATTRIBUTE6
		,ATTRIBUTE7
		,ATTRIBUTE8
		,ATTRIBUTE9
		,ATTRIBUTE10
		,ATTRIBUTE11
		,ATTRIBUTE12
		,ATTRIBUTE13
		,ATTRIBUTE14
		,ATTRIBUTE15
		,ATTRIBUTE16
		,ATTRIBUTE17
		,ATTRIBUTE18
		,ATTRIBUTE19
		,ATTRIBUTE20
		,CONTACT_REL_PARTY_ID
		,CONTACT_PERS_PARTY_ID
  ,CREDIT_REQUEST_ID
  ,CASE_FOLDER_ID
	,REVIEW_TYPE
	,CREDIT_CLASSIFICATION
	) VALUES (
         DECODE(x_participant_id, FND_API.G_MISS_NUM, LNS_PARTICIPANTS_S.NEXTVAL, NULL, LNS_PARTICIPANTS_S.NEXTVAL, x_participant_id)
        ,DECODE(p_LOAN_ID, FND_API.G_MISS_NUM, NULL, p_LOAN_ID)
        ,DECODE(p_HZ_PARTY_ID, FND_API.G_MISS_NUM, NULL, p_HZ_PARTY_ID)
        ,DECODE(p_LOAN_PARTICIPANT_TYPE, FND_API.G_MISS_CHAR, NULL, p_LOAN_PARTICIPANT_TYPE)
        ,DECODE(p_START_DATE_ACTIVE, FND_API.G_MISS_DATE, NULL, p_START_DATE_ACTIVE)
        ,DECODE(p_END_DATE_ACTIVE, FND_API.G_MISS_DATE, NULL, p_END_DATE_ACTIVE)
        ,DECODE(p_CUST_ACCOUNT_ID, FND_API.G_MISS_NUM, NULL, p_CUST_ACCOUNT_ID)
        ,DECODE(p_BILL_TO_ACCT_SITE_ID, FND_API.G_MISS_NUM, NULL, p_BILL_TO_ACCT_SITE_ID)
        ,LNS_UTILITY_PUB.CREATED_BY
        ,LNS_UTILITY_PUB.CREATION_DATE
        ,LNS_UTILITY_PUB.LAST_UPDATED_BY
        ,LNS_UTILITY_PUB.LAST_UPDATE_DATE
        ,LNS_UTILITY_PUB.LAST_UPDATE_LOGIN
        ,DECODE(p_OBJECT_VERSION_NUMBER, FND_API.G_MISS_NUM, NULL, 1)
        ,DECODE(p_ATTRIBUTE_CATEGORY, FND_API.G_MISS_NUM, NULL, p_ATTRIBUTE_CATEGORY)
        ,DECODE(p_ATTRIBUTE1, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE1)
        ,DECODE(p_ATTRIBUTE2, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE2)
        ,DECODE(p_ATTRIBUTE3, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE3)
        ,DECODE(p_ATTRIBUTE4, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE4)
        ,DECODE(p_ATTRIBUTE5, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE5)
        ,DECODE(p_ATTRIBUTE6, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE6)
        ,DECODE(p_ATTRIBUTE7, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE7)
        ,DECODE(p_ATTRIBUTE8, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE8)
        ,DECODE(p_ATTRIBUTE9, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE9)
        ,DECODE(p_ATTRIBUTE10, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE10)
        ,DECODE(p_ATTRIBUTE11, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE11)
        ,DECODE(p_ATTRIBUTE12, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE12)
        ,DECODE(p_ATTRIBUTE13, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE13)
        ,DECODE(p_ATTRIBUTE14, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE14)
        ,DECODE(p_ATTRIBUTE15, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE15)
        ,DECODE(p_ATTRIBUTE16, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE16)
        ,DECODE(p_ATTRIBUTE17, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE17)
        ,DECODE(p_ATTRIBUTE18, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE18)
        ,DECODE(p_ATTRIBUTE19, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE19)
        ,DECODE(p_ATTRIBUTE20, FND_API.G_MISS_CHAR, NULL, p_ATTRIBUTE20)
        ,DECODE(p_CONTACT_REL_PARTY_ID, FND_API.G_MISS_NUM, NULL, p_CONTACT_REL_PARTY_ID)
        ,DECODE(p_CONTACT_PERS_PARTY_ID, FND_API.G_MISS_NUM, NULL, p_CONTACT_PERS_PARTY_ID)
        ,DECODE(p_CREDIT_REQUEST_ID, FND_API.G_MISS_NUM, NULL, p_CREDIT_REQUEST_ID)
        ,DECODE(p_CASE_FOLDER_ID, FND_API.G_MISS_NUM, NULL, p_CASE_FOLDER_ID)
				,DECODE(p_REVIEW_TYPE, FND_API.G_MISS_CHAR, NULL, p_REVIEW_TYPE)
				,DECODE(p_CREDIT_CLASSIFICATION, FND_API.G_MISS_CHAR, NULL, p_CREDIT_CLASSIFICATION)
        ) RETURNING
	    PARTICIPANT_ID
	INTO
     	    x_participant_id;

END Insert_Row;

/* Update_Row procedure */
PROCEDURE Update_Row(x_rowid	VARCHAR2
    ,p_PARTICIPANT_ID           NUMBER
    ,p_LOAN_ID                  NUMBER
    ,p_HZ_PARTY_ID              NUMBER
    ,p_LOAN_PARTICIPANT_TYPE    VARCHAR2
    ,p_START_DATE_ACTIVE	DATE
    ,p_END_DATE_ACTIVE          DATE
    ,p_CUST_ACCOUNT_ID          NUMBER
    ,p_BILL_TO_ACCT_SITE_ID 	NUMBER
    ,p_OBJECT_VERSION_NUMBER    NUMBER
    ,p_ATTRIBUTE_CATEGORY	VARCHAR2
    ,p_ATTRIBUTE1               VARCHAR2
    ,p_ATTRIBUTE2               VARCHAR2
    ,p_ATTRIBUTE3               VARCHAR2
    ,p_ATTRIBUTE4               VARCHAR2
    ,p_ATTRIBUTE5               VARCHAR2
    ,p_ATTRIBUTE6               VARCHAR2
    ,p_ATTRIBUTE7               VARCHAR2
    ,p_ATTRIBUTE8               VARCHAR2
    ,p_ATTRIBUTE9               VARCHAR2
    ,p_ATTRIBUTE10              VARCHAR2
    ,p_ATTRIBUTE11              VARCHAR2
    ,p_ATTRIBUTE12              VARCHAR2
    ,p_ATTRIBUTE13              VARCHAR2
    ,p_ATTRIBUTE14              VARCHAR2
    ,p_ATTRIBUTE15              VARCHAR2
    ,p_ATTRIBUTE16              VARCHAR2
    ,p_ATTRIBUTE17              VARCHAR2
    ,p_ATTRIBUTE18              VARCHAR2
    ,p_ATTRIBUTE19              VARCHAR2
    ,p_ATTRIBUTE20              VARCHAR2
    ,p_CONTACT_REL_PARTY_ID  NUMBER
    ,p_CONTACT_PERS_PARTY_ID NUMBER
    ,p_CREDIT_REQUEST_ID	NUMBER
    ,p_CASE_FOLDER_ID				NUMBER
 ,p_review_type VARCHAR2
 ,p_credit_classification VARCHAR2
) IS
BEGIN

    UPDATE LNS_PARTICIPANTS SET
        --PARTICIPANT_ID = DECODE(p_PARTICIPANT_ID, FND_API.G_MISS_NUM, p_PARTICIPANT_ID, NULL, PARTICIPANT_ID)
        LOAN_ID = DECODE(p_LOAN_ID, FND_API.G_MISS_NUM, NULL, NULL, LOAN_ID, P_LOAN_ID)
        ,HZ_PARTY_ID = DECODE(p_HZ_PARTY_ID, FND_API.G_MISS_NUM, NULL, NULL, HZ_PARTY_ID, p_HZ_PARTY_ID)
        ,LOAN_PARTICIPANT_TYPE = DECODE(p_LOAN_PARTICIPANT_TYPE, FND_API.G_MISS_CHAR, NULL, NULL, LOAN_PARTICIPANT_TYPE, p_LOAN_PARTICIPANT_TYPE)
        ,START_DATE_ACTIVE = DECODE(p_START_DATE_ACTIVE, FND_API.G_MISS_DATE, NULL, NULL, START_DATE_ACTIVE, p_START_DATE_ACTIVE)
        ,END_DATE_ACTIVE = DECODE(p_END_DATE_ACTIVE, FND_API.G_MISS_DATE, NULL, NULL, END_DATE_ACTIVE, p_END_DATE_ACTIVE)
        ,CUST_ACCOUNT_ID = DECODE(p_CUST_ACCOUNT_ID, FND_API.G_MISS_NUM, NULL, NULL, CUST_ACCOUNT_ID, p_CUST_ACCOUNT_ID)
        ,BILL_TO_ACCT_SITE_ID = DECODE(p_BILL_TO_ACCT_SITE_ID, FND_API.G_MISS_NUM, NULL, NULL, BILL_TO_ACCT_SITE_ID, p_BILL_TO_ACCT_SITE_ID)
        ,LAST_UPDATED_BY = LNS_UTILITY_PUB.LAST_UPDATED_BY
        ,LAST_UPDATE_DATE = LNS_UTILITY_PUB.LAST_UPDATE_DATE
        ,LAST_UPDATE_LOGIN = LNS_UTILITY_PUB.LAST_UPDATE_LOGIN
        ,OBJECT_VERSION_NUMBER = DECODE(p_OBJECT_VERSION_NUMBER, FND_API.G_MISS_NUM, NULL, NULL, OBJECT_VERSION_NUMBER, p_OBJECT_VERSION_NUMBER)
        ,ATTRIBUTE_CATEGORY = DECODE(p_ATTRIBUTE_CATEGORY, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE_CATEGORY, p_ATTRIBUTE_CATEGORY)
        ,ATTRIBUTE1 = DECODE(p_ATTRIBUTE1, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE1, p_ATTRIBUTE1)
        ,ATTRIBUTE2 = DECODE(p_ATTRIBUTE2, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE2, p_ATTRIBUTE2)
        ,ATTRIBUTE3 = DECODE(p_ATTRIBUTE3, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE3, p_ATTRIBUTE3)
        ,ATTRIBUTE4 = DECODE(p_ATTRIBUTE4, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE4, p_ATTRIBUTE4)
        ,ATTRIBUTE5 = DECODE(p_ATTRIBUTE5, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE5, p_ATTRIBUTE5)
        ,ATTRIBUTE6 = DECODE(p_ATTRIBUTE6, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE6, p_ATTRIBUTE6)
        ,ATTRIBUTE7 = DECODE(p_ATTRIBUTE7, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE7, p_ATTRIBUTE7)
        ,ATTRIBUTE8 = DECODE(p_ATTRIBUTE8, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE8, p_ATTRIBUTE8)
        ,ATTRIBUTE9 = DECODE(p_ATTRIBUTE9, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE9, p_ATTRIBUTE9)
        ,ATTRIBUTE10 = DECODE(p_ATTRIBUTE10, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE10, p_ATTRIBUTE10)
        ,ATTRIBUTE11 = DECODE(p_ATTRIBUTE11, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE11, p_ATTRIBUTE11)
        ,ATTRIBUTE12 = DECODE(p_ATTRIBUTE12, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE12, p_ATTRIBUTE12)
        ,ATTRIBUTE13 = DECODE(p_ATTRIBUTE13, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE13, p_ATTRIBUTE13)
        ,ATTRIBUTE14 = DECODE(p_ATTRIBUTE14, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE14, p_ATTRIBUTE14)
        ,ATTRIBUTE15 = DECODE(p_ATTRIBUTE15, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE15, p_ATTRIBUTE15)
        ,ATTRIBUTE16 = DECODE(p_ATTRIBUTE16, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE16, p_ATTRIBUTE16)
        ,ATTRIBUTE17 = DECODE(p_ATTRIBUTE17, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE17, p_ATTRIBUTE17)
        ,ATTRIBUTE18 = DECODE(p_ATTRIBUTE18, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE18, p_ATTRIBUTE18)
        ,ATTRIBUTE19 = DECODE(p_ATTRIBUTE19, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE19, p_ATTRIBUTE19)
        ,ATTRIBUTE20 = DECODE(p_ATTRIBUTE20, FND_API.G_MISS_CHAR, NULL, NULL, ATTRIBUTE20, p_ATTRIBUTE20)
        ,CONTACT_REL_PARTY_ID = DECODE(p_CONTACT_REL_PARTY_ID, FND_API.G_MISS_NUM, NULL, NULL, CONTACT_REL_PARTY_ID, p_CONTACT_REL_PARTY_ID)
        ,CONTACT_PERS_PARTY_ID = DECODE(p_CONTACT_PERS_PARTY_ID, FND_API.G_MISS_NUM, NULL, NULL, CONTACT_PERS_PARTY_ID, p_CONTACT_PERS_PARTY_ID)
        ,CREDIT_REQUEST_ID = DECODE(p_CREDIT_REQUEST_ID, FND_API.G_MISS_NUM, NULL, NULL, CREDIT_REQUEST_ID, p_CREDIT_REQUEST_ID)
        ,CASE_FOLDER_ID = DECODE(p_CASE_FOLDER_ID, FND_API.G_MISS_NUM, NULL, NULL, CASE_FOLDER_ID, p_CASE_FOLDER_ID)
        ,REVIEW_TYPE = DECODE(p_REVIEW_TYPE, FND_API.G_MISS_CHAR, NULL, NULL, REVIEW_TYPE, p_REVIEW_TYPE)
        ,CREDIT_CLASSIFICATION = DECODE(p_CREDIT_CLASSIFICATION, FND_API.G_MISS_CHAR, NULL, NULL, CREDIT_CLASSIFICATION, p_CREDIT_CLASSIFICATION)
     WHERE PARTICIPANT_ID= p_PARTICIPANT_ID;

	if (sql%notfound) then
		raise no_data_found;
	end if;
END Update_Row;

/* Delete_Row procedure */
PROCEDURE Delete_Row(x_rowid VARCHAR2) IS
BEGIN
	DELETE FROM LNS_PARTICIPANTS
		WHERE rowid = x_rowid;

	if (sql%notfound) then
		raise no_data_found;
	end if;
END Delete_Row;

/* Lock_Row procedure */
PROCEDURE Lock_Row(x_rowid	VARCHAR2
	,p_PARTICIPANT_ID		NUMBER
	,p_LOAN_ID		NUMBER
	,p_HZ_PARTY_ID		NUMBER
	,p_LOAN_PARTICIPANT_TYPE		VARCHAR2
	,p_START_DATE_ACTIVE		DATE
	,p_END_DATE_ACTIVE		DATE
	,p_CUST_ACCOUNT_ID		NUMBER
	,p_BILL_TO_ACCT_SITE_ID 	NUMBER
	,p_CREATED_BY		NUMBER
	,p_CREATION_DATE		DATE
	,p_LAST_UPDATED_BY		NUMBER
	,p_LAST_UPDATE_DATE		DATE
	,p_LAST_UPDATE_LOGIN		NUMBER
	,p_OBJECT_VERSION_NUMBER		NUMBER
	,p_ATTRIBUTE_CATEGORY		VARCHAR2
	,p_ATTRIBUTE1		VARCHAR2
	,p_ATTRIBUTE2		VARCHAR2
	,p_ATTRIBUTE3		VARCHAR2
	,p_ATTRIBUTE4		VARCHAR2
	,p_ATTRIBUTE5		VARCHAR2
	,p_ATTRIBUTE6		VARCHAR2
	,p_ATTRIBUTE7		VARCHAR2
	,p_ATTRIBUTE8		VARCHAR2
	,p_ATTRIBUTE9		VARCHAR2
	,p_ATTRIBUTE10		VARCHAR2
	,p_ATTRIBUTE11		VARCHAR2
	,p_ATTRIBUTE12		VARCHAR2
	,p_ATTRIBUTE13		VARCHAR2
	,p_ATTRIBUTE14		VARCHAR2
	,p_ATTRIBUTE15		VARCHAR2
	,p_ATTRIBUTE16		VARCHAR2
	,p_ATTRIBUTE17		VARCHAR2
	,p_ATTRIBUTE18		VARCHAR2
	,p_ATTRIBUTE19		VARCHAR2
	,p_ATTRIBUTE20		VARCHAR2
	,p_CONTACT_REL_PARTY_ID  NUMBER
	,p_CONTACT_PERS_PARTY_ID NUMBER
 ,p_CREDIT_REQUEST_ID	NUMBER
 ,p_CASE_FOLDER_ID				NUMBER
 ,p_review_type VARCHAR2
 ,p_credit_classification VARCHAR2
) IS
	CURSOR C IS SELECT * FROM LNS_PARTICIPANTS
		WHERE rowid = x_rowid
		FOR UPDATE of PARTICIPANT_ID NOWAIT;
	Recinfo C%ROWTYPE;
BEGIN
	OPEN C;
	FETCH C INTO Recinfo;
	IF (C%NOTFOUND) THEN
		CLOSE C;
		FND_MESSAGE.Set_Name('FND', 'FORM_RECORD_DELETED');
		APP_EXCEPTION.Raise_Exception;
	END IF;
	CLOSE C;

	IF (
		(Recinfo.PARTICIPANT_ID = p_PARTICIPANT_ID)
		AND ( (Recinfo.OBJECT_VERSION_NUMBER = p_OBJECT_VERSION_NUMBER)
			OR ( (Recinfo.OBJECT_VERSION_NUMBER IS NULL)
				AND (p_OBJECT_VERSION_NUMBER IS NULL)))
	   ) THEN
		return;
	ELSE
		FND_MESSAGE.Set_Name('FND', 'FORM_RECORD_CHANGED');
		APP_EXCEPTION.Raise_Exception;
	END IF;
END Lock_Row;
END;


/
