--------------------------------------------------------
--  DDL for Package Body FA_FAHYPWIF_XMLP_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."FA_FAHYPWIF_XMLP_PKG" AS
/* $Header: FAHYPWIFB.pls 120.1.12010000.1 2008/07/28 13:12:04 appldev ship $ */

  FUNCTION BEFOREREPORT RETURN BOOLEAN IS
  BEGIN
    P_CONC_REQUEST_ID := FND_GLOBAL.CONC_REQUEST_ID;

   SELECT SUBSTR(ARGUMENT1,INSTR(ARGUMENT1,'=',1,1)+1)
	INTO P_CONC_REQUEST_ID_RX
	FROM FND_CONCURRENT_REQUESTS
	WHERE REQUEST_ID =P_CONC_REQUEST_ID;

    SELECT SUBSTR(ARGUMENT2,INSTR(ARGUMENT2,'=',1,1)+1)
	INTO P_BOOK1
	FROM FND_CONCURRENT_REQUESTS
	WHERE REQUEST_ID =P_CONC_REQUEST_ID;

    SELECT SUBSTR(ARGUMENT2,INSTR(ARGUMENT2,'=',1,1)+1)
	INTO P_BOOK1
	FROM FND_CONCURRENT_REQUESTS
	WHERE REQUEST_ID =P_CONC_REQUEST_ID;

	SELECT SUBSTR(ARGUMENT3,INSTR(ARGUMENT3,'=',1,1)+1)
	INTO P_CURRENCY1
	FROM FND_CONCURRENT_REQUESTS
	WHERE REQUEST_ID =P_CONC_REQUEST_ID;
    DECLARE
      L_CURRENCY_CODE VARCHAR2(15);
      L_PRECISION NUMBER(15);
      L_COMPANY_NAME VARCHAR2(30);
    BEGIN
      SELECT
        SC.COMPANY_NAME
      INTO
        L_COMPANY_NAME
      FROM
        FA_SYSTEM_CONTROLS SC;
      SELECT
        SOB.CURRENCY_CODE,
        CUR.PRECISION
      INTO
        L_CURRENCY_CODE
        ,L_PRECISION
      FROM
        FA_BOOK_CONTROLS BC,
        GL_SETS_OF_BOOKS SOB,
        FND_CURRENCIES CUR
      --WHERE BC.BOOK_TYPE_CODE = P_BOOK
      WHERE BC.BOOK_TYPE_CODE = P_BOOK1
        AND SOB.SET_OF_BOOKS_ID = BC.SET_OF_BOOKS_ID
        AND CUR.CURRENCY_CODE = SOB.CURRENCY_CODE;
      RP_COMPANY_NAME := L_COMPANY_NAME;
      C_CURRENCY_CODE := L_CURRENCY_CODE;
      P_MIN_PRECISION := L_PRECISION;
      C_CURRENCY_CODE := P_CURRENCY1;
      --C_CURRENCY_CODE := P_CURRENCY;
      DECLARE
        L_REPORT_NAME VARCHAR2(80);
        L_CONC_PROGRAM_ID NUMBER;
      BEGIN
        SELECT
          CR.CONCURRENT_PROGRAM_ID
        INTO
          L_CONC_PROGRAM_ID
        FROM
          FND_CONCURRENT_REQUESTS CR
        WHERE CR.PROGRAM_APPLICATION_ID = 140
          AND CR.REQUEST_ID = P_CONC_REQUEST_ID;
        SELECT
          CP.USER_CONCURRENT_PROGRAM_NAME
        INTO
          L_REPORT_NAME
        FROM
          FND_CONCURRENT_PROGRAMS_VL CP
        WHERE CP.CONCURRENT_PROGRAM_ID = L_CONC_PROGRAM_ID
          AND CP.APPLICATION_ID = 140;
        RP_REPORT_NAME := L_REPORT_NAME;
	--Added
	IF (UPPER(RP_REPORT_NAME) LIKE 'HYPOTHETICAL%WHAT%IF%REPORT%(XML)%') THEN
		RP_REPORT_NAME := 'Hypothetical What If Report';
	END IF;

      EXCEPTION
        WHEN OTHERS THEN
          RP_REPORT_NAME := 'Hypothetical What-If Report';
      END;
      RETURN (TRUE);
    EXCEPTION
      WHEN OTHERS THEN
        RETURN (FALSE);
    END;
  END BEFOREREPORT;

  FUNCTION AFTERREPORT RETURN BOOLEAN IS
  BEGIN
    RETURN (TRUE);
  END AFTERREPORT;

  FUNCTION RP_COMPANY_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN RP_COMPANY_NAME;
  END RP_COMPANY_NAME_P;

  FUNCTION RP_REPORT_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN RP_REPORT_NAME;
  END RP_REPORT_NAME_P;

  FUNCTION C_CURRENCY_CODE_P RETURN VARCHAR2 IS
  BEGIN
    RETURN C_CURRENCY_CODE;
  END C_CURRENCY_CODE_P;

END FA_FAHYPWIF_XMLP_PKG;

/
