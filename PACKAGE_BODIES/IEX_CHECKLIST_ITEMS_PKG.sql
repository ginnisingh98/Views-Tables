--------------------------------------------------------
--  DDL for Package Body IEX_CHECKLIST_ITEMS_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."IEX_CHECKLIST_ITEMS_PKG" AS
/* $Header: iextchkb.pls 120.0 2005/06/22 14:26:05 jypark noship $ */
PG_DEBUG NUMBER(2) ;

PROCEDURE ADD_LANGUAGE
IS
BEGIN
  DELETE FROM IEX_CHECKLIST_ITEMS_TL T
  WHERE NOT EXISTS
    (SELECT NULL
    FROM IEX_CHECKLIST_ITEMS_B B
    WHERE B.CHECKLIST_ITEM_ID = T.CHECKLIST_ITEM_ID
    );

  UPDATE IEX_CHECKLIST_ITEMS_TL T SET
    (CHECKLIST_ITEM_TEXT ) =
       (SELECT
        B.CHECKLIST_ITEM_TEXT
        FROM IEX_CHECKLIST_ITEMS_TL B
        WHERE B.CHECKLIST_ITEM_ID = T.CHECKLIST_ITEM_ID
        AND B.LANGUAGE = T.SOURCE_LANG)
    WHERE (T.CHECKLIST_ITEM_ID,
         T.LANGUAGE) IN
    (SELECT
      SUBT.CHECKLIST_ITEM_ID,
      SUBT.LANGUAGE
    FROM IEX_CHECKLIST_ITEMS_TL SUBB, IEX_CHECKLIST_ITEMS_TL SUBT
    WHERE SUBB.CHECKLIST_ITEM_ID = SUBT.CHECKLIST_ITEM_ID
    AND SUBB.LANGUAGE = SUBT.SOURCE_LANG
    AND (SUBB.CHECKLIST_ITEM_TEXT <> SUBT.CHECKLIST_ITEM_TEXT)
      OR (SUBB.CHECKLIST_ITEM_TEXT IS NULL AND SUBT.CHECKLIST_ITEM_TEXT IS NOT NULL)
      OR (SUBB.CHECKLIST_ITEM_TEXT IS NOT NULL AND SUBT.CHECKLIST_ITEM_TEXT IS NULL)
  );

  INSERT INTO IEX_CHECKLIST_ITEMS_TL (
    CHECKLIST_ITEM_ID,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN,
    CREATION_DATE,
    CREATED_BY,
    CHECKLIST_ITEM_TEXT,
    DESCRIPTION,
    LANGUAGE,
    SOURCE_LANG
  ) SELECT
    B.CHECKLIST_ITEM_ID,
    B.LAST_UPDATE_DATE,
    B.LAST_UPDATED_BY,
    B.LAST_UPDATE_LOGIN,
    B.CREATION_DATE,
    B.CREATED_BY,
    B.CHECKLIST_ITEM_TEXT,
    B.DESCRIPTION,
    L.LANGUAGE_CODE,
    B.SOURCE_LANG
  FROM IEX_CHECKLIST_ITEMS_TL B, FND_LANGUAGES L
  WHERE L.INSTALLED_FLAG IN ('I', 'B')
  AND B.LANGUAGE = userenv('LANG')
  AND NOT EXISTS
    (SELECT NULL
    FROM IEX_CHECKLIST_ITEMS_TL T
    WHERE T.CHECKLIST_ITEM_ID = B.CHECKLIST_ITEM_ID
    AND T.LANGUAGE = L.LANGUAGE_CODE);
END ADD_LANGUAGE;

BEGIN
  PG_DEBUG := TO_NUMBER(NVL(FND_PROFILE.value('IEX_DEBUG_LEVEL'), '20'));

END IEX_CHECKLIST_ITEMS_PKG;

/
