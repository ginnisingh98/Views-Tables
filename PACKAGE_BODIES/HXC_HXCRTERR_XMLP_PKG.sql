--------------------------------------------------------
--  DDL for Package Body HXC_HXCRTERR_XMLP_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."HXC_HXCRTERR_XMLP_PKG" AS
/* $Header: HXCRTERRB.pls 120.1 2007/12/20 14:04:58 amakrish noship $ */
  FUNCTION CF_RESOURCEFORMULA(RESOURCE_TYPE IN VARCHAR2
                             ,RESOURCE_ID IN NUMBER) RETURN CHAR IS
    CURSOR C_EMP_DTL(CP_PERSON_ID IN NUMBER,CP_EFFECTIVE_DATE IN DATE) IS
      SELECT
        PPF.LAST_NAME,
        NVL(PPF.EMPLOYEE_NUMBER
           ,PPF.NPW_NUMBER) EMPLOYEE_NUMBER
      FROM
        PER_PEOPLE_F PPF
      WHERE PPF.PERSON_ID = CP_PERSON_ID
        AND CP_EFFECTIVE_DATE between PPF.EFFECTIVE_START_DATE
        AND PPF.EFFECTIVE_END_DATE;
  BEGIN
    IF RESOURCE_TYPE = 'PERSON' THEN
      OPEN C_EMP_DTL(RESOURCE_ID,P_END_DATE);
      FETCH C_EMP_DTL
       INTO
         CP_LAST_NAME
         ,CP_EMPLOYEE_NUMBER;
      CLOSE C_EMP_DTL;
    END IF;
    RETURN CP_EMPLOYEE_NUMBER;
  END CF_RESOURCEFORMULA;

  FUNCTION AFTERPFORM RETURN BOOLEAN IS
    CURSOR C_RETRIEVAL_PROCESS(CP_RETRIEVAL_PROCESS_ID IN NUMBER) IS
      SELECT
        HRP.NAME
      FROM
        HXC_RETRIEVAL_PROCESSES HRP
      WHERE HRP.RETRIEVAL_PROCESS_ID = CP_RETRIEVAL_PROCESS_ID;
    CURSOR C_BEE_RET_PROCESS_ID IS
      SELECT
        RP.RETRIEVAL_PROCESS_ID
      FROM
        HXC_RETRIEVAL_PROCESSES RP
      WHERE NAME = 'BEE Retrieval Process';
  BEGIN
    OPEN C_BEE_RET_PROCESS_ID;
    FETCH C_BEE_RET_PROCESS_ID
     INTO
       P_BEE_RP_ID;
    CLOSE C_BEE_RET_PROCESS_ID;
    IF P_RETRIEVAL_PROCESS IS NOT NULL THEN
      OPEN C_RETRIEVAL_PROCESS(P_RETRIEVAL_PROCESS);
      FETCH C_RETRIEVAL_PROCESS
       INTO
         P_RETRIEVAL_PROCESS_LABEL;
      CLOSE C_RETRIEVAL_PROCESS;
    END IF;
    RETURN (TRUE);
  END AFTERPFORM;

  FUNCTION BEFOREREPORT RETURN BOOLEAN IS
  BEGIN
    P_CONC_REQUEST_ID := FND_GLOBAL.CONC_REQUEST_ID;
P_START_DATE_DSP := TO_CHAR (P_START_DATE,'DD-MON-YYYY');
P_END_DATE_DSP := TO_CHAR (P_END_DATE,'DD-MON-YYYY');
    RETURN (TRUE);
  END BEFOREREPORT;

  FUNCTION AFTERREPORT RETURN BOOLEAN IS
  BEGIN
    RETURN (TRUE);
  END AFTERREPORT;

  FUNCTION CP_EMPLOYEE_NUMBER_P RETURN VARCHAR2 IS
  BEGIN
    RETURN CP_EMPLOYEE_NUMBER;
  END CP_EMPLOYEE_NUMBER_P;

  FUNCTION CP_LAST_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN CP_LAST_NAME;
  END CP_LAST_NAME_P;

END HXC_HXCRTERR_XMLP_PKG;

/
