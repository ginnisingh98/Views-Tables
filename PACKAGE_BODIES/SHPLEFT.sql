--------------------------------------------------------
--  DDL for Package Body SHPLEFT
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."SHPLEFT" AS
/* $Header: SHPLEFTB.pls 115.1 99/07/16 08:17:31 porting shi $ */

function SOMETHING_LEFT_TO_SHIP
   (O_LINE_ID                       IN NUMBER       DEFAULT NULL)
   RETURN VARCHAR2
IS

	LEFT_TO_SHIP		VARCHAR2(1) := 'Y';


BEGIN


	SELECT
		NVL(MAX('N'), 'Y')
	INTO
		LEFT_TO_SHIP
	FROM
 		DUAL
	WHERE
		NOT EXISTS
		  (SELECT
			'OPEN/PENDING PICK SLIP EXISTS'
		   FROM
			SO_PICKING_LINES PL, SO_PICKING_HEADERS PH
		   WHERE
			PL.ORDER_LINE_ID = O_LINE_ID AND
			PH.PICKING_HEADER_ID = PL.PICKING_HEADER_ID AND
			PH.STATUS_CODE || '' IN ('OPEN', 'PENDING'))
	AND    NOT EXISTS
		 (SELECT
			'ANY UNRELEASED LINE DETAIL IF PR IN CYCLE'
		  FROM
			SO_CYCLE_ACTIONS CA,
			SO_ORDER_TYPES OT,
			SO_HEADERS H,
			SO_LINES L,
			SO_LINE_DETAILS LD
		  WHERE
			LD.LINE_ID = O_LINE_ID AND
			LD.RELEASED_FLAG = 'N' AND
			LD.SHIPPABLE_FLAG = 'Y' AND
			LD.LINE_ID = L.LINE_ID AND
			L.HEADER_ID = H.HEADER_ID AND
			H.ORDER_TYPE_ID = OT.ORDER_TYPE_ID AND
			OT.CYCLE_ID = CA.CYCLE_ID AND
			CA.ACTION_ID = 2)
	AND    NOT EXISTS
		 (SELECT
		       'BACKORDERED PICKING LINES'
		  FROM
		       SO_PICKING_LINES PL
		  WHERE
		       PL.ORDER_LINE_ID = O_LINE_ID AND
		       PL.PICKING_HEADER_ID+0 = 0 AND
		       NVL(PL.CANCELLED_QUANTITY, 0) < PL.REQUESTED_QUANTITY);


	RETURN(LEFT_TO_SHIP);

END;

END SHPLEFT;

/
