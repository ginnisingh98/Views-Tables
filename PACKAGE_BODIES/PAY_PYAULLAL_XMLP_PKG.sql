--------------------------------------------------------
--  DDL for Package Body PAY_PYAULLAL_XMLP_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."PAY_PYAULLAL_XMLP_PKG" AS
/* $Header: PYAULLALB.pls 120.0 2007/12/13 12:14:26 amakrish noship $ */
  FUNCTION BEFOREREPORT RETURN BOOLEAN IS
    CURSOR C_CURRENCY IS
      SELECT
        CURRENCY_CODE,
        PRECISION
      FROM
        FND_CURRENCIES
      WHERE ISSUING_TERRITORY_CODE in (
        SELECT
          I.ORG_INFORMATION9
        FROM
          HR_ORGANIZATION_INFORMATION I
        WHERE I.ORGANIZATION_ID = P_BUSINESS_GROUP_ID
          AND I.ORG_INFORMATION_CONTEXT = 'Business Group Information' );
    L_CURRENCY C_CURRENCY%ROWTYPE;
  BEGIN
    P_CONC_REQUEST_ID := FND_GLOBAL.CONC_REQUEST_ID;
    OPEN C_CURRENCY;
    FETCH C_CURRENCY
     INTO
       L_CURRENCY;
    IF C_CURRENCY%FOUND THEN
      CP_CURRENCY_CODE := '(' || L_CURRENCY.CURRENCY_CODE || ')';
      CP_CURRENCY_FORMAT := FND_CURRENCY.GET_FORMAT_MASK(L_CURRENCY.CURRENCY_CODE
                                                        ,20);
      CP_PRECISION := L_CURRENCY.PRECISION;
    END IF;
    CLOSE C_CURRENCY;
    RETURN (TRUE);
  END BEFOREREPORT;

  FUNCTION AFTERREPORT RETURN BOOLEAN IS
  BEGIN
    RETURN (TRUE);
  END AFTERREPORT;

  FUNCTION CF_TOTAL_VALUEFORMULA(ENTITLEMENT_VALUE IN NUMBER
                                ,ACCRUAL_VALUE IN NUMBER) RETURN NUMBER IS
  BEGIN
    RETURN NVL(ENTITLEMENT_VALUE
              ,0) + NVL(ACCRUAL_VALUE
              ,0);
  END CF_TOTAL_VALUEFORMULA;

  FUNCTION CF_BUSINESS_GROUP_IDFORMULA RETURN VARCHAR2 IS
    V_BUSINESS_GROUP HR_ALL_ORGANIZATION_UNITS.NAME%TYPE;
  BEGIN
    V_BUSINESS_GROUP := HR_REPORTS.GET_BUSINESS_GROUP(P_BUSINESS_GROUP_ID);
    RETURN V_BUSINESS_GROUP;
  END CF_BUSINESS_GROUP_IDFORMULA;

  FUNCTION CF_PAYROLL_ACTIONFORMULA RETURN VARCHAR2 IS
    CURSOR C_PAYROLL_ACTION_DESC IS
      SELECT
        TO_CHAR(EFFECTIVE_DATE
               ,'DD-MON-YYYY') || ' (' || TO_CHAR(PAYROLL_ACTION_ID) || ')' PAYROLL_ACTION_DESC
      FROM
        PAY_PAYROLL_ACTIONS
      WHERE PAYROLL_ACTION_ID = P_PAYROLL_ACTION_ID;
    L_PAYROLL_ACTION_DESC VARCHAR2(60);
  BEGIN
    OPEN C_PAYROLL_ACTION_DESC;
    FETCH C_PAYROLL_ACTION_DESC
     INTO
       L_PAYROLL_ACTION_DESC;
    CLOSE C_PAYROLL_ACTION_DESC;
    RETURN L_PAYROLL_ACTION_DESC;
  END CF_PAYROLL_ACTIONFORMULA;

  FUNCTION CF_PAYROLLFORMULA RETURN VARCHAR2 IS
    L_PAYROLL PAY_PAYROLLS_F.PAYROLL_NAME%TYPE;
    CURSOR C_PAYROLL IS
      SELECT
        PAYROLL_NAME
      FROM
        PAY_PAYROLLS_F
      WHERE PAYROLL_ID = P_PAYROLL;
  BEGIN
    OPEN C_PAYROLL;
    FETCH C_PAYROLL
     INTO
       L_PAYROLL;
    CLOSE C_PAYROLL;
    RETURN L_PAYROLL;
  END CF_PAYROLLFORMULA;

  FUNCTION CF_COST_CENTREFORMULA RETURN VARCHAR2 IS
    L_COST_CENTRE PAY_COST_ALLOCATION_KEYFLEX.CONCATENATED_SEGMENTS%TYPE;
    CURSOR C_COST_CENTRE IS
      SELECT
        CONCATENATED_SEGMENTS
      FROM
        PAY_COST_ALLOCATION_KEYFLEX
      WHERE COST_ALLOCATION_KEYFLEX_ID = P_COST_ALLOCATION_KEYFLEX_ID;
  BEGIN
    OPEN C_COST_CENTRE;
    FETCH C_COST_CENTRE
     INTO
       L_COST_CENTRE;
    CLOSE C_COST_CENTRE;
    RETURN L_COST_CENTRE;
  END CF_COST_CENTREFORMULA;

  FUNCTION CP_CURRENCY_FORMAT_P RETURN VARCHAR2 IS
  BEGIN
    RETURN CP_CURRENCY_FORMAT;
  END CP_CURRENCY_FORMAT_P;

  FUNCTION CP_CURRENCY_CODE_P RETURN VARCHAR2 IS
  BEGIN
    RETURN CP_CURRENCY_CODE;
  END CP_CURRENCY_CODE_P;

  FUNCTION CP_PRECISION_P RETURN NUMBER IS
  BEGIN
    RETURN CP_PRECISION;
  END CP_PRECISION_P;

END PAY_PYAULLAL_XMLP_PKG;

/
