--------------------------------------------------------
--  DDL for Package Body QPR_PN_REQUEST_HDRS_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."QPR_PN_REQUEST_HDRS_PKG" as
/* $Header: QPRUPRHB.pls 120.0 2007/12/24 20:04:39 vinnaray noship $ */
procedure INSERT_ROW (
  X_ROWID in out nocopy VARCHAR2,
  X_REQUEST_HEADER_ID in NUMBER,
  X_SOURCE_REF_HDR_LONG_DESC in VARCHAR2,
--  X_ORG_SHORT_DESC in VARCHAR2,
--  X_ORG_LONG_DESC in VARCHAR2,
  X_CUSTOMER_SHORT_DESC in VARCHAR2,
  X_CUSTOMER_LONG_DESC in VARCHAR2,
  --X_CONTRACT_SHORT_DESC in VARCHAR2,
  --X_CONTRACT_LONG_DESC in VARCHAR2,
  X_SALES_REP_SHORT_DESC in VARCHAR2,
  X_SALES_REP_LONG_DESC in VARCHAR2,
  X_SALES_CHANNEL_SHORT_DESC in VARCHAR2,
  X_SALES_CHANNEL_LONG_DESC in VARCHAR2,
  X_FREIGHT_TERMS_SHORT_DESC in VARCHAR2,
  X_FREIGHT_TERMS_LONG_DESC in VARCHAR2,
  X_PAYMENT_TERMS_SHORT_DESC in VARCHAR2,
  X_PAYMENT_TERMS_LONG_DESC in VARCHAR2,
  X_COMMENTS in VARCHAR2,
  X_MEASURE1_NUMBER in NUMBER,
  X_MEASURE2_NUMBER in NUMBER,
  X_MEASURE3_NUMBER in NUMBER,
  X_MEASURE4_NUMBER in NUMBER,
  X_MEASURE5_NUMBER in NUMBER,
  X_MEASURE6_NUMBER in NUMBER,
  X_MEASURE7_NUMBER in NUMBER,
  X_MEASURE8_NUMBER in NUMBER,
  X_MEASURE9_NUMBER in NUMBER,
  X_MEASURE10_NUMBER in NUMBER,
  X_MEASURE1_CHAR in VARCHAR2,
  X_MEASURE2_CHAR in VARCHAR2,
  X_MEASURE3_CHAR in VARCHAR2,
  X_MEASURE4_CHAR in VARCHAR2,
  X_MEASURE5_CHAR in VARCHAR2,
  X_MEASURE6_CHAR in VARCHAR2,
  X_MEASURE7_CHAR in VARCHAR2,
  X_MEASURE8_CHAR in VARCHAR2,
  X_MEASURE9_CHAR in VARCHAR2,
  X_MEASURE10_CHAR in VARCHAR2,
--  X_PROGRAM_LOGIN_ID in NUMBER,
--  X_REQUEST_ID in NUMBER,
  X_INSTANCE_ID in NUMBER,
  X_SIMULATION_FLAG in VARCHAR2,
  X_CUSTOMER_SK in VARCHAR2,
  X_SALES_CHANNEL_SK in VARCHAR2,
  X_SALES_REP_SK in VARCHAR2,
  X_PN_INT_HEADER_ID in NUMBER,
  X_SOURCE_ID in NUMBER,
  X_SOURCE_REF_HDR_ID in NUMBER,
  X_CUSTOMER_ID in NUMBER,
  --X_CONTRACT_ID in NUMBER,
  X_SALES_REP_ID in NUMBER,
  X_PAYMENT_TERMS_ID in NUMBER,
  X_INVOICE_TO_PARTY_SITE_ID in NUMBER,
  X_SALES_REP_EMAIL in VARCHAR2,
  X_SALES_CHANNEL_CODE in VARCHAR2,
  X_DEAL_EXPIRY_DATE in DATE,
  X_DEAL_CREATION_DATE in DATE,
  X_INVOICE_TO_PARTY_SITE_ADDRES in VARCHAR2,
  --X_PRIORITY in VARCHAR2,
  X_CURRENCY_SHORT_DESC in VARCHAR2,
  X_CURRENCY_LONG_DESC in VARCHAR2,
  X_SOURCE_SHORT_DESC in VARCHAR2,
  X_SOURCE_LONG_DESC in VARCHAR2,
  X_SOURCE_REF_HDR_SHORT_DESC in VARCHAR2,
  X_REFERENCE_NAME in VARCHAR2,
  X_CREATION_DATE in DATE,
  X_CREATED_BY in NUMBER,
  X_LAST_UPDATE_DATE in DATE,
  X_LAST_UPDATED_BY in NUMBER,
  X_LAST_UPDATE_LOGIN in NUMBER
) is
  cursor C is select ROWID from QPR_PN_REQUEST_HDRS_B
    where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID
    ;
begin
  insert into QPR_PN_REQUEST_HDRS_B (
    SOURCE_REF_HDR_LONG_DESC,
    --ORG_SHORT_DESC,
    --ORG_LONG_DESC,
    CUSTOMER_SHORT_DESC,
    CUSTOMER_LONG_DESC,
    --CONTRACT_SHORT_DESC,
    --CONTRACT_LONG_DESC,
    SALES_REP_SHORT_DESC,
    SALES_REP_LONG_DESC,
    SALES_CHANNEL_SHORT_DESC,
    SALES_CHANNEL_LONG_DESC,
    FREIGHT_TERMS_SHORT_DESC,
    FREIGHT_TERMS_LONG_DESC,
    PAYMENT_TERMS_SHORT_DESC,
    PAYMENT_TERMS_LONG_DESC,
    COMMENTS,
    MEASURE1_NUMBER,
    MEASURE2_NUMBER,
    MEASURE3_NUMBER,
    MEASURE4_NUMBER,
    MEASURE5_NUMBER,
    MEASURE6_NUMBER,
    MEASURE7_NUMBER,
    MEASURE8_NUMBER,
    MEASURE9_NUMBER,
    MEASURE10_NUMBER,
    MEASURE1_CHAR,
    MEASURE2_CHAR,
    MEASURE3_CHAR,
    MEASURE4_CHAR,
    MEASURE5_CHAR,
    MEASURE6_CHAR,
    MEASURE7_CHAR,
    MEASURE8_CHAR,
    MEASURE9_CHAR,
    MEASURE10_CHAR,
    --PROGRAM_LOGIN_ID,
    --REQUEST_ID,
    INSTANCE_ID,
    SIMULATION_FLAG,
    REQUEST_HEADER_ID,
    CUSTOMER_SK,
    SALES_CHANNEL_SK,
    SALES_REP_SK,
    PN_INT_HEADER_ID,
    SOURCE_ID,
    SOURCE_REF_HDR_ID,
    CUSTOMER_ID,
    --CONTRACT_ID,
    SALES_REP_ID,
    PAYMENT_TERMS_ID,
    INVOICE_TO_PARTY_SITE_ID,
    SALES_REP_EMAIL,
    SALES_CHANNEL_CODE,
    DEAL_EXPIRY_DATE,
    DEAL_CREATION_DATE,
    INVOICE_TO_PARTY_SITE_ADDRESS,
    --PRIORITY,
    CURRENCY_SHORT_DESC,
    CURRENCY_LONG_DESC,
    SOURCE_SHORT_DESC,
    SOURCE_LONG_DESC,
    SOURCE_REF_HDR_SHORT_DESC,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN
  ) values (
    X_SOURCE_REF_HDR_LONG_DESC,
    --X_ORG_SHORT_DESC,
    --X_ORG_LONG_DESC,
    X_CUSTOMER_SHORT_DESC,
    X_CUSTOMER_LONG_DESC,
    --X_CONTRACT_SHORT_DESC,
    --X_CONTRACT_LONG_DESC,
    X_SALES_REP_SHORT_DESC,
    X_SALES_REP_LONG_DESC,
    X_SALES_CHANNEL_SHORT_DESC,
    X_SALES_CHANNEL_LONG_DESC,
    X_FREIGHT_TERMS_SHORT_DESC,
    X_FREIGHT_TERMS_LONG_DESC,
    X_PAYMENT_TERMS_SHORT_DESC,
    X_PAYMENT_TERMS_LONG_DESC,
    X_COMMENTS,
    X_MEASURE1_NUMBER,
    X_MEASURE2_NUMBER,
    X_MEASURE3_NUMBER,
    X_MEASURE4_NUMBER,
    X_MEASURE5_NUMBER,
    X_MEASURE6_NUMBER,
    X_MEASURE7_NUMBER,
    X_MEASURE8_NUMBER,
    X_MEASURE9_NUMBER,
    X_MEASURE10_NUMBER,
    X_MEASURE1_CHAR,
    X_MEASURE2_CHAR,
    X_MEASURE3_CHAR,
    X_MEASURE4_CHAR,
    X_MEASURE5_CHAR,
    X_MEASURE6_CHAR,
    X_MEASURE7_CHAR,
    X_MEASURE8_CHAR,
    X_MEASURE9_CHAR,
    X_MEASURE10_CHAR,
    --X_PROGRAM_LOGIN_ID,
    --X_REQUEST_ID,
    X_INSTANCE_ID,
    X_SIMULATION_FLAG,
    X_REQUEST_HEADER_ID,
    X_CUSTOMER_SK,
    X_SALES_CHANNEL_SK,
    X_SALES_REP_SK,
    X_PN_INT_HEADER_ID,
    X_SOURCE_ID,
    X_SOURCE_REF_HDR_ID,
    X_CUSTOMER_ID,
    --X_CONTRACT_ID,
    X_SALES_REP_ID,
    X_PAYMENT_TERMS_ID,
    X_INVOICE_TO_PARTY_SITE_ID,
    X_SALES_REP_EMAIL,
    X_SALES_CHANNEL_CODE,
    X_DEAL_EXPIRY_DATE,
    X_DEAL_CREATION_DATE,
    X_INVOICE_TO_PARTY_SITE_ADDRES,
    --X_PRIORITY,
    X_CURRENCY_SHORT_DESC,
    X_CURRENCY_LONG_DESC,
    X_SOURCE_SHORT_DESC,
    X_SOURCE_LONG_DESC,
    X_SOURCE_REF_HDR_SHORT_DESC,
    X_CREATION_DATE,
    X_CREATED_BY,
    X_LAST_UPDATE_DATE,
    X_LAST_UPDATED_BY,
    X_LAST_UPDATE_LOGIN
  );

  insert into QPR_PN_REQUEST_HDRS_TL (
    REQUEST_HEADER_ID,
    REFERENCE_NAME,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN,
    --PROGRAM_ID,
    --PROGRAM_LOGIN_ID,
    --PROGRAM_APPLICATION_ID,
    --REQUEST_ID,
    LANGUAGE,
    SOURCE_LANG
  ) select
    X_REQUEST_HEADER_ID,
    X_REFERENCE_NAME,
    X_CREATION_DATE,
    X_CREATED_BY,
    X_LAST_UPDATE_DATE,
    X_LAST_UPDATED_BY,
    X_LAST_UPDATE_LOGIN,
    --X_PROGRAM_ID,
    --X_PROGRAM_LOGIN_ID,
    --X_PROGRAM_APPLICATION_ID,
    --X_REQUEST_ID,
    L.LANGUAGE_CODE,
    userenv('LANG')
  from FND_LANGUAGES L
  where L.INSTALLED_FLAG in ('I', 'B')
  and not exists
    (select NULL
    from QPR_PN_REQUEST_HDRS_TL T
    where T.REQUEST_HEADER_ID = X_REQUEST_HEADER_ID
    and T.LANGUAGE = L.LANGUAGE_CODE);

  open c;
  fetch c into X_ROWID;
  if (c%notfound) then
    close c;
    raise no_data_found;
  end if;
  close c;

end INSERT_ROW;

procedure LOCK_ROW (
  X_REQUEST_HEADER_ID in NUMBER,
  X_SOURCE_REF_HDR_LONG_DESC in VARCHAR2,
--  X_ORG_SHORT_DESC in VARCHAR2,
--  X_ORG_LONG_DESC in VARCHAR2,
  X_CUSTOMER_SHORT_DESC in VARCHAR2,
  X_CUSTOMER_LONG_DESC in VARCHAR2,
  --X_CONTRACT_SHORT_DESC in VARCHAR2,
  --X_CONTRACT_LONG_DESC in VARCHAR2,
  X_SALES_REP_SHORT_DESC in VARCHAR2,
  X_SALES_REP_LONG_DESC in VARCHAR2,
  X_SALES_CHANNEL_SHORT_DESC in VARCHAR2,
  X_SALES_CHANNEL_LONG_DESC in VARCHAR2,
  X_FREIGHT_TERMS_SHORT_DESC in VARCHAR2,
  X_FREIGHT_TERMS_LONG_DESC in VARCHAR2,
  X_PAYMENT_TERMS_SHORT_DESC in VARCHAR2,
  X_PAYMENT_TERMS_LONG_DESC in VARCHAR2,
  X_COMMENTS in VARCHAR2,
  X_MEASURE1_NUMBER in NUMBER,
  X_MEASURE2_NUMBER in NUMBER,
  X_MEASURE3_NUMBER in NUMBER,
  X_MEASURE4_NUMBER in NUMBER,
  X_MEASURE5_NUMBER in NUMBER,
  X_MEASURE6_NUMBER in NUMBER,
  X_MEASURE7_NUMBER in NUMBER,
  X_MEASURE8_NUMBER in NUMBER,
  X_MEASURE9_NUMBER in NUMBER,
  X_MEASURE10_NUMBER in NUMBER,
  X_MEASURE1_CHAR in VARCHAR2,
  X_MEASURE2_CHAR in VARCHAR2,
  X_MEASURE3_CHAR in VARCHAR2,
  X_MEASURE4_CHAR in VARCHAR2,
  X_MEASURE5_CHAR in VARCHAR2,
  X_MEASURE6_CHAR in VARCHAR2,
  X_MEASURE7_CHAR in VARCHAR2,
  X_MEASURE8_CHAR in VARCHAR2,
  X_MEASURE9_CHAR in VARCHAR2,
  X_MEASURE10_CHAR in VARCHAR2,
--  X_PROGRAM_LOGIN_ID in NUMBER,
--  X_REQUEST_ID in NUMBER,
  X_INSTANCE_ID in NUMBER,
  X_SIMULATION_FLAG in VARCHAR2,
  X_CUSTOMER_SK in VARCHAR2,
  X_SALES_CHANNEL_SK in VARCHAR2,
  X_SALES_REP_SK in VARCHAR2,
  X_PN_INT_HEADER_ID in NUMBER,
  X_SOURCE_ID in NUMBER,
  X_SOURCE_REF_HDR_ID in NUMBER,
  X_CUSTOMER_ID in NUMBER,
  --X_CONTRACT_ID in NUMBER,
  X_SALES_REP_ID in NUMBER,
  X_PAYMENT_TERMS_ID in NUMBER,
  X_INVOICE_TO_PARTY_SITE_ID in NUMBER,
  X_SALES_REP_EMAIL in VARCHAR2,
  X_SALES_CHANNEL_CODE in VARCHAR2,
  X_DEAL_EXPIRY_DATE in DATE,
  X_DEAL_CREATION_DATE in DATE,
  X_INVOICE_TO_PARTY_SITE_ADDRES in VARCHAR2,
  --X_PRIORITY in VARCHAR2,
  X_CURRENCY_SHORT_DESC in VARCHAR2,
  X_CURRENCY_LONG_DESC in VARCHAR2,
  X_SOURCE_SHORT_DESC in VARCHAR2,
  X_SOURCE_LONG_DESC in VARCHAR2,
  X_SOURCE_REF_HDR_SHORT_DESC in VARCHAR2,
  X_REFERENCE_NAME in VARCHAR2
) is
  cursor c is select
      SOURCE_REF_HDR_LONG_DESC,
      --ORG_SHORT_DESC,
      --ORG_LONG_DESC,
      CUSTOMER_SHORT_DESC,
      CUSTOMER_LONG_DESC,
      --CONTRACT_SHORT_DESC,
      --CONTRACT_LONG_DESC,
      SALES_REP_SHORT_DESC,
      SALES_REP_LONG_DESC,
      SALES_CHANNEL_SHORT_DESC,
      SALES_CHANNEL_LONG_DESC,
      FREIGHT_TERMS_SHORT_DESC,
      FREIGHT_TERMS_LONG_DESC,
      PAYMENT_TERMS_SHORT_DESC,
      PAYMENT_TERMS_LONG_DESC,
      COMMENTS,
      MEASURE1_NUMBER,
      MEASURE2_NUMBER,
      MEASURE3_NUMBER,
      MEASURE4_NUMBER,
      MEASURE5_NUMBER,
      MEASURE6_NUMBER,
      MEASURE7_NUMBER,
      MEASURE8_NUMBER,
      MEASURE9_NUMBER,
      MEASURE10_NUMBER,
      MEASURE1_CHAR,
      MEASURE2_CHAR,
      MEASURE3_CHAR,
      MEASURE4_CHAR,
      MEASURE5_CHAR,
      MEASURE6_CHAR,
      MEASURE7_CHAR,
      MEASURE8_CHAR,
      MEASURE9_CHAR,
      MEASURE10_CHAR,
      --PROGRAM_LOGIN_ID,
      --REQUEST_ID,
      INSTANCE_ID,
      SIMULATION_FLAG,
      CUSTOMER_SK,
      SALES_CHANNEL_SK,
      SALES_REP_SK,
      PN_INT_HEADER_ID,
      SOURCE_ID,
      SOURCE_REF_HDR_ID,
      CUSTOMER_ID,
      --CONTRACT_ID,
      SALES_REP_ID,
      PAYMENT_TERMS_ID,
      INVOICE_TO_PARTY_SITE_ID,
      SALES_REP_EMAIL,
      SALES_CHANNEL_CODE,
      DEAL_EXPIRY_DATE,
      DEAL_CREATION_DATE,
      INVOICE_TO_PARTY_SITE_ADDRESS,
      --PRIORITY,
      CURRENCY_SHORT_DESC,
      CURRENCY_LONG_DESC,
      SOURCE_SHORT_DESC,
      SOURCE_LONG_DESC,
      SOURCE_REF_HDR_SHORT_DESC
    from QPR_PN_REQUEST_HDRS_B
    where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID
    for update of REQUEST_HEADER_ID nowait;
  recinfo c%rowtype;

  cursor c1 is select
      REFERENCE_NAME,
      decode(LANGUAGE, userenv('LANG'), 'Y', 'N') BASELANG
    from QPR_PN_REQUEST_HDRS_TL
    where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID
    and userenv('LANG') in (LANGUAGE, SOURCE_LANG)
    for update of REQUEST_HEADER_ID nowait;
begin
  open c;
  fetch c into recinfo;
  if (sql%notfound) then
    close c;
    fnd_message.set_name('FND', 'FORM_RECORD_DELETED');
    app_exception.raise_exception;
  end if;
  close c;
  if (    ((recinfo.SOURCE_REF_HDR_LONG_DESC = X_SOURCE_REF_HDR_LONG_DESC)
           OR ((recinfo.SOURCE_REF_HDR_LONG_DESC is null) AND (X_SOURCE_REF_HDR_LONG_DESC is null)))
--      AND ((recinfo.ORG_SHORT_DESC = X_ORG_SHORT_DESC)
--           OR ((recinfo.ORG_SHORT_DESC is null) AND (X_ORG_SHORT_DESC is null)))
--      AND ((recinfo.ORG_LONG_DESC = X_ORG_LONG_DESC)
--           OR ((recinfo.ORG_LONG_DESC is null) AND (X_ORG_LONG_DESC is null)))
      AND ((recinfo.CUSTOMER_SHORT_DESC = X_CUSTOMER_SHORT_DESC)
           OR ((recinfo.CUSTOMER_SHORT_DESC is null) AND (X_CUSTOMER_SHORT_DESC is null)))
      AND ((recinfo.CUSTOMER_LONG_DESC = X_CUSTOMER_LONG_DESC)
           OR ((recinfo.CUSTOMER_LONG_DESC is null) AND (X_CUSTOMER_LONG_DESC is null)))
--      AND ((recinfo.CONTRACT_SHORT_DESC = X_CONTRACT_SHORT_DESC)
--           OR ((recinfo.CONTRACT_SHORT_DESC is null) AND (X_CONTRACT_SHORT_DESC is null)))
--      AND ((recinfo.CONTRACT_LONG_DESC = X_CONTRACT_LONG_DESC)
--           OR ((recinfo.CONTRACT_LONG_DESC is null) AND (X_CONTRACT_LONG_DESC is null)))
      AND ((recinfo.SALES_REP_SHORT_DESC = X_SALES_REP_SHORT_DESC)
           OR ((recinfo.SALES_REP_SHORT_DESC is null) AND (X_SALES_REP_SHORT_DESC is null)))
      AND ((recinfo.SALES_REP_LONG_DESC = X_SALES_REP_LONG_DESC)
           OR ((recinfo.SALES_REP_LONG_DESC is null) AND (X_SALES_REP_LONG_DESC is null)))
      AND ((recinfo.SALES_CHANNEL_SHORT_DESC = X_SALES_CHANNEL_SHORT_DESC)
           OR ((recinfo.SALES_CHANNEL_SHORT_DESC is null) AND (X_SALES_CHANNEL_SHORT_DESC is null)))
      AND ((recinfo.SALES_CHANNEL_LONG_DESC = X_SALES_CHANNEL_LONG_DESC)
           OR ((recinfo.SALES_CHANNEL_LONG_DESC is null) AND (X_SALES_CHANNEL_LONG_DESC is null)))
      AND ((recinfo.FREIGHT_TERMS_SHORT_DESC = X_FREIGHT_TERMS_SHORT_DESC)
           OR ((recinfo.FREIGHT_TERMS_SHORT_DESC is null) AND (X_FREIGHT_TERMS_SHORT_DESC is null)))
      AND ((recinfo.FREIGHT_TERMS_LONG_DESC = X_FREIGHT_TERMS_LONG_DESC)
           OR ((recinfo.FREIGHT_TERMS_LONG_DESC is null) AND (X_FREIGHT_TERMS_LONG_DESC is null)))
      AND ((recinfo.PAYMENT_TERMS_SHORT_DESC = X_PAYMENT_TERMS_SHORT_DESC)
           OR ((recinfo.PAYMENT_TERMS_SHORT_DESC is null) AND (X_PAYMENT_TERMS_SHORT_DESC is null)))
      AND ((recinfo.PAYMENT_TERMS_LONG_DESC = X_PAYMENT_TERMS_LONG_DESC)
           OR ((recinfo.PAYMENT_TERMS_LONG_DESC is null) AND (X_PAYMENT_TERMS_LONG_DESC is null)))
      AND ((recinfo.COMMENTS = X_COMMENTS)
           OR ((recinfo.COMMENTS is null) AND (X_COMMENTS is null)))
      AND ((recinfo.MEASURE1_NUMBER = X_MEASURE1_NUMBER)
           OR ((recinfo.MEASURE1_NUMBER is null) AND (X_MEASURE1_NUMBER is null)))
      AND ((recinfo.MEASURE2_NUMBER = X_MEASURE2_NUMBER)
           OR ((recinfo.MEASURE2_NUMBER is null) AND (X_MEASURE2_NUMBER is null)))
      AND ((recinfo.MEASURE3_NUMBER = X_MEASURE3_NUMBER)
           OR ((recinfo.MEASURE3_NUMBER is null) AND (X_MEASURE3_NUMBER is null)))
      AND ((recinfo.MEASURE4_NUMBER = X_MEASURE4_NUMBER)
           OR ((recinfo.MEASURE4_NUMBER is null) AND (X_MEASURE4_NUMBER is null)))
      AND ((recinfo.MEASURE5_NUMBER = X_MEASURE5_NUMBER)
           OR ((recinfo.MEASURE5_NUMBER is null) AND (X_MEASURE5_NUMBER is null)))
      AND ((recinfo.MEASURE6_NUMBER = X_MEASURE6_NUMBER)
           OR ((recinfo.MEASURE6_NUMBER is null) AND (X_MEASURE6_NUMBER is null)))
      AND ((recinfo.MEASURE7_NUMBER = X_MEASURE7_NUMBER)
           OR ((recinfo.MEASURE7_NUMBER is null) AND (X_MEASURE7_NUMBER is null)))
      AND ((recinfo.MEASURE8_NUMBER = X_MEASURE8_NUMBER)
           OR ((recinfo.MEASURE8_NUMBER is null) AND (X_MEASURE8_NUMBER is null)))
      AND ((recinfo.MEASURE9_NUMBER = X_MEASURE9_NUMBER)
           OR ((recinfo.MEASURE9_NUMBER is null) AND (X_MEASURE9_NUMBER is null)))
      AND ((recinfo.MEASURE10_NUMBER = X_MEASURE10_NUMBER)
           OR ((recinfo.MEASURE10_NUMBER is null) AND (X_MEASURE10_NUMBER is null)))
      AND ((recinfo.MEASURE1_CHAR = X_MEASURE1_CHAR)
           OR ((recinfo.MEASURE1_CHAR is null) AND (X_MEASURE1_CHAR is null)))
      AND ((recinfo.MEASURE2_CHAR = X_MEASURE2_CHAR)
           OR ((recinfo.MEASURE2_CHAR is null) AND (X_MEASURE2_CHAR is null)))
      AND ((recinfo.MEASURE3_CHAR = X_MEASURE3_CHAR)
           OR ((recinfo.MEASURE3_CHAR is null) AND (X_MEASURE3_CHAR is null)))
      AND ((recinfo.MEASURE4_CHAR = X_MEASURE4_CHAR)
           OR ((recinfo.MEASURE4_CHAR is null) AND (X_MEASURE4_CHAR is null)))
      AND ((recinfo.MEASURE5_CHAR = X_MEASURE5_CHAR)
           OR ((recinfo.MEASURE5_CHAR is null) AND (X_MEASURE5_CHAR is null)))
      AND ((recinfo.MEASURE6_CHAR = X_MEASURE6_CHAR)
           OR ((recinfo.MEASURE6_CHAR is null) AND (X_MEASURE6_CHAR is null)))
      AND ((recinfo.MEASURE7_CHAR = X_MEASURE7_CHAR)
           OR ((recinfo.MEASURE7_CHAR is null) AND (X_MEASURE7_CHAR is null)))
      AND ((recinfo.MEASURE8_CHAR = X_MEASURE8_CHAR)
           OR ((recinfo.MEASURE8_CHAR is null) AND (X_MEASURE8_CHAR is null)))
      AND ((recinfo.MEASURE9_CHAR = X_MEASURE9_CHAR)
           OR ((recinfo.MEASURE9_CHAR is null) AND (X_MEASURE9_CHAR is null)))
      AND ((recinfo.MEASURE10_CHAR = X_MEASURE10_CHAR)
           OR ((recinfo.MEASURE10_CHAR is null) AND (X_MEASURE10_CHAR is null)))
--      AND ((recinfo.PROGRAM_LOGIN_ID = X_PROGRAM_LOGIN_ID)
--           OR ((recinfo.PROGRAM_LOGIN_ID is null) AND (X_PROGRAM_LOGIN_ID is null)))
--      AND ((recinfo.REQUEST_ID = X_REQUEST_ID)
--           OR ((recinfo.REQUEST_ID is null) AND (X_REQUEST_ID is null)))
      AND ((recinfo.INSTANCE_ID = X_INSTANCE_ID)
           OR ((recinfo.INSTANCE_ID is null) AND (X_INSTANCE_ID is null)))
      AND ((recinfo.SIMULATION_FLAG = X_SIMULATION_FLAG)
           OR ((recinfo.SIMULATION_FLAG is null) AND (X_SIMULATION_FLAG is null)))
      AND ((recinfo.CUSTOMER_SK = X_CUSTOMER_SK)
           OR ((recinfo.CUSTOMER_SK is null) AND (X_CUSTOMER_SK is null)))
      AND ((recinfo.SALES_CHANNEL_SK = X_SALES_CHANNEL_SK)
           OR ((recinfo.SALES_CHANNEL_SK is null) AND (X_SALES_CHANNEL_SK is null)))
      AND ((recinfo.SALES_REP_SK = X_SALES_REP_SK)
           OR ((recinfo.SALES_REP_SK is null) AND (X_SALES_REP_SK is null)))
      AND ((recinfo.PN_INT_HEADER_ID = X_PN_INT_HEADER_ID)
           OR ((recinfo.PN_INT_HEADER_ID is null) AND (X_PN_INT_HEADER_ID is null)))
      AND ((recinfo.SOURCE_ID = X_SOURCE_ID)
           OR ((recinfo.SOURCE_ID is null) AND (X_SOURCE_ID is null)))
      AND (recinfo.SOURCE_REF_HDR_ID = X_SOURCE_REF_HDR_ID)
      AND (recinfo.CUSTOMER_ID = X_CUSTOMER_ID)
--      AND ((recinfo.CONTRACT_ID = X_CONTRACT_ID)
--           OR ((recinfo.CONTRACT_ID is null) AND (X_CONTRACT_ID is null)))
      AND ((recinfo.SALES_REP_ID = X_SALES_REP_ID)
           OR ((recinfo.SALES_REP_ID is null) AND (X_SALES_REP_ID is null)))
      AND ((recinfo.PAYMENT_TERMS_ID = X_PAYMENT_TERMS_ID)
           OR ((recinfo.PAYMENT_TERMS_ID is null) AND (X_PAYMENT_TERMS_ID is null)))
      AND ((recinfo.INVOICE_TO_PARTY_SITE_ID = X_INVOICE_TO_PARTY_SITE_ID)
           OR ((recinfo.INVOICE_TO_PARTY_SITE_ID is null) AND (X_INVOICE_TO_PARTY_SITE_ID is null)))
      AND ((recinfo.SALES_REP_EMAIL = X_SALES_REP_EMAIL)
           OR ((recinfo.SALES_REP_EMAIL is null) AND (X_SALES_REP_EMAIL is null)))
      AND ((recinfo.SALES_CHANNEL_CODE = X_SALES_CHANNEL_CODE)
           OR ((recinfo.SALES_CHANNEL_CODE is null) AND (X_SALES_CHANNEL_CODE is null)))
      AND ((recinfo.DEAL_EXPIRY_DATE = X_DEAL_EXPIRY_DATE)
           OR ((recinfo.DEAL_EXPIRY_DATE is null) AND (X_DEAL_EXPIRY_DATE is null)))
      AND ((recinfo.DEAL_CREATION_DATE = X_DEAL_CREATION_DATE)
           OR ((recinfo.DEAL_CREATION_DATE is null) AND (X_DEAL_CREATION_DATE is null)))
      AND ((recinfo.INVOICE_TO_PARTY_SITE_ADDRESS = X_INVOICE_TO_PARTY_SITE_ADDRES)
           OR ((recinfo.INVOICE_TO_PARTY_SITE_ADDRESS is null) AND (X_INVOICE_TO_PARTY_SITE_ADDRES is null)))
--      AND ((recinfo.PRIORITY = X_PRIORITY)
--           OR ((recinfo.PRIORITY is null) AND (X_PRIORITY is null)))
      AND ((recinfo.CURRENCY_SHORT_DESC = X_CURRENCY_SHORT_DESC)
           OR ((recinfo.CURRENCY_SHORT_DESC is null) AND (X_CURRENCY_SHORT_DESC is null)))
      AND ((recinfo.CURRENCY_LONG_DESC = X_CURRENCY_LONG_DESC)
           OR ((recinfo.CURRENCY_LONG_DESC is null) AND (X_CURRENCY_LONG_DESC is null)))
      AND ((recinfo.SOURCE_SHORT_DESC = X_SOURCE_SHORT_DESC)
           OR ((recinfo.SOURCE_SHORT_DESC is null) AND (X_SOURCE_SHORT_DESC is null)))
      AND ((recinfo.SOURCE_LONG_DESC = X_SOURCE_LONG_DESC)
           OR ((recinfo.SOURCE_LONG_DESC is null) AND (X_SOURCE_LONG_DESC is null)))
      AND ((recinfo.SOURCE_REF_HDR_SHORT_DESC = X_SOURCE_REF_HDR_SHORT_DESC)
           OR ((recinfo.SOURCE_REF_HDR_SHORT_DESC is null) AND (X_SOURCE_REF_HDR_SHORT_DESC is null)))
  ) then
    null;
  else
    fnd_message.set_name('FND', 'FORM_RECORD_CHANGED');
    app_exception.raise_exception;
  end if;

  for tlinfo in c1 loop
    if (tlinfo.BASELANG = 'Y') then
      if (    (tlinfo.REFERENCE_NAME = X_REFERENCE_NAME)
      ) then
        null;
      else
        fnd_message.set_name('FND', 'FORM_RECORD_CHANGED');
        app_exception.raise_exception;
      end if;
    end if;
  end loop;
  return;
end LOCK_ROW;

procedure UPDATE_ROW (
  X_REQUEST_HEADER_ID in NUMBER,
  X_SOURCE_REF_HDR_LONG_DESC in VARCHAR2,
--  X_ORG_SHORT_DESC in VARCHAR2,
--  X_ORG_LONG_DESC in VARCHAR2,
  X_CUSTOMER_SHORT_DESC in VARCHAR2,
  X_CUSTOMER_LONG_DESC in VARCHAR2,
  --X_CONTRACT_SHORT_DESC in VARCHAR2,
  --X_CONTRACT_LONG_DESC in VARCHAR2,
  X_SALES_REP_SHORT_DESC in VARCHAR2,
  X_SALES_REP_LONG_DESC in VARCHAR2,
  X_SALES_CHANNEL_SHORT_DESC in VARCHAR2,
  X_SALES_CHANNEL_LONG_DESC in VARCHAR2,
  X_FREIGHT_TERMS_SHORT_DESC in VARCHAR2,
  X_FREIGHT_TERMS_LONG_DESC in VARCHAR2,
  X_PAYMENT_TERMS_SHORT_DESC in VARCHAR2,
  X_PAYMENT_TERMS_LONG_DESC in VARCHAR2,
  X_COMMENTS in VARCHAR2,
  X_MEASURE1_NUMBER in NUMBER,
  X_MEASURE2_NUMBER in NUMBER,
  X_MEASURE3_NUMBER in NUMBER,
  X_MEASURE4_NUMBER in NUMBER,
  X_MEASURE5_NUMBER in NUMBER,
  X_MEASURE6_NUMBER in NUMBER,
  X_MEASURE7_NUMBER in NUMBER,
  X_MEASURE8_NUMBER in NUMBER,
  X_MEASURE9_NUMBER in NUMBER,
  X_MEASURE10_NUMBER in NUMBER,
  X_MEASURE1_CHAR in VARCHAR2,
  X_MEASURE2_CHAR in VARCHAR2,
  X_MEASURE3_CHAR in VARCHAR2,
  X_MEASURE4_CHAR in VARCHAR2,
  X_MEASURE5_CHAR in VARCHAR2,
  X_MEASURE6_CHAR in VARCHAR2,
  X_MEASURE7_CHAR in VARCHAR2,
  X_MEASURE8_CHAR in VARCHAR2,
  X_MEASURE9_CHAR in VARCHAR2,
  X_MEASURE10_CHAR in VARCHAR2,
--  X_PROGRAM_LOGIN_ID in NUMBER,
--  X_REQUEST_ID in NUMBER,
  X_INSTANCE_ID in NUMBER,
  X_SIMULATION_FLAG in VARCHAR2,
  X_CUSTOMER_SK in VARCHAR2,
  X_SALES_CHANNEL_SK in VARCHAR2,
  X_SALES_REP_SK in VARCHAR2,
  X_PN_INT_HEADER_ID in NUMBER,
  X_SOURCE_ID in NUMBER,
  X_SOURCE_REF_HDR_ID in NUMBER,
  X_CUSTOMER_ID in NUMBER,
  --X_CONTRACT_ID in NUMBER,
  X_SALES_REP_ID in NUMBER,
  X_PAYMENT_TERMS_ID in NUMBER,
  X_INVOICE_TO_PARTY_SITE_ID in NUMBER,
  X_SALES_REP_EMAIL in VARCHAR2,
  X_SALES_CHANNEL_CODE in VARCHAR2,
  X_DEAL_EXPIRY_DATE in DATE,
  X_DEAL_CREATION_DATE in DATE,
  X_INVOICE_TO_PARTY_SITE_ADDRES in VARCHAR2,
  --X_PRIORITY in VARCHAR2,
  X_CURRENCY_SHORT_DESC in VARCHAR2,
  X_CURRENCY_LONG_DESC in VARCHAR2,
  X_SOURCE_SHORT_DESC in VARCHAR2,
  X_SOURCE_LONG_DESC in VARCHAR2,
  X_SOURCE_REF_HDR_SHORT_DESC in VARCHAR2,
  X_REFERENCE_NAME in VARCHAR2,
  X_LAST_UPDATE_DATE in DATE,
  X_LAST_UPDATED_BY in NUMBER,
  X_LAST_UPDATE_LOGIN in NUMBER
) is
begin
  update QPR_PN_REQUEST_HDRS_B set
    SOURCE_REF_HDR_LONG_DESC = X_SOURCE_REF_HDR_LONG_DESC,
    --ORG_SHORT_DESC = X_ORG_SHORT_DESC,
    --ORG_LONG_DESC = X_ORG_LONG_DESC,
    CUSTOMER_SHORT_DESC = X_CUSTOMER_SHORT_DESC,
    CUSTOMER_LONG_DESC = X_CUSTOMER_LONG_DESC,
    --CONTRACT_SHORT_DESC = X_CONTRACT_SHORT_DESC,
    --CONTRACT_LONG_DESC = X_CONTRACT_LONG_DESC,
    SALES_REP_SHORT_DESC = X_SALES_REP_SHORT_DESC,
    SALES_REP_LONG_DESC = X_SALES_REP_LONG_DESC,
    SALES_CHANNEL_SHORT_DESC = X_SALES_CHANNEL_SHORT_DESC,
    SALES_CHANNEL_LONG_DESC = X_SALES_CHANNEL_LONG_DESC,
    FREIGHT_TERMS_SHORT_DESC = X_FREIGHT_TERMS_SHORT_DESC,
    FREIGHT_TERMS_LONG_DESC = X_FREIGHT_TERMS_LONG_DESC,
    PAYMENT_TERMS_SHORT_DESC = X_PAYMENT_TERMS_SHORT_DESC,
    PAYMENT_TERMS_LONG_DESC = X_PAYMENT_TERMS_LONG_DESC,
    COMMENTS = X_COMMENTS,
    MEASURE1_NUMBER = X_MEASURE1_NUMBER,
    MEASURE2_NUMBER = X_MEASURE2_NUMBER,
    MEASURE3_NUMBER = X_MEASURE3_NUMBER,
    MEASURE4_NUMBER = X_MEASURE4_NUMBER,
    MEASURE5_NUMBER = X_MEASURE5_NUMBER,
    MEASURE6_NUMBER = X_MEASURE6_NUMBER,
    MEASURE7_NUMBER = X_MEASURE7_NUMBER,
    MEASURE8_NUMBER = X_MEASURE8_NUMBER,
    MEASURE9_NUMBER = X_MEASURE9_NUMBER,
    MEASURE10_NUMBER = X_MEASURE10_NUMBER,
    MEASURE1_CHAR = X_MEASURE1_CHAR,
    MEASURE2_CHAR = X_MEASURE2_CHAR,
    MEASURE3_CHAR = X_MEASURE3_CHAR,
    MEASURE4_CHAR = X_MEASURE4_CHAR,
    MEASURE5_CHAR = X_MEASURE5_CHAR,
    MEASURE6_CHAR = X_MEASURE6_CHAR,
    MEASURE7_CHAR = X_MEASURE7_CHAR,
    MEASURE8_CHAR = X_MEASURE8_CHAR,
    MEASURE9_CHAR = X_MEASURE9_CHAR,
    MEASURE10_CHAR = X_MEASURE10_CHAR,
    --PROGRAM_LOGIN_ID = X_PROGRAM_LOGIN_ID,
    --REQUEST_ID = X_REQUEST_ID,
    INSTANCE_ID = X_INSTANCE_ID,
    SIMULATION_FLAG = X_SIMULATION_FLAG,
    CUSTOMER_SK = X_CUSTOMER_SK,
    SALES_CHANNEL_SK = X_SALES_CHANNEL_SK,
    SALES_REP_SK = X_SALES_REP_SK,
    PN_INT_HEADER_ID = X_PN_INT_HEADER_ID,
    SOURCE_ID = X_SOURCE_ID,
    SOURCE_REF_HDR_ID = X_SOURCE_REF_HDR_ID,
    CUSTOMER_ID = X_CUSTOMER_ID,
    --CONTRACT_ID = X_CONTRACT_ID,
    SALES_REP_ID = X_SALES_REP_ID,
    PAYMENT_TERMS_ID = X_PAYMENT_TERMS_ID,
    INVOICE_TO_PARTY_SITE_ID = X_INVOICE_TO_PARTY_SITE_ID,
    SALES_REP_EMAIL = X_SALES_REP_EMAIL,
    SALES_CHANNEL_CODE = X_SALES_CHANNEL_CODE,
    DEAL_EXPIRY_DATE = X_DEAL_EXPIRY_DATE,
    DEAL_CREATION_DATE = X_DEAL_CREATION_DATE,
    INVOICE_TO_PARTY_SITE_ADDRESS = X_INVOICE_TO_PARTY_SITE_ADDRES,
    --PRIORITY = X_PRIORITY,
    CURRENCY_SHORT_DESC = X_CURRENCY_SHORT_DESC,
    CURRENCY_LONG_DESC = X_CURRENCY_LONG_DESC,
    SOURCE_SHORT_DESC = X_SOURCE_SHORT_DESC,
    SOURCE_LONG_DESC = X_SOURCE_LONG_DESC,
    SOURCE_REF_HDR_SHORT_DESC = X_SOURCE_REF_HDR_SHORT_DESC,
    LAST_UPDATE_DATE = X_LAST_UPDATE_DATE,
    LAST_UPDATED_BY = X_LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN = X_LAST_UPDATE_LOGIN
  where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID;

  if (sql%notfound) then
    raise no_data_found;
  end if;

  update QPR_PN_REQUEST_HDRS_TL set
    REFERENCE_NAME = X_REFERENCE_NAME,
    LAST_UPDATE_DATE = X_LAST_UPDATE_DATE,
    LAST_UPDATED_BY = X_LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN = X_LAST_UPDATE_LOGIN,
    SOURCE_LANG = userenv('LANG')
  where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID
  and userenv('LANG') in (LANGUAGE, SOURCE_LANG);

  if (sql%notfound) then
    raise no_data_found;
  end if;
end UPDATE_ROW;

procedure DELETE_ROW (
  X_REQUEST_HEADER_ID in NUMBER
) is
begin
  delete from QPR_PN_REQUEST_HDRS_TL
  where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID;

  if (sql%notfound) then
    raise no_data_found;
  end if;

  delete from QPR_PN_REQUEST_HDRS_B
  where REQUEST_HEADER_ID = X_REQUEST_HEADER_ID;

  if (sql%notfound) then
    raise no_data_found;
  end if;
end DELETE_ROW;

procedure ADD_LANGUAGE
is
begin
  delete from QPR_PN_REQUEST_HDRS_TL T
  where not exists
    (select NULL
    from QPR_PN_REQUEST_HDRS_B B
    where B.REQUEST_HEADER_ID = T.REQUEST_HEADER_ID
    );

  update QPR_PN_REQUEST_HDRS_TL T set (
      REFERENCE_NAME
    ) = (select
      B.REFERENCE_NAME
    from QPR_PN_REQUEST_HDRS_TL B
    where B.REQUEST_HEADER_ID = T.REQUEST_HEADER_ID
    and B.LANGUAGE = T.SOURCE_LANG)
  where (
      T.REQUEST_HEADER_ID,
      T.LANGUAGE
  ) in (select
      SUBT.REQUEST_HEADER_ID,
      SUBT.LANGUAGE
    from QPR_PN_REQUEST_HDRS_TL SUBB, QPR_PN_REQUEST_HDRS_TL SUBT
    where SUBB.REQUEST_HEADER_ID = SUBT.REQUEST_HEADER_ID
    and SUBB.LANGUAGE = SUBT.SOURCE_LANG
    and (SUBB.REFERENCE_NAME <> SUBT.REFERENCE_NAME
  ));

  insert into QPR_PN_REQUEST_HDRS_TL (
    REQUEST_HEADER_ID,
    REFERENCE_NAME,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN,
    --PROGRAM_ID,
    --PROGRAM_LOGIN_ID,
    --PROGRAM_APPLICATION_ID,
    --REQUEST_ID,
    LANGUAGE,
    SOURCE_LANG
  ) select /*+ ORDERED */
    B.REQUEST_HEADER_ID,
    B.REFERENCE_NAME,
    B.CREATION_DATE,
    B.CREATED_BY,
    B.LAST_UPDATE_DATE,
    B.LAST_UPDATED_BY,
    B.LAST_UPDATE_LOGIN,
    --B.PROGRAM_ID,
    --B.PROGRAM_LOGIN_ID,
    --B.PROGRAM_APPLICATION_ID,
    --B.REQUEST_ID,
    L.LANGUAGE_CODE,
    B.SOURCE_LANG
  from QPR_PN_REQUEST_HDRS_TL B, FND_LANGUAGES L
  where L.INSTALLED_FLAG in ('I', 'B')
  and B.LANGUAGE = userenv('LANG')
  and not exists
    (select NULL
    from QPR_PN_REQUEST_HDRS_TL T
    where T.REQUEST_HEADER_ID = B.REQUEST_HEADER_ID
    and T.LANGUAGE = L.LANGUAGE_CODE);
end ADD_LANGUAGE;

end QPR_PN_REQUEST_HDRS_PKG;

/
