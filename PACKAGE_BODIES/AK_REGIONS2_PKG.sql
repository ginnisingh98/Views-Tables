--------------------------------------------------------
--  DDL for Package Body AK_REGIONS2_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."AK_REGIONS2_PKG" as
/* $Header: AKDRGN2B.pls 120.1 2005/07/02 04:57:55 appldev ship $ */

PROCEDURE copy_records
(	p_o_code	in varchar2,
p_o_id		in number,
p_n_code	in varchar2,
p_n_id		in number) IS

-- Various REGION record type
r_rec		ak_regions%rowtype;

-- REGION cursors
cursor r_csr (p_csr_code IN VARCHAR2, p_csr_id IN NUMBER) is
select	*
from	ak_regions
where	region_code = p_csr_code
and	region_application_id = p_csr_id;
cursor rt_csr (p_csr_code IN VARCHAR2, p_csr_id IN NUMBER) is
select	*
from	ak_regions_tl
where	region_code = p_csr_code
and	region_application_id = p_csr_id;
cursor ri_csr (p_csr_code IN VARCHAR2, p_csr_id IN NUMBER) is
select	*
from	ak_region_items
where	region_code = p_csr_code
and	region_application_id = p_csr_id;
cursor rit_csr (p_csr_code IN VARCHAR2, p_csr_id IN NUMBER) is
select	*
from	ak_region_items_tl
where	region_code = p_csr_code
and	region_application_id = p_csr_id;
cursor rlr_csr (p_csr_code IN VARCHAR2, p_csr_id IN NUMBER) is
select  *
from    ak_region_lov_relations
where   region_code = p_csr_code
and     region_application_id = p_csr_id;

-- Misc variables to be used
b_success	boolean;
BEGIN
open r_csr( p_o_code, p_o_id);
FETCH r_csr INTO r_rec;
b_success := r_csr%found;
close r_csr;
-- ak_regions is a parent table. If you can't find a record, exit with an error message.
if (not b_success) then
fnd_message.set_name('AK', 'AK_NEW_REGION_ALREADY_EXISTS');
app_exception.raise_exception;
end if;
-- Put new code and id into record and insert into appropriate table
r_rec.region_code		:= p_n_code;
r_rec.region_application_id	:= p_n_id;

insert into ak_regions (
REGION_APPLICATION_ID,
REGION_CODE,
DATABASE_OBJECT_NAME,
REGION_STYLE,
NUM_COLUMNS,
ICX_CUSTOM_CALL,
REGION_DEFAULTING_API_PKG,
REGION_DEFAULTING_API_PROC,
REGION_VALIDATION_API_PKG,
REGION_VALIDATION_API_PROC,
APPLICATIONMODULE_OBJECT_TYPE,
NUM_ROWS_DISPLAY,
REGION_OBJECT_TYPE,
IMAGE_FILE_NAME,
ISFORM_FLAG,
HELP_TARGET,
STYLE_SHEET_FILENAME,
VERSION,
APPLICATIONMODULE_USAGE_NAME,
ADD_INDEXED_CHILDREN,
STATEFUL_FLAG,
FUNCTION_NAME,
CHILDREN_VIEW_USAGE_NAME,
SEARCH_PANEL,
ADVANCED_SEARCH_PANEL,
CUSTOMIZE_PANEL,
DEFAULT_SEARCH_PANEL,
RESULTS_BASED_SEARCH,
DISPLAY_GRAPH_TABLE,
DISABLE_HEADER,
STANDALONE,
AUTO_CUSTOMIZATION_CRITERIA,
CREATION_DATE,
CREATED_BY,
LAST_UPDATE_DATE,
LAST_UPDATED_BY,
LAST_UPDATE_LOGIN,
ATTRIBUTE_CATEGORY,
ATTRIBUTE1,
ATTRIBUTE2,
ATTRIBUTE3,
ATTRIBUTE4,
ATTRIBUTE5,
ATTRIBUTE6,
ATTRIBUTE7,
ATTRIBUTE8,
ATTRIBUTE9,
ATTRIBUTE10,
ATTRIBUTE11,
ATTRIBUTE12,
ATTRIBUTE13,
ATTRIBUTE14,
ATTRIBUTE15
) values (
r_rec.REGION_APPLICATION_ID,
r_rec.REGION_CODE,
r_rec.DATABASE_OBJECT_NAME,
r_rec.REGION_STYLE,
r_rec.NUM_COLUMNS,
r_rec.ICX_CUSTOM_CALL,
r_rec.REGION_DEFAULTING_API_PKG,
r_rec.REGION_DEFAULTING_API_PROC,
r_rec.REGION_VALIDATION_API_PKG,
r_rec.REGION_VALIDATION_API_PROC,
r_rec.APPLICATIONMODULE_OBJECT_TYPE,
r_rec.NUM_ROWS_DISPLAY,
r_rec.REGION_OBJECT_TYPE,
r_rec.IMAGE_FILE_NAME,
r_rec.ISFORM_FLAG,
r_rec.HELP_TARGET,
r_rec.STYLE_SHEET_FILENAME,
r_rec.VERSION,
r_rec.APPLICATIONMODULE_USAGE_NAME,
r_rec.ADD_INDEXED_CHILDREN,
r_rec.STATEFUL_FLAG,
r_rec.FUNCTION_NAME,
r_rec.CHILDREN_VIEW_USAGE_NAME,
r_rec.SEARCH_PANEL,
r_rec.ADVANCED_SEARCH_PANEL,
r_rec.CUSTOMIZE_PANEL,
r_rec.DEFAULT_SEARCH_PANEL,
r_rec.RESULTS_BASED_SEARCH,
r_rec.DISPLAY_GRAPH_TABLE,
r_rec.DISABLE_HEADER,
r_rec.STANDALONE,
r_rec.AUTO_CUSTOMIZATION_CRITERIA,
r_rec.CREATION_DATE,
r_rec.CREATED_BY,
r_rec.LAST_UPDATE_DATE,
r_rec.LAST_UPDATED_BY,
r_rec.LAST_UPDATE_LOGIN,
r_rec.ATTRIBUTE_CATEGORY,
r_rec.ATTRIBUTE1,
r_rec.ATTRIBUTE2,
r_rec.ATTRIBUTE3,
r_rec.ATTRIBUTE4,
r_rec.ATTRIBUTE5,
r_rec.ATTRIBUTE6,
r_rec.ATTRIBUTE7,
r_rec.ATTRIBUTE8,
r_rec.ATTRIBUTE9,
r_rec.ATTRIBUTE10,
r_rec.ATTRIBUTE11,
r_rec.ATTRIBUTE12,
r_rec.ATTRIBUTE13,
r_rec.ATTRIBUTE14,
r_rec.ATTRIBUTE15
);

FOR rt_rec IN rt_csr( p_o_code, p_o_id) LOOP
-- Put new code and id into record and insert into appropriate table
rt_rec.region_code		:= p_n_code;
rt_rec.region_application_id	:= p_n_id;
insert into AK_REGIONS_TL (
REGION_APPLICATION_ID,
REGION_CODE,
LANGUAGE,
NAME,
DESCRIPTION,
SOURCE_LANG,
CREATED_BY,
CREATION_DATE,
LAST_UPDATED_BY,
LAST_UPDATE_DATE,
LAST_UPDATE_LOGIN
) values (
rt_rec.REGION_APPLICATION_ID,
rt_rec.REGION_CODE,
rt_rec.LANGUAGE,
rt_rec.NAME,
rt_rec.DESCRIPTION,
rt_rec.SOURCE_LANG,
rt_rec.CREATED_BY,
rt_rec.CREATION_DATE,
rt_rec.LAST_UPDATED_BY,
rt_rec.LAST_UPDATE_DATE,
rt_rec.LAST_UPDATE_LOGIN
);
END LOOP;

FOR ri_rec IN ri_csr( p_o_code, p_o_id) LOOP
-- Put new code and id into record and insert into appropriate table
ri_rec.region_code		:= p_n_code;
ri_rec.region_application_id	:= p_n_id;

insert into AK_REGION_ITEMS (
REGION_APPLICATION_ID,
REGION_CODE,
ATTRIBUTE_APPLICATION_ID,
ATTRIBUTE_CODE,
DISPLAY_SEQUENCE,
NODE_DISPLAY_FLAG,
NODE_QUERY_FLAG,
ATTRIBUTE_LABEL_LENGTH,
BOLD,
ITALIC,
VERTICAL_ALIGNMENT,
HORIZONTAL_ALIGNMENT,
ITEM_STYLE,
OBJECT_ATTRIBUTE_FLAG,
SECURITY_CODE,
UPDATE_FLAG,
REQUIRED_FLAG,
DISPLAY_VALUE_LENGTH,
LOV_REGION_APPLICATION_ID,
LOV_REGION_CODE,
LOV_FOREIGN_KEY_NAME,
LOV_ATTRIBUTE_APPLICATION_ID,
LOV_ATTRIBUTE_CODE,
LOV_DEFAULT_FLAG,
REGION_DEFAULTING_API_PKG,
REGION_DEFAULTING_API_PROC,
REGION_VALIDATION_API_PKG,
REGION_VALIDATION_API_PROC,
ORDER_SEQUENCE,
ORDER_DIRECTION,
DEFAULT_VALUE_VARCHAR2,
DEFAULT_VALUE_NUMBER,
DEFAULT_VALUE_DATE,
DISPLAY_HEIGHT,
SUBMIT,
ENCRYPT,
VIEW_USAGE_NAME,
VIEW_ATTRIBUTE_NAME,
CSS_CLASS_NAME,
CSS_LABEL_CLASS_NAME,
URL,
POPLIST_VIEWOBJECT,
POPLIST_DISPLAY_ATTRIBUTE,
POPLIST_VALUE_ATTRIBUTE,
IMAGE_FILE_NAME,
NESTED_REGION_CODE,
NESTED_REGION_APPLICATION_ID,
ITEM_NAME,
MENU_NAME,
CREATION_DATE,
CREATED_BY,
LAST_UPDATE_DATE,
LAST_UPDATED_BY,
LAST_UPDATE_LOGIN,
FLEXFIELD_NAME,
FLEXFIELD_APPLICATION_ID,
TABULAR_FUNCTION_CODE,
TIP_TYPE ,
TIP_MESSAGE_NAME,
TIP_MESSAGE_APPLICATION_ID,
FLEX_SEGMENT_LIST,
ENTITY_ID,
ANCHOR,
POPLIST_VIEW_USAGE_NAME,
USER_CUSTOMIZABLE,
SORTBY_VIEW_ATTRIBUTE_NAME,
ADMIN_CUSTOMIZABLE,
INVOKE_FUNCTION_NAME,
EXPANSION,
ALS_MAX_LENGTH,
INITIAL_SORT_SEQUENCE,
CUSTOMIZATION_APPLICATION_ID,
CUSTOMIZATION_CODE,
ATTRIBUTE_CATEGORY,
ATTRIBUTE1,
ATTRIBUTE2,
ATTRIBUTE3,
ATTRIBUTE4,
ATTRIBUTE5,
ATTRIBUTE6,
ATTRIBUTE7,
ATTRIBUTE8,
ATTRIBUTE9,
ATTRIBUTE10,
ATTRIBUTE11,
ATTRIBUTE12,
ATTRIBUTE13,
ATTRIBUTE14,
ATTRIBUTE15
) values (
ri_rec.REGION_APPLICATION_ID,
ri_rec.REGION_CODE,
ri_rec.ATTRIBUTE_APPLICATION_ID,
ri_rec.ATTRIBUTE_CODE,
ri_rec.DISPLAY_SEQUENCE,
ri_rec.NODE_DISPLAY_FLAG,
ri_rec.NODE_QUERY_FLAG,
ri_rec.ATTRIBUTE_LABEL_LENGTH,
ri_rec.BOLD,
ri_rec.ITALIC,
ri_rec.VERTICAL_ALIGNMENT,
ri_rec.HORIZONTAL_ALIGNMENT,
ri_rec.ITEM_STYLE,
ri_rec.OBJECT_ATTRIBUTE_FLAG,
ri_rec.SECURITY_CODE,
ri_rec.UPDATE_FLAG,
ri_rec.REQUIRED_FLAG,
ri_rec.DISPLAY_VALUE_LENGTH,
ri_rec.LOV_REGION_APPLICATION_ID,
ri_rec.LOV_REGION_CODE,
ri_rec.LOV_FOREIGN_KEY_NAME,
ri_rec.LOV_ATTRIBUTE_APPLICATION_ID,
ri_rec.LOV_ATTRIBUTE_CODE,
ri_rec.LOV_DEFAULT_FLAG,
ri_rec.REGION_DEFAULTING_API_PKG,
ri_rec.REGION_DEFAULTING_API_PROC,
ri_rec.REGION_VALIDATION_API_PKG,
ri_rec.REGION_VALIDATION_API_PROC,
ri_rec.ORDER_SEQUENCE,
ri_rec.ORDER_DIRECTION,
ri_rec.DEFAULT_VALUE_VARCHAR2,
ri_rec.DEFAULT_VALUE_NUMBER,
ri_rec.DEFAULT_VALUE_DATE,
ri_rec.DISPLAY_HEIGHT,
ri_rec.SUBMIT,
ri_rec.ENCRYPT,
ri_rec.VIEW_USAGE_NAME,
ri_rec.VIEW_ATTRIBUTE_NAME,
ri_rec.CSS_CLASS_NAME,
ri_rec.CSS_LABEL_CLASS_NAME,
ri_rec.URL,
ri_rec.POPLIST_VIEWOBJECT,
ri_rec.POPLIST_DISPLAY_ATTRIBUTE,
ri_rec.POPLIST_VALUE_ATTRIBUTE,
ri_rec.IMAGE_FILE_NAME,
ri_rec.NESTED_REGION_CODE,
ri_rec.NESTED_REGION_APPLICATION_ID,
ri_rec.ITEM_NAME,
ri_rec.MENU_NAME,
ri_rec.CREATION_DATE,
ri_rec.CREATED_BY,
ri_rec.LAST_UPDATE_DATE,
ri_rec.LAST_UPDATED_BY,
ri_rec.LAST_UPDATE_LOGIN,
ri_rec.FLEXFIELD_NAME,
ri_rec.FLEXFIELD_APPLICATION_ID,
ri_rec.TABULAR_FUNCTION_CODE,
ri_rec.TIP_TYPE ,
ri_rec.TIP_MESSAGE_NAME,
ri_rec.TIP_MESSAGE_APPLICATION_ID,
ri_rec.FLEX_SEGMENT_LIST,
ri_rec.ENTITY_ID,
ri_rec.ANCHOR,
ri_rec.POPLIST_VIEW_USAGE_NAME,
ri_rec.USER_CUSTOMIZABLE,
ri_rec.SORTBY_VIEW_ATTRIBUTE_NAME,
ri_rec.ADMIN_CUSTOMIZABLE,
ri_rec.INVOKE_FUNCTION_NAME,
ri_rec.EXPANSION,
ri_rec.ALS_MAX_LENGTH,
ri_rec.INITIAL_SORT_SEQUENCE,
ri_rec.CUSTOMIZATION_APPLICATION_ID,
ri_rec.CUSTOMIZATION_CODE,
ri_rec.ATTRIBUTE_CATEGORY,
ri_rec.ATTRIBUTE1,
ri_rec.ATTRIBUTE2,
ri_rec.ATTRIBUTE3,
ri_rec.ATTRIBUTE4,
ri_rec.ATTRIBUTE5,
ri_rec.ATTRIBUTE6,
ri_rec.ATTRIBUTE7,
ri_rec.ATTRIBUTE8,
ri_rec.ATTRIBUTE9,
ri_rec.ATTRIBUTE10,
ri_rec.ATTRIBUTE11,
ri_rec.ATTRIBUTE12,
ri_rec.ATTRIBUTE13,
ri_rec.ATTRIBUTE14,
ri_rec.ATTRIBUTE15
);
END LOOP;

FOR rit_rec IN rit_csr( p_o_code, p_o_id) LOOP
-- Put new code and id into record and insert into appropriate table
rit_rec.region_code		:= p_n_code;
rit_rec.region_application_id	:= p_n_id;

insert into AK_REGION_ITEMS_TL (
REGION_APPLICATION_ID,
REGION_CODE,
ATTRIBUTE_APPLICATION_ID,
ATTRIBUTE_CODE,
LANGUAGE,
ATTRIBUTE_LABEL_LONG,
DESCRIPTION,
SOURCE_LANG,
CREATED_BY,
CREATION_DATE,
LAST_UPDATED_BY,
LAST_UPDATE_DATE,
LAST_UPDATE_LOGIN
) values (
rit_rec.REGION_APPLICATION_ID,
rit_rec.REGION_CODE,
rit_rec.ATTRIBUTE_APPLICATION_ID,
rit_rec.ATTRIBUTE_CODE,
rit_rec.LANGUAGE,
rit_rec.ATTRIBUTE_LABEL_LONG,
rit_rec.DESCRIPTION,
rit_rec.SOURCE_LANG,
rit_rec.CREATED_BY,
rit_rec.CREATION_DATE,
rit_rec.LAST_UPDATED_BY,
rit_rec.LAST_UPDATE_DATE,
rit_rec.LAST_UPDATE_LOGIN
);
END LOOP;

FOR rlr_rec IN rlr_csr( p_o_code, p_o_id) LOOP
-- Put new code and id into record and insert into appropriate table
rlr_rec.region_code             := p_n_code;
rlr_rec.region_application_id   := p_n_id;

insert into AK_REGION_LOV_RELATIONS (
REGION_APPLICATION_ID,
REGION_CODE,
ATTRIBUTE_APPLICATION_ID,
ATTRIBUTE_CODE,
LOV_REGION_APPL_ID,
LOV_REGION_CODE,
LOV_ATTRIBUTE_APPL_ID,
LOV_ATTRIBUTE_CODE,
BASE_REGION_APPL_ID,
BASE_REGION_CODE,
BASE_ATTRIBUTE_APPL_ID,
BASE_ATTRIBUTE_CODE,
DIRECTION_FLAG,
LAST_UPDATE_DATE,
LAST_UPDATED_BY,
CREATION_DATE,
CREATED_BY,
LAST_UPDATE_LOGIN,
REQUIRED_FLAG
) values (
rlr_rec.REGION_APPLICATION_ID,
rlr_rec.REGION_CODE,
rlr_rec.ATTRIBUTE_APPLICATION_ID,
rlr_rec.ATTRIBUTE_CODE,
rlr_rec.LOV_REGION_APPL_ID,
rlr_rec.LOV_REGION_CODE,
rlr_rec.LOV_ATTRIBUTE_APPL_ID,
rlr_rec.LOV_ATTRIBUTE_CODE,
rlr_rec.BASE_REGION_APPL_ID,
rlr_rec.BASE_REGION_CODE,
rlr_rec.BASE_ATTRIBUTE_APPL_ID,
rlr_rec.BASE_ATTRIBUTE_CODE,
rlr_rec.DIRECTION_FLAG,
rlr_rec.LAST_UPDATE_DATE,
rlr_rec.LAST_UPDATED_BY,
rlr_rec.CREATION_DATE,
rlr_rec.CREATED_BY,
rlr_rec.LAST_UPDATE_LOGIN,
rlr_rec.REQUIRED_FLAG
);
END LOOP;
commit;
END copy_records;


end AK_REGIONS2_PKG;

/
