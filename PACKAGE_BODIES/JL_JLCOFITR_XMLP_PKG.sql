--------------------------------------------------------
--  DDL for Package Body JL_JLCOFITR_XMLP_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."JL_JLCOFITR_XMLP_PKG" AS
/* $Header: JLCOFITRB.pls 120.1 2007/12/25 16:47:00 dwkrishn noship $ */
  FUNCTION BOOKFORMULA RETURN VARCHAR2 IS
  BEGIN
    DECLARE
      L_BOOK VARCHAR2(15);
      L_BOOK_CLASS VARCHAR2(15);
      L_ACCOUNTING_FLEX_STRUCTURE NUMBER(15);
      L_CURRENCY_CODE VARCHAR2(15);
      L_DISTRIBUTION_SOURCE_BOOK VARCHAR2(15);
      L_PRECISION NUMBER(15);
    BEGIN
      SELECT
        BC.BOOK_TYPE_CODE,
        BC.BOOK_CLASS,
        BC.ACCOUNTING_FLEX_STRUCTURE,
        BC.DISTRIBUTION_SOURCE_BOOK,
        SOB.CURRENCY_CODE,
        CUR.PRECISION
      INTO L_BOOK,L_BOOK_CLASS,L_ACCOUNTING_FLEX_STRUCTURE,L_DISTRIBUTION_SOURCE_BOOK,L_CURRENCY_CODE,L_PRECISION
      FROM
        FA_BOOK_CONTROLS BC,
        GL_SETS_OF_BOOKS SOB,
        FND_CURRENCIES CUR
      WHERE BC.BOOK_TYPE_CODE = P_BOOK
        AND SOB.SET_OF_BOOKS_ID = BC.SET_OF_BOOKS_ID
        AND SOB.CURRENCY_CODE = CUR.CURRENCY_CODE;
      BOOK_CLASS := L_BOOK_CLASS;
      ACCOUNTING_FLEX_STRUCTURE := L_ACCOUNTING_FLEX_STRUCTURE;
      DISTRIBUTION_SOURCE_BOOK := L_DISTRIBUTION_SOURCE_BOOK;
      CURRENCY_CODE := L_CURRENCY_CODE;
      P_MIN_PRECISION := L_PRECISION;
      RETURN (L_BOOK);
    END;
    RETURN NULL;
  END BOOKFORMULA;

  FUNCTION PERIOD1FORMULA RETURN VARCHAR2 IS
  BEGIN
    DECLARE
      L_PERIOD_NAME VARCHAR2(15);
      L_PERIOD_POD DATE;
      L_PERIOD_PCD DATE;
      L_PERIOD_PC NUMBER(15);
      L_PERIOD_FY NUMBER(15);
    BEGIN
      SELECT
        PERIOD_NAME,
        PERIOD_COUNTER,
        PERIOD_OPEN_DATE,
        NVL(PERIOD_CLOSE_DATE
           ,SYSDATE),
        FISCAL_YEAR
      INTO L_PERIOD_NAME,L_PERIOD_PC,L_PERIOD_POD,L_PERIOD_PCD,L_PERIOD_FY
      FROM
        FA_DEPRN_PERIODS
      WHERE BOOK_TYPE_CODE = P_BOOK
        AND PERIOD_NAME = P_PERIOD1;
      PERIOD1_PC := L_PERIOD_PC;
      PERIOD1_POD := L_PERIOD_POD;
      PERIOD1_PCD := L_PERIOD_PCD;
      PERIOD1_FY := L_PERIOD_FY;
      RETURN (L_PERIOD_NAME);
    EXCEPTION
      WHEN OTHERS THEN
        NULL;
    END;
    RETURN NULL;
  END PERIOD1FORMULA;

  FUNCTION REPORT_NAMEFORMULA(COMPANY_NAME IN VARCHAR2) RETURN VARCHAR2 IS
  BEGIN
    DECLARE
      L_REPORT_NAME VARCHAR2(240);
      L_CONC_PROGRAM_ID NUMBER;
    BEGIN
      RP_COMPANY_NAME := COMPANY_NAME;
      SELECT
        CR.CONCURRENT_PROGRAM_ID
      INTO L_CONC_PROGRAM_ID
      FROM
        FND_CONCURRENT_REQUESTS CR
      WHERE CR.PROGRAM_APPLICATION_ID = 7004
        AND CR.REQUEST_ID = P_CONC_REQUEST_ID;
      SELECT
        CP.USER_CONCURRENT_PROGRAM_NAME
      INTO L_REPORT_NAME
      FROM
        FND_CONCURRENT_PROGRAMS_VL CP
      WHERE CP.CONCURRENT_PROGRAM_ID = L_CONC_PROGRAM_ID
        AND CP.APPLICATION_ID = 7004;
      RP_REPORT_NAME := SUBSTR(L_REPORT_NAME,1,INSTR(L_REPORT_NAME,' (XML)'));
      RETURN (RP_REPORT_NAME);
    EXCEPTION
      WHEN OTHERS THEN
        RP_REPORT_NAME := 'Drill Down Report';
        RETURN (RP_REPORT_NAME);
    END;
    RETURN NULL;
  END REPORT_NAMEFORMULA;

  FUNCTION BEFOREREPORT RETURN BOOLEAN IS
  BEGIN
    P_CONC_REQUEST_ID := FND_GLOBAL.CONC_REQUEST_ID;
    /*SRW.USER_EXIT('FND SRWINIT')*/NULL;
    RETURN (TRUE);
  END BEFOREREPORT;

  FUNCTION AFTERREPORT RETURN BOOLEAN IS
  BEGIN
    /*SRW.USER_EXIT('FND SRWEXIT')*/NULL;
    RETURN (TRUE);
  END AFTERREPORT;

  FUNCTION BOOK_CLASS_P RETURN VARCHAR2 IS
  BEGIN
    RETURN BOOK_CLASS;
  END BOOK_CLASS_P;

  FUNCTION DISTRIBUTION_SOURCE_BOOK_P RETURN VARCHAR2 IS
  BEGIN
    RETURN DISTRIBUTION_SOURCE_BOOK;
  END DISTRIBUTION_SOURCE_BOOK_P;

  FUNCTION PERIOD1_PC_P RETURN NUMBER IS
  BEGIN
    RETURN PERIOD1_PC;
  END PERIOD1_PC_P;

  FUNCTION PERIOD1_PCD_P RETURN DATE IS
  BEGIN
    RETURN PERIOD1_PCD;
  END PERIOD1_PCD_P;

  FUNCTION PERIOD1_POD_P RETURN DATE IS
  BEGIN
    RETURN PERIOD1_POD;
  END PERIOD1_POD_P;

  FUNCTION PERIOD1_FY_P RETURN NUMBER IS
  BEGIN
    RETURN PERIOD1_FY;
  END PERIOD1_FY_P;

  FUNCTION CURRENCY_CODE_P RETURN VARCHAR2 IS
  BEGIN
    RETURN CURRENCY_CODE;
  END CURRENCY_CODE_P;

  FUNCTION RP_COMPANY_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN RP_COMPANY_NAME;
  END RP_COMPANY_NAME_P;

  FUNCTION RP_REPORT_NAME_P RETURN VARCHAR2 IS
  BEGIN
    RETURN RP_REPORT_NAME;
  END RP_REPORT_NAME_P;

  FUNCTION ACCOUNTING_FLEX_STRUCTURE_P RETURN NUMBER IS
  BEGIN
    RETURN ACCOUNTING_FLEX_STRUCTURE;
  END ACCOUNTING_FLEX_STRUCTURE_P;

END JL_JLCOFITR_XMLP_PKG;



/
