--------------------------------------------------------
--  DDL for Package Body ASO_CHANGED_QUOTES_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."ASO_CHANGED_QUOTES_PKG" AS
/* $Header: asotcqtb.pls 120.0 2005/08/29 23:54:05 gsachdev noship $ */

G_PKG_NAME  CONSTANT VARCHAR2(30) := 'ASO_CHANGED_QUOTES_PKG';
G_FILE_NAME CONSTANT VARCHAR2(12) := 'asotcqtb.pls';

procedure INSERT_ROW (
  P_QUOTE_NUMBER		IN NUMBER,
  P_LAST_UPDATE_DATE		IN DATE,
  P_LAST_UPDATED_BY		IN NUMBER,
  P_CREATION_DATE		IN DATE,
  P_CREATED_BY			IN NUMBER,
  P_LAST_UPDATE_LOGIN		IN NUMBER,
  P_REQUEST_ID			IN NUMBER,
  P_PROGRAM_APPLICATION_ID	IN NUMBER,
  P_PROGRAM_ID			IN NUMBER,
  P_PROGRAM_UPDATE_DATE		IN DATE,
  P_CONC_REQUEST_ID		IN NUMBER
)
IS

BEGIN
  insert into ASO_CHANGED_QUOTES (
    QUOTE_NUMBER,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_LOGIN,
    REQUEST_ID,
    PROGRAM_APPLICATION_ID,
    PROGRAM_ID,
    PROGRAM_UPDATE_DATE,
    CONC_REQUEST_ID
  ) VALUES
  (
    decode( P_QUOTE_NUMBER, FND_API.G_MISS_NUM, NULL, P_QUOTE_NUMBER),
    ASO_UTILITY_PVT.decode( P_LAST_UPDATE_DATE, FND_API.G_MISS_DATE, NULL, p_LAST_UPDATE_DATE),
    decode( p_LAST_UPDATED_BY, FND_API.G_MISS_NUM, NULL, p_LAST_UPDATED_BY),
    ASO_UTILITY_PVT.decode( P_CREATION_DATE, FND_API.G_MISS_DATE, NULL, p_CREATION_DATE),
    decode( p_CREATED_BY, FND_API.G_MISS_NUM, NULL, p_CREATED_BY),
    decode( p_LAST_UPDATE_LOGIN, FND_API.G_MISS_NUM, NULL, p_LAST_UPDATE_LOGIN),
    decode( P_REQUEST_ID, FND_API.G_MISS_NUM, NULL, P_REQUEST_ID),
    decode( P_PROGRAM_APPLICATION_ID, FND_API.G_MISS_NUM, NULL, P_PROGRAM_APPLICATION_ID),
    decode( P_PROGRAM_ID, FND_API.G_MISS_NUM, NULL, P_PROGRAM_ID),
    ASO_UTILITY_PVT.decode( P_PROGRAM_UPDATE_DATE, FND_API.G_MISS_DATE, NULL, P_PROGRAM_UPDATE_DATE),
    decode( P_CONC_REQUEST_ID, FND_API.G_MISS_NUM, NULL, P_CONC_REQUEST_ID)
   );

end INSERT_ROW;

procedure UPDATE_ROW (
  P_QUOTE_NUMBER		IN NUMBER,
  P_LAST_UPDATE_DATE		IN DATE,
  P_LAST_UPDATED_BY		IN NUMBER,
  P_CREATION_DATE		IN DATE,
  P_CREATED_BY			IN NUMBER,
  P_LAST_UPDATE_LOGIN		IN NUMBER,
  P_REQUEST_ID			IN NUMBER,
  P_PROGRAM_APPLICATION_ID	IN NUMBER,
  P_PROGRAM_ID			IN NUMBER,
  P_PROGRAM_UPDATE_DATE		IN DATE,
  P_CONC_REQUEST_ID		IN NUMBER
)
IS
BEGIN
  update ASO_CHANGED_QUOTES
  set
  QUOTE_NUMBER = decode( P_QUOTE_NUMBER, FND_API.G_MISS_NUM, QUOTE_NUMBER, P_QUOTE_NUMBER),
  LAST_UPDATE_DATE = ASO_UTILITY_PVT.decode( p_LAST_UPDATE_DATE, FND_API.G_MISS_DATE, LAST_UPDATE_DATE, p_LAST_UPDATE_DATE),
  LAST_UPDATED_BY = decode( p_LAST_UPDATED_BY, FND_API.G_MISS_NUM, LAST_UPDATED_BY, p_LAST_UPDATED_BY),
  LAST_UPDATE_LOGIN = decode( p_LAST_UPDATE_LOGIN, FND_API.G_MISS_NUM, LAST_UPDATE_LOGIN, p_LAST_UPDATE_LOGIN),
  REQUEST_ID = decode( p_REQUEST_ID, FND_API.G_MISS_NUM, REQUEST_ID, p_REQUEST_ID),
  PROGRAM_APPLICATION_ID = decode( p_PROGRAM_APPLICATION_ID, FND_API.G_MISS_NUM,PROGRAM_APPLICATION_ID, p_PROGRAM_APPLICATION_ID),
  PROGRAM_ID = decode( p_PROGRAM_ID, FND_API.G_MISS_NUM, PROGRAM_ID, p_PROGRAM_ID),
  PROGRAM_UPDATE_DATE = ASO_UTILITY_PVT.decode( p_PROGRAM_UPDATE_DATE, FND_API.G_MISS_DATE, PROGRAM_UPDATE_DATE, p_PROGRAM_UPDATE_DATE),
  CONC_REQUEST_ID = decode( P_CONC_REQUEST_ID, FND_API.G_MISS_NUM, CONC_REQUEST_ID, P_CONC_REQUEST_ID)
  WHERE QUOTE_NUMBER = P_QUOTE_NUMBER ;

  If (SQL%NOTFOUND) then
        RAISE NO_DATA_FOUND;
  End If;

end UPDATE_ROW;

procedure DELETE_ROW (
  P_QUOTE_NUMBER		IN NUMBER,
  P_CONC_REQUEST_ID		IN NUMBER
) is
begin
  delete from ASO_CHANGED_QUOTES
  where QUOTE_NUMBER = P_QUOTE_NUMBER
  and CONC_REQUEST_ID = P_CONC_REQUEST_ID;

  if (sql%notfound) then
    raise no_data_found;
  end if;

end DELETE_ROW;

procedure LOCK_ROW (
  P_QUOTE_NUMBER		IN NUMBER,
  P_LAST_UPDATE_DATE		IN DATE,
  P_LAST_UPDATED_BY		IN NUMBER,
  P_CREATION_DATE		IN DATE,
  P_CREATED_BY			IN NUMBER,
  P_LAST_UPDATE_LOGIN		IN NUMBER,
  P_REQUEST_ID			IN NUMBER,
  P_PROGRAM_APPLICATION_ID	IN NUMBER,
  P_PROGRAM_ID			IN NUMBER,
  P_PROGRAM_UPDATE_DATE		IN DATE,
  P_CONC_REQUEST_ID		IN NUMBER
)
IS
  cursor c1 is select
  QUOTE_NUMBER,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  CONC_REQUEST_ID
  from ASO_CHANGED_QUOTES
    where QUOTE_NUMBER = P_QUOTE_NUMBER
    for update of CONC_REQUEST_ID nowait;

   recinfo C1%ROWTYPE;
begin
   OPEN C1;
   FETCH C1 INTO recinfo;
   IF (C1%NOTFOUND) THEN
      CLOSE C1;
      FND_MESSAGE.SET_NAME('FND', 'FORM_RECORD_DELETED');
      APP_EXCEPTION.RAISE_EXCEPTION;
   End If;
   CLOSE C1;


   if  (    ( Recinfo.LAST_UPDATE_DATE = p_LAST_UPDATE_DATE)
            OR (    ( Recinfo.LAST_UPDATE_DATE IS NULL )
                AND (  p_LAST_UPDATE_DATE IS NULL ))) then
       return;
   else
       fnd_message.set_name('FND', 'FORM_RECORD_CHANGED');
       app_exception.raise_exception;
   end if;
end LOCK_ROW;

end ASO_CHANGED_QUOTES_PKG;

/
