--------------------------------------------------------
--  DDL for Package Body AR_TRX_GLOBAL_PROCESS_HEADER
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."AR_TRX_GLOBAL_PROCESS_HEADER" AS
/* $Header: ARINGTHB.pls 120.18.12010000.3 2010/01/28 09:58:10 aghoraka ship $ */

pg_debug                VARCHAR2(1) := nvl(fnd_profile.value('AFLOG_ENABLED'),'N');

PROCEDURE INSERT_ROW (
    p_trx_header_tbl            IN      AR_INVOICE_API_PUB.trx_header_tbl_type,
    p_batch_source_rec          IN      AR_INVOICE_API_PUB.batch_source_rec_type,
    x_errmsg                    OUT NOCOPY  VARCHAR2,
    x_return_status             OUT NOCOPY  VARCHAR2
    ) IS
BEGIN

    IF pg_debug = 'Y'
    THEN
        ar_invoice_utils.debug ('AR_TRX_GLOBAL_PROCESS_HEADER.INERT_ROW(+)');
    END IF;




    FOR i IN  p_trx_header_tbl.FIRST .. p_trx_header_tbl.LAST
    LOOP
   arp_util.debug ( 'insert header ' || (p_trx_header_tbl(i).trx_header_id) );
   arp_util.debug ( 'insert header PMT' || (p_trx_header_tbl(i).payment_trxn_extension_id) );

        INSERT INTO ar_trx_header_gt (
            trx_header_id,
            customer_trx_id,
            created_by,
            creation_date,
            created_from,
            last_updated_by,
            last_update_date,
            last_update_login,
            set_of_books_id,
            org_id,
            trx_number,
            trx_date,
            trx_currency,
            reference_number,
            trx_class,
            batch_source_id,
            cust_trx_type_id,
            gl_date,
            bill_to_customer_id,
            bill_to_account_number,
            bill_to_customer_name,
            bill_to_location_id,
            bill_to_contact_id,
            bill_to_address_id,
            bill_to_site_use_id,
            ship_to_customer_id,
            ship_to_account_number,
            ship_to_customer_name,
            ship_to_location_id,
            ship_to_contact_id,
            ship_to_address_id,
            ship_to_site_use_id,
            sold_to_customer_id,
            sold_to_site_use_id,
            sold_to_contact_id,
            term_id,
            primary_salesrep_id,
            primary_salesrep_name,
            exchange_rate_type,
            exchange_date,
            exchange_rate,
            territory_id,
            remit_to_address_id,
            invoicing_rule_id,
            shipment_id,
            printing_option,
	    printing_count,
            purchase_order,
	    purchase_order_revision,
	    purchase_order_date,
	    customer_reference,
	    customer_reference_date,
	    comments,
	    internal_notes,
            finance_charges,
	    credit_method_for_rules,
	    credit_method_for_installments,
	    receipt_method_id,
            related_customer_trx_id,
            agreement_id,
	    ship_via,
	    ship_date_actual,
	    waybill_number,
	    fob_point,
	    customer_bank_account_id,
	    default_ussgl_trx_code_context,
	    default_ussgl_transaction_code,
	    recurred_from_trx_number,
            status_trx,
	    paying_customer_id,
	    paying_site_use_id,
	    default_tax_exempt_flag,
            mrc_exchange_rate_type,
            mrc_exchange_date,
            mrc_exchange_rate,
            doc_sequence_id,
            doc_sequence_value,
            attribute_category,
            attribute1,
            attribute2,
            attribute3,
            attribute4,
            attribute5,
            attribute6,
            attribute7,
            attribute8,
            attribute9,
            attribute10,
            attribute11,
            attribute12,
            attribute13,
            attribute14,
            attribute15,
            global_attribute_category,
            global_attribute1,
            global_attribute2,
            global_attribute3,
            global_attribute4,
            global_attribute5,
            global_attribute6,
            global_attribute7,
            global_attribute8,
            global_attribute9,
            global_attribute10,
            global_attribute11,
            global_attribute12,
            global_attribute13,
            global_attribute14,
            global_attribute15,
            global_attribute16,
            global_attribute17,
            global_attribute18,
            global_attribute19,
            global_attribute20,
            global_attribute21,
            global_attribute22,
            global_attribute23,
            global_attribute24,
            global_attribute25,
            global_attribute26,
            global_attribute27,
            global_attribute28,
            global_attribute29,
            global_attribute30,
            interface_header_context,
            interface_header_attribute1,
            interface_header_attribute2,
            interface_header_attribute3,
            interface_header_attribute4,
            interface_header_attribute5,
            interface_header_attribute6,
            interface_header_attribute7,
            interface_header_attribute8,
            interface_header_attribute9,
            interface_header_attribute10,
            interface_header_attribute11,
            interface_header_attribute12,
            interface_header_attribute13,
            interface_header_attribute14,
            interface_header_attribute15,
            legal_entity_id,
            payment_trxn_extension_id,
            billing_date,
            interest_header_id,
            late_charges_assessed,
            batch_id,
            request_id,
            defaulted_gl_date_flag,

            document_sub_type,
            default_taxation_country,
	    mandate_last_trx_flag)
        VALUES
            (p_trx_header_tbl(i).trx_header_id,
             ra_customer_trx_s.nextval,
             fnd_global.user_id,
             sysdate,
             'AR_INVOICE_API',                                  -- 5921925
             fnd_global.user_id,
             sysdate,
             fnd_global.login_id,
             arp_global.sysparam.set_of_books_id,               -- 5921925
             arp_global.sysparam.org_id,                        -- 5921925
             p_trx_header_tbl(i).trx_number,
             NVL(trunc(p_trx_header_tbl(i).trx_date),trunc(sysdate)),/*5921925,8963998*/
             NVL(p_trx_header_tbl(i).trx_currency,
                   arp_global.functional_currency),             -- 5921925
             p_trx_header_tbl(i).reference_number,
             p_trx_header_tbl(i).trx_class,
             p_batch_source_rec.batch_source_id,
             p_trx_header_tbl(i).cust_trx_type_id,
             NVL(trunc(p_trx_header_tbl(i).gl_date),
                 p_batch_source_rec.default_date),              -- 5921925
             p_trx_header_tbl(i).bill_to_customer_id,
             p_trx_header_tbl(i).bill_to_account_number,
             p_trx_header_tbl(i).bill_to_customer_name,
             null, -- p_trx_header_tbl(i).bill_to_location_id,
             p_trx_header_tbl(i).bill_to_contact_id,
             p_trx_header_tbl(i).bill_to_address_id,
             p_trx_header_tbl(i).bill_to_site_use_id,
             p_trx_header_tbl(i).ship_to_customer_id,
             p_trx_header_tbl(i).ship_to_account_number,
             p_trx_header_tbl(i).ship_to_customer_name,
             null, -- p_trx_header_tbl(i).ship_to_location_id,
             p_trx_header_tbl(i).ship_to_contact_id,
             p_trx_header_tbl(i).ship_to_address_id,
             p_trx_header_tbl(i).ship_to_site_use_id,
             NVL(p_trx_header_tbl(i).sold_to_customer_id,
                 p_trx_header_tbl(i).bill_to_customer_id),
             null, -- p_trx_header_tbl(i).sold_to_site_use_id,
             null, -- p_trx_header_tbl(i).sold_to_contact_id,
             p_trx_header_tbl(i).term_id,
             p_trx_header_tbl(i).primary_salesrep_id,
             p_trx_header_tbl(i).primary_salesrep_name,
             p_trx_header_tbl(i).exchange_rate_type,
             p_trx_header_tbl(i).exchange_date,
             p_trx_header_tbl(i).exchange_rate,
             p_trx_header_tbl(i).territory_id,
             p_trx_header_tbl(i).remit_to_address_id,
             p_trx_header_tbl(i).invoicing_rule_id,
             null, -- p_trx_header_tbl(i).SHIPMENT_ID,
             p_trx_header_tbl(i).PRINTING_OPTION,
	     null, -- p_trx_header_tbl(i).PRINTING_COUNT,
             p_trx_header_tbl(i).PURCHASE_ORDER,
	     p_trx_header_tbl(i).PURCHASE_ORDER_REVISION,
	     p_trx_header_tbl(i).PURCHASE_ORDER_DATE,
	     null, -- p_trx_header_tbl(i).CUSTOMER_REFERENCE,
	     null, -- p_trx_header_tbl(i).CUSTOMER_REFERENCE_DATE,
	     p_trx_header_tbl(i).COMMENTS,
	     p_trx_header_tbl(i).INTERNAL_NOTES,
             p_trx_header_tbl(i).FINANCE_CHARGES,
	     null, --p_trx_header_tbl(i).CREDIT_METHOD_FOR_RULES,
	     null, --p_trx_header_tbl(i).CREDIT_METHOD_FOR_INSTALLMENTS,
	     p_trx_header_tbl(i).RECEIPT_METHOD_ID,
             p_trx_header_tbl(i).RELATED_CUSTOMER_TRX_ID,
             p_trx_header_tbl(i).agreement_id,
	     p_trx_header_tbl(i).SHIP_VIA,
	     p_trx_header_tbl(i).SHIP_DATE_ACTUAL,
	     p_trx_header_tbl(i).WAYBILL_NUMBER,
	     p_trx_header_tbl(i).FOB_POINT,
	     p_trx_header_tbl(i).CUSTOMER_BANK_ACCOUNT_ID,
	     null, -- p_trx_header_tbl(i).DEFAULT_USSGL_TRX_CODE_CONTEXT,
	     p_trx_header_tbl(i).DEFAULT_USSGL_TRANSACTION_CODE,
             null, -- p_trx_header_tbl(i).RECURRED_FROM_TRX_NUMBER,
             p_trx_header_tbl(i).STATUS_TRX,
	     p_trx_header_tbl(i).PAYING_CUSTOMER_ID,
	     p_trx_header_tbl(i).PAYING_SITE_USE_ID,
	     p_trx_header_tbl(i).DEFAULT_TAX_EXEMPT_FLAG,
             null, -- p_trx_header_tbl(i).MRC_EXCHANGE_RATE_TYPE,
             null, -- p_trx_header_tbl(i).MRC_EXCHANGE_DATE,
             null, -- p_trx_header_tbl(i).MRC_EXCHANGE_RATE,
             null, -- p_trx_header_tbl(i).doc_sequence_id,
             p_trx_header_tbl(i).doc_sequence_value,
             p_trx_header_tbl(i).attribute_category,
             p_trx_header_tbl(i).attribute1,
             p_trx_header_tbl(i).attribute2,
             p_trx_header_tbl(i).attribute3,
             p_trx_header_tbl(i).attribute4,
             p_trx_header_tbl(i).attribute5,
             p_trx_header_tbl(i).attribute6,
             p_trx_header_tbl(i).attribute7,
             p_trx_header_tbl(i).attribute8,
             p_trx_header_tbl(i).attribute9,
             p_trx_header_tbl(i).attribute10,
             p_trx_header_tbl(i).attribute11,
             p_trx_header_tbl(i).attribute12,
             p_trx_header_tbl(i).attribute13,
             p_trx_header_tbl(i).attribute14,
             p_trx_header_tbl(i).attribute15,
             p_trx_header_tbl(i).global_attribute_category,
             p_trx_header_tbl(i).global_attribute1,
             p_trx_header_tbl(i).global_attribute2,
             p_trx_header_tbl(i).global_attribute3,
             p_trx_header_tbl(i).global_attribute4,
             p_trx_header_tbl(i).global_attribute5,
             p_trx_header_tbl(i).global_attribute6,
             p_trx_header_tbl(i).global_attribute7,
             p_trx_header_tbl(i).global_attribute8,
             p_trx_header_tbl(i).global_attribute9,
             p_trx_header_tbl(i).global_attribute10,
             p_trx_header_tbl(i).global_attribute11,
             p_trx_header_tbl(i).global_attribute12,
             p_trx_header_tbl(i).global_attribute13,
             p_trx_header_tbl(i).global_attribute14,
             p_trx_header_tbl(i).global_attribute15,
             p_trx_header_tbl(i).global_attribute16,
             p_trx_header_tbl(i).global_attribute17,
             p_trx_header_tbl(i).global_attribute18,
             p_trx_header_tbl(i).global_attribute19,
             p_trx_header_tbl(i).global_attribute20,
             p_trx_header_tbl(i).global_attribute21,
             p_trx_header_tbl(i).global_attribute22,
             p_trx_header_tbl(i).global_attribute23,
             p_trx_header_tbl(i).global_attribute24,
             p_trx_header_tbl(i).global_attribute25,
             p_trx_header_tbl(i).global_attribute26,
             p_trx_header_tbl(i).global_attribute27,
             p_trx_header_tbl(i).global_attribute28,
             p_trx_header_tbl(i).global_attribute29,
             p_trx_header_tbl(i).global_attribute30,
             p_trx_header_tbl(i).interface_header_context,
             p_trx_header_tbl(i).interface_header_attribute1,
             p_trx_header_tbl(i).interface_header_attribute2,
             p_trx_header_tbl(i).interface_header_attribute3,
             p_trx_header_tbl(i).interface_header_attribute4,
             p_trx_header_tbl(i).interface_header_attribute5,
             p_trx_header_tbl(i).interface_header_attribute6,
             p_trx_header_tbl(i).interface_header_attribute7,
             p_trx_header_tbl(i).interface_header_attribute8,
             p_trx_header_tbl(i).interface_header_attribute9,
             p_trx_header_tbl(i).interface_header_attribute10,
             p_trx_header_tbl(i).interface_header_attribute11,
             p_trx_header_tbl(i).interface_header_attribute12,
             p_trx_header_tbl(i).interface_header_attribute13,
             p_trx_header_tbl(i).interface_header_attribute14,
             p_trx_header_tbl(i).interface_header_attribute15,
             p_trx_header_tbl(i).legal_entity_id,
             p_trx_header_tbl(i).payment_trxn_extension_id,
             p_trx_header_tbl(i).billing_date,
             p_trx_header_tbl(i).interest_header_id,
             p_trx_header_tbl(i).late_charges_assessed,
             AR_INVOICE_TABLE_HANDLER.g_batch_id,                 -- 5921925
             AR_INVOICE_TABLE_HANDLER.g_request_id,               -- 5921925
             DECODE(trunc(p_trx_header_tbl(i).gl_date),NULL, DECODE(p_batch_source_rec.default_date,NULL,'Y','N'),'N'),

             p_trx_header_tbl(i).document_sub_type,
             p_trx_header_tbl(i).default_taxation_country,
	     p_trx_header_tbl(i).mandate_last_trx_flag );

   arp_util.debug ( 'insert header ' || (p_trx_header_tbl(i).trx_header_id) );
   arp_util.debug ( 'insert header PMT' || (p_trx_header_tbl(i).payment_trxn_extension_id) );
    END LOOP;




    IF pg_debug = 'Y'
    THEN
        ar_invoice_utils.debug ('AR_TRX_GLOBAL_PROCESS_HEADER.INERT_ROW(-)');
    END IF;
    EXCEPTION
       WHEN OTHERS THEN
         x_errmsg := 'Error in AR_TRX_GLOBAL_PROCESS_HEADER.INERT_ROW '||
           sqlerrm;
           x_return_status := FND_API.G_RET_STS_UNEXP_ERROR;
           RETURN;

END INSERT_ROW;

END AR_TRX_GLOBAL_PROCESS_HEADER;

/
