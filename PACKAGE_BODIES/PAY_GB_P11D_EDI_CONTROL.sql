--------------------------------------------------------
--  DDL for Package Body PAY_GB_P11D_EDI_CONTROL
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."PAY_GB_P11D_EDI_CONTROL" AS
/* $Header: pygbp11dc.pkb 120.5 2008/02/13 12:26:44 parusi noship $ */
  g_package   CONSTANT VARCHAR2(50) := 'pay_gb_p11d_edi_control.';

  function  get_header(p_sender_id         in     varchar2,
                       p_transmission_date in     varchar2,
                       p_test_transmission in     varchar2,
                       p_unique_reference  in     varchar2,
                       p_tax_year          in     varchar2,
                       p_missing_val       in out NoCopy number,
                       p_error_count       in out NoCopy number,
                       p_error_msg1        out NoCopy varchar2,
                       p_error_msg2        out NoCopy varchar2,
                       p_error_msg3        out NoCopy varchar2,
                       p_error_msg4        out NoCopy varchar2,
                       p_error_msg5        out NoCopy varchar2,
                       p_error_msg6        out NoCopy varchar2,
                       p_edi_rec1          out NoCopy varchar2,
                       p_edi_rec2          out NoCopy varchar2,
                       p_edi_rec3          out NoCopy varchar2,
                       p_edi_rec4          out NoCopy varchar2,
                       p_edi_rec5          out NoCopy varchar2,
                       p_edi_rec6          out NoCopy varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_header';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_header(p_sender_id         => p_sender_id,
                                                 p_transmission_date => p_transmission_date,
                                                 p_test_transmission => p_test_transmission,
                                                 p_unique_reference  => p_unique_reference,
                                                 p_tax_year          => p_tax_year,
                                                 p_missing_val       => p_missing_val,
                                                 p_error_count       => p_error_count,
                                                 p_error_msg         => p_error_msg1,
                                                 p_edi_rec1          => p_edi_rec1,
                                                 p_edi_rec2          => p_edi_rec2,
                                                 p_edi_rec3          => p_edi_rec3,
                                                 p_edi_rec4          => p_edi_rec4,
                                                 p_edi_rec5          => p_edi_rec5,
                                                 p_edi_rec6          => p_edi_rec6);
       elsif to_number(p_tax_year) =  2006 or to_number(p_tax_year) = 2007 then
             return pay_gb_p11d_edi_2006.get_header(p_sender_id         => p_sender_id,
                                                 p_transmission_date => p_transmission_date,
                                                 p_test_transmission => p_test_transmission,
                                                 p_unique_reference  => p_unique_reference,
                                                 p_tax_year          => p_tax_year,
                                                 p_missing_val       => p_missing_val,
                                                 p_error_count       => p_error_count,
                                                 p_error_msg1        => p_error_msg1,
                                                 p_error_msg2        => p_error_msg2,
                                                 p_error_msg3        => p_error_msg3,
                                                 p_error_msg4        => p_error_msg4,
                                                 p_error_msg5        => p_error_msg5,
                                                 p_error_msg6        => p_error_msg6,
                                                 p_edi_rec1          => p_edi_rec1,
                                                 p_edi_rec2          => p_edi_rec2,
                                                 p_edi_rec3          => p_edi_rec3,
                                                 p_edi_rec4          => p_edi_rec4,
                                                 p_edi_rec5          => p_edi_rec5,
                                                 p_edi_rec6          => p_edi_rec6);
         else
            return pay_gb_p11d_edi_2008.get_header(p_sender_id         => p_sender_id,
                                                 p_transmission_date => p_transmission_date,
                                                 p_test_transmission => p_test_transmission,
                                                 p_unique_reference  => p_unique_reference,
                                                 p_tax_year          => p_tax_year,
                                                 p_missing_val       => p_missing_val,
                                                 p_error_count       => p_error_count,
                                                 p_error_msg1        => p_error_msg1,
                                                 p_error_msg2        => p_error_msg2,
                                                 p_error_msg3        => p_error_msg3,
                                                 p_error_msg4        => p_error_msg4,
                                                 p_error_msg5        => p_error_msg5,
                                                 p_error_msg6        => p_error_msg6,
                                                 p_edi_rec1          => p_edi_rec1,
                                                 p_edi_rec2          => p_edi_rec2,
                                                 p_edi_rec3          => p_edi_rec3,
                                                 p_edi_rec4          => p_edi_rec4,
                                                 p_edi_rec5          => p_edi_rec5,
                                                 p_edi_rec6          => p_edi_rec6);
       end if;
       return 0;
  end;

  function  get_employer(p_tax_office_name  in     varchar2,
                         p_tax_phone_no     in     varchar2,
                         p_employer_ref     in     varchar2,
                         p_employer_name    in     varchar2,
                         p_employer_addr    in     varchar2,
                         p_submitter_ref    in     varchar2,
                         p_message_date     in     varchar2,
                         p_tax_year         in     varchar2,
                         p_party            in     varchar2,
                         p_error_count      in out NoCopy number,
                         p_error_msg1       out NoCopy varchar2,
                         p_error_msg2       out NoCopy varchar2,
                         p_error_msg3       out NoCopy varchar2,
                         p_error_msg4       out NoCopy varchar2,
                         p_error_msg5       out NoCopy varchar2,
                         p_error_msg6       out NoCopy varchar2,
                         p_error_msg7       out NoCopy varchar2,
                         p_error_msg8       out NoCopy varchar2,
                         p_error_msg9       out NoCopy varchar2,
                         p_edi_rec1         out NoCopy varchar2,
                         p_edi_rec2         out NoCopy varchar2,
                         p_edi_rec3         out NoCopy varchar2,
                         p_edi_rec4         out NoCopy varchar2,
                         p_edi_rec5         out NoCopy varchar2,
                         p_edi_rec6         out NoCopy varchar2,
                         p_edi_rec7         out NoCopy varchar2,
                         p_edi_rec8         out NoCopy varchar2,
                         p_edi_rec9         out NoCopy varchar2,
                         p_edi_rec10        out NoCopy varchar2,
                         p_edi_rec11        out NoCopy varchar2,
                         p_edi_rec12        out NoCopy varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_employer';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_employer(p_tax_office_name   => p_tax_office_name,
                                                   p_tax_phone_no      => p_tax_phone_no,
                                                   p_employer_ref      => p_employer_ref,
                                                   p_employer_name     => p_employer_name,
                                                   p_employer_addr     => p_employer_addr,
                                                   p_submitter_ref     => p_submitter_ref,
                                                   p_message_date      => p_message_date,
                                                   p_tax_year          => p_tax_year,
                                                   p_party             => p_party,
                                                   p_error_count       => p_error_count,
                                                   p_error_msg1        => p_error_msg1,
                                                   p_error_msg2        => p_error_msg2,
                                                   p_error_msg3        => p_error_msg3,
                                                   p_edi_rec1          => p_edi_rec1,
                                                   p_edi_rec2          => p_edi_rec2,
                                                   p_edi_rec3          => p_edi_rec3,
                                                   p_edi_rec4          => p_edi_rec4,
                                                   p_edi_rec5          => p_edi_rec5,
                                                   p_edi_rec6          => p_edi_rec6,
                                                   p_edi_rec7          => p_edi_rec7,
                                                   p_edi_rec8          => p_edi_rec8,
                                                   p_edi_rec9          => p_edi_rec9,
                                                   p_edi_rec10         => p_edi_rec10,
                                                   p_edi_rec11         => p_edi_rec11,
                                                   p_edi_rec12         => p_edi_rec12);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.get_employer(p_tax_office_name   => p_tax_office_name,
                                                   p_tax_phone_no      => p_tax_phone_no,
                                                   p_employer_ref      => p_employer_ref,
                                                   p_employer_name     => p_employer_name,
                                                   p_employer_addr     => p_employer_addr,
                                                   p_submitter_ref     => p_submitter_ref,
                                                   p_message_date      => p_message_date,
                                                   p_tax_year          => p_tax_year,
                                                   p_party             => p_party,
                                                   p_error_count       => p_error_count,
                                                   p_error_msg1        => p_error_msg1,
                                                   p_error_msg2        => p_error_msg2,
                                                   p_error_msg3        => p_error_msg3,
                                                   p_error_msg4        => p_error_msg4,
                                                   p_error_msg5        => p_error_msg5,
                                                   p_error_msg6        => p_error_msg6,
                                                   p_error_msg7        => p_error_msg7,
                                                   p_error_msg8        => p_error_msg8,
                                                   p_error_msg9        => p_error_msg9,
                                                   p_edi_rec1          => p_edi_rec1,
                                                   p_edi_rec2          => p_edi_rec2,
                                                   p_edi_rec3          => p_edi_rec3,
                                                   p_edi_rec4          => p_edi_rec4,
                                                   p_edi_rec5          => p_edi_rec5,
                                                   p_edi_rec6          => p_edi_rec6,
                                                   p_edi_rec7          => p_edi_rec7,
                                                   p_edi_rec8          => p_edi_rec8,
                                                   p_edi_rec9          => p_edi_rec9,
                                                   p_edi_rec10         => p_edi_rec10,
                                                   p_edi_rec11         => p_edi_rec11,
                                                   p_edi_rec12         => p_edi_rec12);
        else
            return pay_gb_p11d_edi_2008.get_employer(p_tax_office_name   => p_tax_office_name,
                                                   p_tax_phone_no      => p_tax_phone_no,
                                                   p_employer_ref      => p_employer_ref,
                                                   p_employer_name     => p_employer_name,
                                                   p_employer_addr     => p_employer_addr,
                                                   p_submitter_ref     => p_submitter_ref,
                                                   p_message_date      => p_message_date,
                                                   p_tax_year          => p_tax_year,
                                                   p_party             => p_party,
                                                   p_error_count       => p_error_count,
                                                   p_error_msg1        => p_error_msg1,
                                                   p_error_msg2        => p_error_msg2,
                                                   p_error_msg3        => p_error_msg3,
                                                   p_error_msg4        => p_error_msg4,
                                                   p_error_msg5        => p_error_msg5,
                                                   p_error_msg6        => p_error_msg6,
                                                   p_error_msg7        => p_error_msg7,
                                                   p_error_msg8        => p_error_msg8,
                                                   p_error_msg9        => p_error_msg9,
                                                   p_edi_rec1          => p_edi_rec1,
                                                   p_edi_rec2          => p_edi_rec2,
                                                   p_edi_rec3          => p_edi_rec3,
                                                   p_edi_rec4          => p_edi_rec4,
                                                   p_edi_rec5          => p_edi_rec5,
                                                   p_edi_rec6          => p_edi_rec6,
                                                   p_edi_rec7          => p_edi_rec7,
                                                   p_edi_rec8          => p_edi_rec8,
                                                   p_edi_rec9          => p_edi_rec9,
                                                   p_edi_rec10         => p_edi_rec10,
                                                   p_edi_rec11         => p_edi_rec11,
                                                   p_edi_rec12         => p_edi_rec12);
       end if;
       return 0;
  end;

  function  get_employee(p_person_id     in         varchar2,
                         p_pact_id       in         varchar2,
                         p_tax_year      in         varchar2,
                         p_error_count   in out NoCopy number,
                         p_error_msg1    out NoCopy varchar2,
                         p_error_msg2    out NoCopy varchar2,
                         p_error_msg3    out NoCopy varchar2,
                         p_error_msg4    out NoCopy varchar2,
                         p_error_msg5    out NoCopy varchar2,
                         p_error_msg6    out NoCopy varchar2,
                         p_error_msg7    out NoCopy varchar2,
                         p_error_msg8    out NoCopy varchar2,
                         p_edi_rec1      out NoCopy varchar2,
                         p_edi_rec2      out NoCopy varchar2,
                         p_edi_rec3      out NoCopy varchar2,
                         p_edi_rec4      out NoCopy varchar2,
                         p_edi_rec5      out NoCopy varchar2,
                         p_edi_rec6      out NoCopy varchar2,
                         p_edi_rec7      out NoCopy varchar2,
                         p_edi_rec8      out NoCopy varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_employee';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_employee(p_person_id         => p_person_id,
                                                   p_pact_id           => p_pact_id,
                                                   p_error_count       => p_error_count,
                                                   p_error_msg1        => p_error_msg1,
                                                   p_error_msg2        => p_error_msg2,
                                                   p_error_msg3        => p_error_msg3,
                                                   p_error_msg4        => p_error_msg4,
                                                   p_error_msg5        => p_error_msg5,
                                                   p_error_msg6        => p_error_msg6,
                                                   p_error_msg7        => p_error_msg7,
                                                   p_error_msg8        => p_error_msg8,
                                                   p_edi_rec1          => p_edi_rec1,
                                                   p_edi_rec2          => p_edi_rec2,
                                                   p_edi_rec3          => p_edi_rec3,
                                                   p_edi_rec4          => p_edi_rec4,
                                                   p_edi_rec5          => p_edi_rec5,
                                                   p_edi_rec6          => p_edi_rec6,
                                                   p_edi_rec7          => p_edi_rec7,
                                                   p_edi_rec8          => p_edi_rec8);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.get_employee(p_person_id         => p_person_id,
                                                   p_pact_id           => p_pact_id,
                                                   p_error_count       => p_error_count,
                                                   p_error_msg1        => p_error_msg1,
                                                   p_error_msg2        => p_error_msg2,
                                                   p_error_msg3        => p_error_msg3,
                                                   p_error_msg4        => p_error_msg4,
                                                   p_error_msg5        => p_error_msg5,
                                                   p_error_msg6        => p_error_msg6,
                                                   p_error_msg7        => p_error_msg7,
                                                   p_error_msg8        => p_error_msg8,
                                                   p_edi_rec1          => p_edi_rec1,
                                                   p_edi_rec2          => p_edi_rec2,
                                                   p_edi_rec3          => p_edi_rec3,
                                                   p_edi_rec4          => p_edi_rec4,
                                                   p_edi_rec5          => p_edi_rec5,
                                                   p_edi_rec6          => p_edi_rec6,
                                                   p_edi_rec7          => p_edi_rec7,
                                                   p_edi_rec8          => p_edi_rec8);
         else
             return pay_gb_p11d_edi_2008.get_employee(p_person_id         => p_person_id,
                                                   p_pact_id           => p_pact_id,
                                                   p_error_count       => p_error_count,
                                                   p_error_msg1        => p_error_msg1,
                                                   p_error_msg2        => p_error_msg2,
                                                   p_error_msg3        => p_error_msg3,
                                                   p_error_msg4        => p_error_msg4,
                                                   p_error_msg5        => p_error_msg5,
                                                   p_error_msg6        => p_error_msg6,
                                                   p_error_msg7        => p_error_msg7,
                                                   p_error_msg8        => p_error_msg8,
                                                   p_edi_rec1          => p_edi_rec1,
                                                   p_edi_rec2          => p_edi_rec2,
                                                   p_edi_rec3          => p_edi_rec3,
                                                   p_edi_rec4          => p_edi_rec4,
                                                   p_edi_rec5          => p_edi_rec5,
                                                   p_edi_rec6          => p_edi_rec6,
                                                   p_edi_rec7          => p_edi_rec7,
                                                   p_edi_rec8          => p_edi_rec8);

       end if;
       return 0;
  end;

  function  get_benefit(p_benefit_type  in  varchar2,
                        p_person_id     in  varchar2,
                        p_employer_ref  in  varchar2,
                        p_tax_year      in  varchar2,
                        p_benefit_count in  varchar2,
                        p_pact_id       in  varchar2,
                        p_value1        in out NoCopy varchar2,
                        p_value2        in out NoCopy varchar2,
                        p_value3        in out NoCopy varchar2,
                        p_value4        in out NoCopy varchar2,
                        p_value5        in out NoCopy varchar2,
                        p_value6        in out NoCopy varchar2,
                        p_value7        in out NoCopy varchar2,
                        p_value8        in out NoCopy varchar2,
                        p_value9        in out NoCopy varchar2,
                        p_value10       in out NoCopy varchar2,
                        p_value11       in out NoCopy varchar2,
                        p_value12       in out NoCopy varchar2,
                        p_value13       in out NoCopy varchar2,
                        p_value14       in out NoCopy varchar2,
                        p_value15       in out NoCopy varchar2,
                        p_value16       in out NoCopy varchar2,
                        p_value17       in out NoCopy varchar2,
                        p_value18       in out NoCopy varchar2,
                        p_value19       in out NoCopy varchar2,
                        p_value20       in out NoCopy varchar2,
                        p_value21       in out NoCopy varchar2,
                        p_value22       in out NoCopy varchar2,
                        p_value23       in out NoCopy varchar2,
                        p_value24       in out NoCopy varchar2,
                        p_value25       in out NoCopy varchar2,
                        p_value26       in out NoCopy varchar2,
                        p_value27       in out NoCopy varchar2,
                        p_value28       in out NoCopy varchar2,
                        p_value29       in out NoCopy varchar2,
                        p_value30       in out NoCopy varchar2,
                        p_edi_rec1      out NoCopy varchar2,
                        p_edi_rec2      out NoCopy varchar2,
                        p_edi_rec3      out NoCopy varchar2,
                        p_edi_rec4      out NoCopy varchar2,
                        p_edi_rec5      out NoCopy varchar2,
                        p_edi_rec6      out NoCopy varchar2,
                        p_edi_rec7      out NoCopy varchar2,
                        p_edi_rec8      out NoCopy varchar2,
                        p_edi_rec9      out NoCopy varchar2,
                        p_edi_rec10     out NoCopy varchar2,
                        p_edi_rec11     out NoCopy varchar2,
                        p_edi_rec12     out NoCopy varchar2,
                        p_edi_rec13     out NoCopy varchar2,
                        p_edi_rec14     out NoCopy varchar2,
                        p_edi_rec15     out NoCopy varchar2,
                        p_edi_rec16     out NoCopy varchar2,
                        p_edi_rec17     out NoCopy varchar2,
                        p_edi_rec18     out NoCopy varchar2,
                        p_edi_rec19     out NoCopy varchar2,
                        p_edi_rec20     out NoCopy varchar2,
                        p_edi_rec21     out NoCopy varchar2,
                        p_edi_rec22     out NoCopy varchar2,
                        p_edi_rec23     out NoCopy varchar2,
                        p_edi_rec24     out NoCopy varchar2,
                        p_edi_rec25     out NoCopy varchar2,
                        p_edi_rec26     out NoCopy varchar2,
                        p_edi_rec27     out NoCopy varchar2,
                        p_edi_rec28     out NoCopy varchar2,
                        p_edi_rec29     out NoCopy varchar2,
                        p_edi_rec30     out NoCopy varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_benefit';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_benefit(p_benefit_type  =>  p_benefit_type,
                                                  p_person_id     =>  p_person_id,
                                                  p_employer_ref  =>  p_employer_ref,
                                                  p_tax_year      =>  p_tax_year,
                                                  p_benefit_count =>  p_benefit_count,
                                                  p_pact_id       =>  p_pact_id,
                                                  p_value1        =>  p_value1,
                                                  p_value2        =>  p_value2,
                                                  p_value3        =>  p_value3,
                                                  p_value4        =>  p_value4,
                                                  p_value5        =>  p_value5,
                                                  p_value6        =>  p_value6,
                                                  p_value7        =>  p_value7,
                                                  p_value8        =>  p_value8,
                                                  p_value9        =>  p_value9,
                                                  p_value10       =>  p_value10,
                                                  p_value11       =>  p_value11,
                                                  p_value12       =>  p_value12,
                                                  p_value13       =>  p_value13,
                                                  p_value14       =>  p_value14,
                                                  p_value15       =>  p_value15,
                                                  p_value16       =>  p_value16,
                                                  p_value17       =>  p_value17,
                                                  p_value18       =>  p_value18,
                                                  p_value19       =>  p_value19,
                                                  p_value20       =>  p_value20,
                                                  p_value21       =>  p_value21,
                                                  p_value22       =>  p_value22,
                                                  p_value23       =>  p_value23,
                                                  p_value24       =>  p_value24,
                                                  p_value25       =>  p_value25,
                                                  p_value26       =>  p_value26,
                                                  p_value27       =>  p_value27,
                                                  p_value28       =>  p_value28,
                                                  p_value29       =>  p_value29,
                                                  p_value30       =>  p_value30,
                                                  p_edi_rec1      =>  p_edi_rec1,
                                                  p_edi_rec2      =>  p_edi_rec2,
                                                  p_edi_rec3      =>  p_edi_rec3,
                                                  p_edi_rec4      =>  p_edi_rec4,
                                                  p_edi_rec5      =>  p_edi_rec5,
                                                  p_edi_rec6      =>  p_edi_rec6,
                                                  p_edi_rec7      =>  p_edi_rec7,
                                                  p_edi_rec8      =>  p_edi_rec8,
                                                  p_edi_rec9      =>  p_edi_rec9,
                                                  p_edi_rec10     =>  p_edi_rec10,
                                                  p_edi_rec11     =>  p_edi_rec11,
                                                  p_edi_rec12     =>  p_edi_rec12,
                                                  p_edi_rec13     =>  p_edi_rec13,
                                                  p_edi_rec14     =>  p_edi_rec14,
                                                  p_edi_rec15     =>  p_edi_rec15,
                                                  p_edi_rec16     =>  p_edi_rec16,
                                                  p_edi_rec17     =>  p_edi_rec17,
                                                  p_edi_rec18     =>  p_edi_rec18,
                                                  p_edi_rec19     =>  p_edi_rec19,
                                                  p_edi_rec20     =>  p_edi_rec20,
                                                  p_edi_rec21     =>  p_edi_rec21,
                                                  p_edi_rec22     =>  p_edi_rec22,
                                                  p_edi_rec23     =>  p_edi_rec23,
                                                  p_edi_rec24     =>  p_edi_rec24,
                                                  p_edi_rec25     =>  p_edi_rec25,
                                                  p_edi_rec26     =>  p_edi_rec26,
                                                  p_edi_rec27     =>  p_edi_rec27,
                                                  p_edi_rec28     =>  p_edi_rec28,
                                                  p_edi_rec29     =>  p_edi_rec29,
                                                  p_edi_rec30     =>  p_edi_rec30);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.get_benefit(p_benefit_type  =>  p_benefit_type,
                                                  p_person_id     =>  p_person_id,
                                                  p_employer_ref  =>  p_employer_ref,
                                                  p_tax_year      =>  p_tax_year,
                                                  p_benefit_count =>  p_benefit_count,
                                                  p_pact_id       =>  p_pact_id,
                                                  p_value1        =>  p_value1,
                                                  p_value2        =>  p_value2,
                                                  p_value3        =>  p_value3,
                                                  p_value4        =>  p_value4,
                                                  p_value5        =>  p_value5,
                                                  p_value6        =>  p_value6,
                                                  p_value7        =>  p_value7,
                                                  p_value8        =>  p_value8,
                                                  p_value9        =>  p_value9,
                                                  p_value10       =>  p_value10,
                                                  p_value11       =>  p_value11,
                                                  p_value12       =>  p_value12,
                                                  p_value13       =>  p_value13,
                                                  p_value14       =>  p_value14,
                                                  p_value15       =>  p_value15,
                                                  p_value16       =>  p_value16,
                                                  p_value17       =>  p_value17,
                                                  p_value18       =>  p_value18,
                                                  p_value19       =>  p_value19,
                                                  p_value20       =>  p_value20,
                                                  p_value21       =>  p_value21,
                                                  p_value22       =>  p_value22,
                                                  p_value23       =>  p_value23,
                                                  p_value24       =>  p_value24,
                                                  p_value25       =>  p_value25,
                                                  p_value26       =>  p_value26,
                                                  p_value27       =>  p_value27,
                                                  p_value28       =>  p_value28,
                                                  p_value29       =>  p_value29,
                                                  p_value30       =>  p_value30,
                                                  p_edi_rec1      =>  p_edi_rec1,
                                                  p_edi_rec2      =>  p_edi_rec2,
                                                  p_edi_rec3      =>  p_edi_rec3,
                                                  p_edi_rec4      =>  p_edi_rec4,
                                                  p_edi_rec5      =>  p_edi_rec5,
                                                  p_edi_rec6      =>  p_edi_rec6,
                                                  p_edi_rec7      =>  p_edi_rec7,
                                                  p_edi_rec8      =>  p_edi_rec8,
                                                  p_edi_rec9      =>  p_edi_rec9,
                                                  p_edi_rec10     =>  p_edi_rec10,
                                                  p_edi_rec11     =>  p_edi_rec11,
                                                  p_edi_rec12     =>  p_edi_rec12,
                                                  p_edi_rec13     =>  p_edi_rec13,
                                                  p_edi_rec14     =>  p_edi_rec14,
                                                  p_edi_rec15     =>  p_edi_rec15,
                                                  p_edi_rec16     =>  p_edi_rec16,
                                                  p_edi_rec17     =>  p_edi_rec17,
                                                  p_edi_rec18     =>  p_edi_rec18,
                                                  p_edi_rec19     =>  p_edi_rec19,
                                                  p_edi_rec20     =>  p_edi_rec20,
                                                  p_edi_rec21     =>  p_edi_rec21,
                                                  p_edi_rec22     =>  p_edi_rec22,
                                                  p_edi_rec23     =>  p_edi_rec23,
                                                  p_edi_rec24     =>  p_edi_rec24,
                                                  p_edi_rec25     =>  p_edi_rec25,
                                                  p_edi_rec26     =>  p_edi_rec26,
                                                  p_edi_rec27     =>  p_edi_rec27,
                                                  p_edi_rec28     =>  p_edi_rec28,
                                                  p_edi_rec29     =>  p_edi_rec29,
                                                  p_edi_rec30     =>  p_edi_rec30);
       else
          return pay_gb_p11d_edi_2008.get_benefit(p_benefit_type  =>  p_benefit_type,
                                                  p_person_id     =>  p_person_id,
                                                  p_employer_ref  =>  p_employer_ref,
                                                  p_tax_year      =>  p_tax_year,
                                                  p_benefit_count =>  p_benefit_count,
                                                  p_pact_id       =>  p_pact_id,
                                                  p_value1        =>  p_value1,
                                                  p_value2        =>  p_value2,
                                                  p_value3        =>  p_value3,
                                                  p_value4        =>  p_value4,
                                                  p_value5        =>  p_value5,
                                                  p_value6        =>  p_value6,
                                                  p_value7        =>  p_value7,
                                                  p_value8        =>  p_value8,
                                                  p_value9        =>  p_value9,
                                                  p_value10       =>  p_value10,
                                                  p_value11       =>  p_value11,
                                                  p_value12       =>  p_value12,
                                                  p_value13       =>  p_value13,
                                                  p_value14       =>  p_value14,
                                                  p_value15       =>  p_value15,
                                                  p_value16       =>  p_value16,
                                                  p_value17       =>  p_value17,
                                                  p_value18       =>  p_value18,
                                                  p_value19       =>  p_value19,
                                                  p_value20       =>  p_value20,
                                                  p_value21       =>  p_value21,
                                                  p_value22       =>  p_value22,
                                                  p_value23       =>  p_value23,
                                                  p_value24       =>  p_value24,
                                                  p_value25       =>  p_value25,
                                                  p_value26       =>  p_value26,
                                                  p_value27       =>  p_value27,
                                                  p_value28       =>  p_value28,
                                                  p_value29       =>  p_value29,
                                                  p_value30       =>  p_value30,
                                                  p_edi_rec1      =>  p_edi_rec1,
                                                  p_edi_rec2      =>  p_edi_rec2,
                                                  p_edi_rec3      =>  p_edi_rec3,
                                                  p_edi_rec4      =>  p_edi_rec4,
                                                  p_edi_rec5      =>  p_edi_rec5,
                                                  p_edi_rec6      =>  p_edi_rec6,
                                                  p_edi_rec7      =>  p_edi_rec7,
                                                  p_edi_rec8      =>  p_edi_rec8,
                                                  p_edi_rec9      =>  p_edi_rec9,
                                                  p_edi_rec10     =>  p_edi_rec10,
                                                  p_edi_rec11     =>  p_edi_rec11,
                                                  p_edi_rec12     =>  p_edi_rec12,
                                                  p_edi_rec13     =>  p_edi_rec13,
                                                  p_edi_rec14     =>  p_edi_rec14,
                                                  p_edi_rec15     =>  p_edi_rec15,
                                                  p_edi_rec16     =>  p_edi_rec16,
                                                  p_edi_rec17     =>  p_edi_rec17,
                                                  p_edi_rec18     =>  p_edi_rec18,
                                                  p_edi_rec19     =>  p_edi_rec19,
                                                  p_edi_rec20     =>  p_edi_rec20,
                                                  p_edi_rec21     =>  p_edi_rec21,
                                                  p_edi_rec22     =>  p_edi_rec22,
                                                  p_edi_rec23     =>  p_edi_rec23,
                                                  p_edi_rec24     =>  p_edi_rec24,
                                                  p_edi_rec25     =>  p_edi_rec25,
                                                  p_edi_rec26     =>  p_edi_rec26,
                                                  p_edi_rec27     =>  p_edi_rec27,
                                                  p_edi_rec28     =>  p_edi_rec28,
                                                  p_edi_rec29     =>  p_edi_rec29,
                                                  p_edi_rec30     =>  p_edi_rec30);

       end if;
       return 0;
  end;

  function  get_summary(p_benefit_type  in varchar2,
                        p_tax_year      in varchar2,
                        p_value1        in varchar2,
                        p_value2        in varchar2,
                        p_value3        in varchar2,
                        p_value4        in varchar2,
                        p_value5        in varchar2,
                        p_value6        in varchar2,
                        p_value7        in varchar2,
                        p_value8        in varchar2,
                        p_value9        in varchar2,
                        p_value10       in varchar2,
                        p_value11       in varchar2,
                        p_value12       in varchar2,
                        p_value13       in varchar2,
                        p_value14       in varchar2,
                        p_value15       in varchar2,
                        p_value16       in varchar2,
                        p_value17       in varchar2,
                        p_value18       in varchar2,
                        p_value19       in varchar2,
                        p_value20       in varchar2,
                        p_value21       in varchar2,
                        p_value22       in varchar2,
                        p_value23       in varchar2,
                        p_value24       in varchar2,
                        p_value25       in varchar2,
                        p_value26       in varchar2,
                        p_value27       in varchar2,
                        p_value28       in varchar2,
                        p_value29       in varchar2,
                        p_value30       in varchar2,
                        p_edi_rec1      out NoCopy varchar2,
                        p_edi_rec2      out NoCopy varchar2,
                        p_edi_rec3      out NoCopy varchar2,
                        p_edi_rec4      out NoCopy varchar2,
                        p_edi_rec5      out NoCopy varchar2,
                        p_edi_rec6      out NoCopy varchar2,
                        p_edi_rec7      out NoCopy varchar2,
                        p_edi_rec8      out NoCopy varchar2,
                        p_edi_rec9      out NoCopy varchar2,
                        p_edi_rec10     out NoCopy varchar2,
                        p_edi_rec11     out NoCopy varchar2,
                        p_edi_rec12     out NoCopy varchar2,
                        p_edi_rec13     out NoCopy varchar2,
                        p_edi_rec14     out NoCopy varchar2,
                        p_edi_rec15     out NoCopy varchar2,
                        p_edi_rec16     out NoCopy varchar2,
                        p_edi_rec17     out NoCopy varchar2,
                        p_edi_rec18     out NoCopy varchar2,
                        p_edi_rec19     out NoCopy varchar2,
                        p_edi_rec20     out NoCopy varchar2,
                        p_edi_rec21     out NoCopy varchar2,
                        p_edi_rec22     out NoCopy varchar2,
                        p_edi_rec23     out NoCopy varchar2,
                        p_edi_rec24     out NoCopy varchar2,
                        p_edi_rec25     out NoCopy varchar2,
                        p_edi_rec26     out NoCopy varchar2,
                        p_edi_rec27     out NoCopy varchar2,
                        p_edi_rec28     out NoCopy varchar2,
                        p_edi_rec29     out NoCopy varchar2,
                        p_edi_rec30     out NoCopy varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_summary';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_summary(p_benefit_type  =>  p_benefit_type,
                                                  p_tax_year      =>  p_tax_year,
                                                  p_value1        =>  p_value1,
                                                  p_value2        =>  p_value2,
                                                  p_value3        =>  p_value3,
                                                  p_value4        =>  p_value4,
                                                  p_value5        =>  p_value5,
                                                  p_value6        =>  p_value6,
                                                  p_value7        =>  p_value7,
                                                  p_value8        =>  p_value8,
                                                  p_value9        =>  p_value9,
                                                  p_value10       =>  p_value10,
                                                  p_value11       =>  p_value11,
                                                  p_value12       =>  p_value12,
                                                  p_value13       =>  p_value13,
                                                  p_value14       =>  p_value14,
                                                  p_value15       =>  p_value15,
                                                  p_value16       =>  p_value16,
                                                  p_value17       =>  p_value17,
                                                  p_value18       =>  p_value18,
                                                  p_value19       =>  p_value19,
                                                  p_value20       =>  p_value20,
                                                  p_value21       =>  p_value21,
                                                  p_value22       =>  p_value22,
                                                  p_value23       =>  p_value23,
                                                  p_value24       =>  p_value24,
                                                  p_value25       =>  p_value25,
                                                  p_value26       =>  p_value26,
                                                  p_value27       =>  p_value27,
                                                  p_value28       =>  p_value28,
                                                  p_value29       =>  p_value29,
                                                  p_value30       =>  p_value30,
                                                  p_edi_rec1      =>  p_edi_rec1,
                                                  p_edi_rec2      =>  p_edi_rec2,
                                                  p_edi_rec3      =>  p_edi_rec3,
                                                  p_edi_rec4      =>  p_edi_rec4,
                                                  p_edi_rec5      =>  p_edi_rec5,
                                                  p_edi_rec6      =>  p_edi_rec6,
                                                  p_edi_rec7      =>  p_edi_rec7,
                                                  p_edi_rec8      =>  p_edi_rec8,
                                                  p_edi_rec9      =>  p_edi_rec9,
                                                  p_edi_rec10     =>  p_edi_rec10,
                                                  p_edi_rec11     =>  p_edi_rec11,
                                                  p_edi_rec12     =>  p_edi_rec12,
                                                  p_edi_rec13     =>  p_edi_rec13,
                                                  p_edi_rec14     =>  p_edi_rec14,
                                                  p_edi_rec15     =>  p_edi_rec15,
                                                  p_edi_rec16     =>  p_edi_rec16,
                                                  p_edi_rec17     =>  p_edi_rec17,
                                                  p_edi_rec18     =>  p_edi_rec18,
                                                  p_edi_rec19     =>  p_edi_rec19,
                                                  p_edi_rec20     =>  p_edi_rec20,
                                                  p_edi_rec21     =>  p_edi_rec21,
                                                  p_edi_rec22     =>  p_edi_rec22,
                                                  p_edi_rec23     =>  p_edi_rec23,
                                                  p_edi_rec24     =>  p_edi_rec24,
                                                  p_edi_rec25     =>  p_edi_rec25,
                                                  p_edi_rec26     =>  p_edi_rec26,
                                                  p_edi_rec27     =>  p_edi_rec27,
                                                  p_edi_rec28     =>  p_edi_rec28,
                                                  p_edi_rec29     =>  p_edi_rec29,
                                                  p_edi_rec30     =>  p_edi_rec30);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.get_summary(p_benefit_type  =>  p_benefit_type,
                                                  p_tax_year      =>  p_tax_year,
                                                  p_value1        =>  p_value1,
                                                  p_value2        =>  p_value2,
                                                  p_value3        =>  p_value3,
                                                  p_value4        =>  p_value4,
                                                  p_value5        =>  p_value5,
                                                  p_value6        =>  p_value6,
                                                  p_value7        =>  p_value7,
                                                  p_value8        =>  p_value8,
                                                  p_value9        =>  p_value9,
                                                  p_value10       =>  p_value10,
                                                  p_value11       =>  p_value11,
                                                  p_value12       =>  p_value12,
                                                  p_value13       =>  p_value13,
                                                  p_value14       =>  p_value14,
                                                  p_value15       =>  p_value15,
                                                  p_value16       =>  p_value16,
                                                  p_value17       =>  p_value17,
                                                  p_value18       =>  p_value18,
                                                  p_value19       =>  p_value19,
                                                  p_value20       =>  p_value20,
                                                  p_value21       =>  p_value21,
                                                  p_value22       =>  p_value22,
                                                  p_value23       =>  p_value23,
                                                  p_value24       =>  p_value24,
                                                  p_value25       =>  p_value25,
                                                  p_value26       =>  p_value26,
                                                  p_value27       =>  p_value27,
                                                  p_value28       =>  p_value28,
                                                  p_value29       =>  p_value29,
                                                  p_value30       =>  p_value30,
                                                  p_edi_rec1      =>  p_edi_rec1,
                                                  p_edi_rec2      =>  p_edi_rec2,
                                                  p_edi_rec3      =>  p_edi_rec3,
                                                  p_edi_rec4      =>  p_edi_rec4,
                                                  p_edi_rec5      =>  p_edi_rec5,
                                                  p_edi_rec6      =>  p_edi_rec6,
                                                  p_edi_rec7      =>  p_edi_rec7,
                                                  p_edi_rec8      =>  p_edi_rec8,
                                                  p_edi_rec9      =>  p_edi_rec9,
                                                  p_edi_rec10     =>  p_edi_rec10,
                                                  p_edi_rec11     =>  p_edi_rec11,
                                                  p_edi_rec12     =>  p_edi_rec12,
                                                  p_edi_rec13     =>  p_edi_rec13,
                                                  p_edi_rec14     =>  p_edi_rec14,
                                                  p_edi_rec15     =>  p_edi_rec15,
                                                  p_edi_rec16     =>  p_edi_rec16,
                                                  p_edi_rec17     =>  p_edi_rec17,
                                                  p_edi_rec18     =>  p_edi_rec18,
                                                  p_edi_rec19     =>  p_edi_rec19,
                                                  p_edi_rec20     =>  p_edi_rec20,
                                                  p_edi_rec21     =>  p_edi_rec21,
                                                  p_edi_rec22     =>  p_edi_rec22,
                                                  p_edi_rec23     =>  p_edi_rec23,
                                                  p_edi_rec24     =>  p_edi_rec24,
                                                  p_edi_rec25     =>  p_edi_rec25,
                                                  p_edi_rec26     =>  p_edi_rec26,
                                                  p_edi_rec27     =>  p_edi_rec27,
                                                  p_edi_rec28     =>  p_edi_rec28,
                                                  p_edi_rec29     =>  p_edi_rec29,
                                                  p_edi_rec30     =>  p_edi_rec30);
       else
          return pay_gb_p11d_edi_2008.get_summary(p_benefit_type  =>  p_benefit_type,
                                                  p_tax_year      =>  p_tax_year,
                                                  p_value1        =>  p_value1,
                                                  p_value2        =>  p_value2,
                                                  p_value3        =>  p_value3,
                                                  p_value4        =>  p_value4,
                                                  p_value5        =>  p_value5,
                                                  p_value6        =>  p_value6,
                                                  p_value7        =>  p_value7,
                                                  p_value8        =>  p_value8,
                                                  p_value9        =>  p_value9,
                                                  p_value10       =>  p_value10,
                                                  p_value11       =>  p_value11,
                                                  p_value12       =>  p_value12,
                                                  p_value13       =>  p_value13,
                                                  p_value14       =>  p_value14,
                                                  p_value15       =>  p_value15,
                                                  p_value16       =>  p_value16,
                                                  p_value17       =>  p_value17,
                                                  p_value18       =>  p_value18,
                                                  p_value19       =>  p_value19,
                                                  p_value20       =>  p_value20,
                                                  p_value21       =>  p_value21,
                                                  p_value22       =>  p_value22,
                                                  p_value23       =>  p_value23,
                                                  p_value24       =>  p_value24,
                                                  p_value25       =>  p_value25,
                                                  p_value26       =>  p_value26,
                                                  p_value27       =>  p_value27,
                                                  p_value28       =>  p_value28,
                                                  p_value29       =>  p_value29,
                                                  p_value30       =>  p_value30,
                                                  p_edi_rec1      =>  p_edi_rec1,
                                                  p_edi_rec2      =>  p_edi_rec2,
                                                  p_edi_rec3      =>  p_edi_rec3,
                                                  p_edi_rec4      =>  p_edi_rec4,
                                                  p_edi_rec5      =>  p_edi_rec5,
                                                  p_edi_rec6      =>  p_edi_rec6,
                                                  p_edi_rec7      =>  p_edi_rec7,
                                                  p_edi_rec8      =>  p_edi_rec8,
                                                  p_edi_rec9      =>  p_edi_rec9,
                                                  p_edi_rec10     =>  p_edi_rec10,
                                                  p_edi_rec11     =>  p_edi_rec11,
                                                  p_edi_rec12     =>  p_edi_rec12,
                                                  p_edi_rec13     =>  p_edi_rec13,
                                                  p_edi_rec14     =>  p_edi_rec14,
                                                  p_edi_rec15     =>  p_edi_rec15,
                                                  p_edi_rec16     =>  p_edi_rec16,
                                                  p_edi_rec17     =>  p_edi_rec17,
                                                  p_edi_rec18     =>  p_edi_rec18,
                                                  p_edi_rec19     =>  p_edi_rec19,
                                                  p_edi_rec20     =>  p_edi_rec20,
                                                  p_edi_rec21     =>  p_edi_rec21,
                                                  p_edi_rec22     =>  p_edi_rec22,
                                                  p_edi_rec23     =>  p_edi_rec23,
                                                  p_edi_rec24     =>  p_edi_rec24,
                                                  p_edi_rec25     =>  p_edi_rec25,
                                                  p_edi_rec26     =>  p_edi_rec26,
                                                  p_edi_rec27     =>  p_edi_rec27,
                                                  p_edi_rec28     =>  p_edi_rec28,
                                                  p_edi_rec29     =>  p_edi_rec29,
                                                  p_edi_rec30     =>  p_edi_rec30);
       end if;
       return 0;
  end;

  function  get_footer(p_tax_year     in     varchar2,
                       p_record_count in     varchar2,
                       p_error_count  in     varchar2,
                       p_missing_val  in     varchar2,
                       p_error_msg1   out NoCopy varchar2,
                       p_error_msg2   out NoCopy varchar2,
                       p_edi_rec1     out NoCopy varchar2,
                       p_edi_rec2     out NoCopy varchar2,
                       p_edi_rec3     out NoCopy varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_footer';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_footer(p_record_count      => p_record_count,
                                                 p_error_count       => p_error_count,
                                                 p_missing_val       => p_missing_val,
                                                 p_error_msg1        => p_error_msg1,
                                                 p_error_msg2        => p_error_msg2,
                                                 p_edi_rec1          => p_edi_rec1,
                                                 p_edi_rec2          => p_edi_rec2,
                                                 p_edi_rec3          => p_edi_rec3);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.get_footer(p_record_count      => p_record_count,
                                                 p_error_count       => p_error_count,
                                                 p_missing_val       => p_missing_val,
                                                 p_error_msg1        => p_error_msg1,
                                                 p_error_msg2        => p_error_msg2,
                                                 p_edi_rec1          => p_edi_rec1,
                                                 p_edi_rec2          => p_edi_rec2,
                                                 p_edi_rec3          => p_edi_rec3);
       else
          return pay_gb_p11d_edi_2008.get_footer(p_record_count      => p_record_count,
                                                 p_error_count       => p_error_count,
                                                 p_missing_val       => p_missing_val,
                                                 p_error_msg1        => p_error_msg1,
                                                 p_error_msg2        => p_error_msg2,
                                                 p_edi_rec1          => p_edi_rec1,
                                                 p_edi_rec2          => p_edi_rec2,
                                                 p_edi_rec3          => p_edi_rec3);
       end if;
       return 0;
  end;

  function  count_occurrence(p_benefit_type  in  varchar2,
                             p_person_id     in  varchar2,
                             p_employer_ref  in  varchar2,
                             p_tax_year      in  varchar2,
                             p_pact_id       in  varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'count_occurrence';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.count_occurrence(p_benefit_type  => p_benefit_type,
                                                       p_person_id     => p_person_id,
                                                       p_employer_ref  => p_employer_ref,
                                                       p_pact_id       => p_pact_id);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.count_occurrence(p_benefit_type  => p_benefit_type,
                                                       p_person_id     => p_person_id,
                                                       p_employer_ref  => p_employer_ref,
                                                       p_pact_id       => p_pact_id);
       else
          return pay_gb_p11d_edi_2008.count_occurrence(p_benefit_type  => p_benefit_type,
                                                       p_person_id     => p_person_id,
                                                       p_employer_ref  => p_employer_ref,
                                                       p_pact_id       => p_pact_id);
       end if;
  end;

  function  check_occurrence(p_benefit_type in varchar2,
                             p_tax_year     in varchar2) return varchar2
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'check_occurrence';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.check_occurrence(p_benefit_type  => p_benefit_type);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.check_occurrence(p_benefit_type  => p_benefit_type);
       else
          return pay_gb_p11d_edi_2008.check_occurrence(p_benefit_type  => p_benefit_type);
       end if;
  end;

  function  get_benefit_name(p_benefit_type in varchar2,
                             p_tax_year     in varchar2) return varchar2
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'get_benefit_name';
  begin
       if to_number(p_tax_year) < 2006 then
          return pay_gb_p11d_edi_2005.get_benefit_name(p_benefit_type  => p_benefit_type);
       elsif to_number(p_tax_year) = 2006 or to_number(p_tax_year) = 2007 then
          return pay_gb_p11d_edi_2006.get_benefit_name(p_benefit_type  => p_benefit_type);
       else
          return pay_gb_p11d_edi_2008.get_benefit_name(p_benefit_type  => p_benefit_type);
       end if;
  end;

  function  fetch_total_benefit(p_assact_id     in  number,
                                p_pact_id       in  number,
                                p_employer_ref  in  varchar2) return number
  is
       l_proc   CONSTANT VARCHAR2(50) := g_package || 'fetch_total_benefit';
       l_rep_run varchar2(20);
  begin
       pay_gb_p11d_archive_ss.get_parameters(
         p_payroll_action_id => p_pact_id,
         p_token_name        => 'Rep_Run',
         p_token_value       => l_rep_run);

       if to_number(l_rep_run) = 2006 or to_number(l_rep_run) = 2007 then
          return pay_gb_p11d_edi_2006.fetch_total_benefit(p_assact_id,p_employer_ref);
       else
          return pay_gb_p11d_edi_2008.fetch_total_benefit(p_assact_id,p_employer_ref);
       end if;
  end;

END PAY_GB_P11D_EDI_CONTROL;

/
