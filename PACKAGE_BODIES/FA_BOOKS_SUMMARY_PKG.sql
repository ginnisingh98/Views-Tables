--------------------------------------------------------
--  DDL for Package Body FA_BOOKS_SUMMARY_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."FA_BOOKS_SUMMARY_PKG" as
/* $Header: faxibsb.pls 120.3.12010000.2 2009/07/19 13:18:24 glchen ship $ */

PROCEDURE Insert_Row(X_Rowid                   IN OUT NOCOPY VARCHAR2,
                     X_Book_Type_Code                 VARCHAR2,
                     X_Asset_Id                       NUMBER,
                     X_Period_Counter                 NUMBER,
                     X_Fiscal_Year                    NUMBER   DEFAULT NULL,
                     X_Period_Num                     NUMBER   DEFAULT NULL,
                     X_Calendar_Period_Open_Date      DATE     DEFAULT NULL,
                     X_Calendar_Period_Close_Date     DATE     DEFAULT NULL,
                     X_Reset_Adjusted_Cost_Flag       VARCHAR2 DEFAULT NULL,
                     X_Change_In_Cost                 NUMBER   DEFAULT NULL,
                     X_Change_In_Additions_Cost       NUMBER   DEFAULT NULL,
                     X_Change_In_Adjustments_Cost     NUMBER   DEFAULT NULL,
                     X_Change_In_Retirements_Cost     NUMBER   DEFAULT NULL,
                     X_Change_In_Group_Rec_Cost       NUMBER   DEFAULT NULL,
                     X_Change_In_CIP_Cost             NUMBER   DEFAULT NULL,
                     X_Cost                           NUMBER   DEFAULT NULL,
                     X_CIP_Cost                       NUMBER   DEFAULT NULL,
                     X_Salvage_Type                   VARCHAR2 DEFAULT NULL,
                     X_Percent_Salvage_Value          NUMBER   DEFAULT NULL,
                     X_Salvage_Value                  NUMBER   DEFAULT NULL,
                     X_Member_Salvage_Value           NUMBER   DEFAULT NULL,
                     X_Recoverable_Cost               NUMBER   DEFAULT NULL,
                     X_Deprn_Limit_Type               VARCHAR2 DEFAULT NULL,
                     X_Allowed_Deprn_Limit            NUMBER   DEFAULT NULL,
                     X_Allowed_Deprn_Limit_Amount     NUMBER   DEFAULT NULL,
                     X_Member_Deprn_Limit_Amount      NUMBER   DEFAULT NULL,
                     X_Adjusted_Recoverable_Cost      NUMBER   DEFAULT NULL,
                     X_Adjusted_Cost                  NUMBER   DEFAULT NULL,
                     X_Depreciate_Flag                VARCHAR2 DEFAULT NULL,
                     X_Disabled_Flag                  VARCHAR2 DEFAULT NULL,
                     X_Date_Placed_In_Service         DATE     DEFAULT NULL,
                     X_Deprn_Method_Code              VARCHAR2 DEFAULT NULL,
                     X_Life_In_Months                 NUMBER   DEFAULT NULL,
                     X_Rate_Adjustment_Factor         NUMBER   DEFAULT NULL,
                     X_Adjusted_Rate                  NUMBER   DEFAULT NULL,
                     X_Bonus_Rule                     VARCHAR2 DEFAULT NULL,
                     X_Adjusted_Capacity              NUMBER   DEFAULT NULL,
                     X_Production_Capacity            NUMBER   DEFAULT NULL,
                     X_Unit_Of_Measure                VARCHAR2 DEFAULT NULL,
                     X_Remaining_Life1                NUMBER   DEFAULT NULL,
                     X_Remaining_Life2                NUMBER   DEFAULT NULL,
                     X_Formula_Factor                 NUMBER   DEFAULT NULL,
                     X_Unrevalued_Cost                NUMBER   DEFAULT NULL,
                     X_Reval_Amortization_Basis       NUMBER   DEFAULT NULL,
                     X_Reval_Ceiling                  NUMBER   DEFAULT NULL,
                     X_Ceiling_Name                   VARCHAR2 DEFAULT NULL,
                     X_Eofy_Adj_Cost                  NUMBER   DEFAULT NULL,
                     X_Eofy_Formula_Factor            NUMBER   DEFAULT NULL,
                     X_Eofy_Reserve                   NUMBER   DEFAULT NULL,
                     X_Eop_Adj_Cost                   NUMBER   DEFAULT NULL,
                     X_Eop_Formula_Factor             NUMBER   DEFAULT NULL,
                     X_Short_Fiscal_Year_Flag         VARCHAR2 DEFAULT NULL,
                     X_Group_Asset_ID                 NUMBER   DEFAULT NULL,
                     X_Super_Group_ID                 NUMBER   DEFAULT NULL,
                     X_Over_Depreciate_Option         VARCHAR2 DEFAULT NULL,
                     X_Fully_Rsvd_Revals_Counter      NUMBER   DEFAULT NULL,
                     X_Capitalized_Flag               VARCHAR2 DEFAULT NULL,
                     X_Fully_Reserved_Flag            VARCHAR2 DEFAULT NULL,
                     X_Fully_Retired_Flag             VARCHAR2 DEFAULT NULL,
                     X_Life_Complete_Flag             VARCHAR2 DEFAULT NULL,
                     X_Terminal_Gain_Loss_Amount      NUMBER   DEFAULT NULL,
                     X_Terminal_Gain_Loss_Flag        VARCHAR2 DEFAULT NULL,
                     X_Deprn_Amount                   NUMBER   DEFAULT NULL,
                     X_Ytd_Deprn                      NUMBER   DEFAULT NULL,
                     X_Deprn_Reserve                  NUMBER   DEFAULT NULL,
                     X_Bonus_Deprn_Amount             NUMBER   DEFAULT NULL,
                     X_Bonus_Ytd_Deprn                NUMBER   DEFAULT NULL,
                     X_Bonus_Deprn_Reserve            NUMBER   DEFAULT NULL,
                     X_Bonus_Rate                     NUMBER   DEFAULT NULL,
                     X_Ltd_Production                 NUMBER   DEFAULT NULL,
                     X_Ytd_Production                 NUMBER   DEFAULT NULL,
                     X_Production                     NUMBER   DEFAULT NULL,
                     X_Reval_Amortization             NUMBER   DEFAULT NULL,
                     X_Reval_Deprn_Expense            NUMBER   DEFAULT NULL,
                     X_Reval_Reserve                  NUMBER   DEFAULT NULL,
                     X_Ytd_Reval_Deprn_Expense        NUMBER   DEFAULT NULL,
                     X_Deprn_Override_Flag            VARCHAR2 DEFAULT NULL,
                     X_System_Deprn_Amount            NUMBER   DEFAULT NULL,
                     X_System_Bonus_Deprn_Amount      NUMBER   DEFAULT NULL,
                     X_Ytd_Proceeds_Of_Sale           NUMBER   DEFAULT NULL,
                     X_Ltd_Proceeds_Of_Sale           NUMBER   DEFAULT NULL,
                     X_Ytd_Cost_Of_Removal            NUMBER   DEFAULT NULL,
                     X_Ltd_Cost_Of_Removal            NUMBER   DEFAULT NULL,
                     X_Deprn_Adjustment_Amount        NUMBER   DEFAULT NULL,
                     X_Expense_Adjustment_Amount      NUMBER   DEFAULT NULL,
                     X_Unplanned_Amount               NUMBER   DEFAULT NULL,
                     X_Reserve_Adjustment_Amount      NUMBER   DEFAULT NULL,
                     X_Creation_Date                  DATE,
                     X_Created_By                     NUMBER,
                     X_Last_Update_Date               DATE,
                     X_Last_Updated_By                NUMBER,
                     X_Last_Update_Login              NUMBER   DEFAULT NULL,
                     X_Change_In_Eofy_Reserve         NUMBER   DEFAULT NULL,
                     X_Switch_Code                    VARCHAR2 DEFAULT NULL,
                     X_Transaction_Header_Id_In       NUMBER   DEFAULT NULL,
                     X_Transaction_Header_Id_Out      NUMBER   DEFAULT NULL,
                     X_Polish_Deprn_Basis             NUMBER   DEFAULT NULL,
                     X_Polish_Adj_Rec_Cost            NUMBER   DEFAULT NULL,
                     X_Impairment_Amount              NUMBER   DEFAULT NULL,
                     X_Ytd_Impairment                 NUMBER   DEFAULT NULL,
                     X_impairment_reserve                 NUMBER   DEFAULT NULL,
                     X_MRC_Sob_Type_Code              VARCHAR2 DEFAULT 'P',
                     X_set_of_books_id                NUMBER ,
                     X_Return_Status              OUT NOCOPY BOOLEAN,
                     X_Calling_Fn                     VARCHAR2
, p_log_level_rec        IN     FA_API_TYPES.log_level_rec_type) IS

   CURSOR C_bs IS SELECT rowid
                  FROM   fa_books_summary
                  WHERE  asset_id = X_Asset_ID
                  AND    book_type_code = X_Book_Type_Code
                  AND    period_counter = X_Period_Counter;

   CURSOR C_bs_mc IS SELECT rowid
                     FROM   fa_mc_books_summary
                     WHERE  asset_id = X_Asset_ID
                     AND    book_type_code = X_Book_Type_Code
                     AND    period_counter = X_Period_Counter
                     AND    set_of_books_id = X_set_of_books_id;

BEGIN

   if (X_mrc_sob_type_code = 'R') then
      INSERT INTO fa_mc_books_summary(
              set_of_books_id,
              book_type_code,
              asset_id,
              period_counter,
              fiscal_year,
              period_num,
              calendar_period_open_date,
              calendar_period_close_date,
              reset_adjusted_cost_flag,
              change_in_cost,
              change_in_additions_cost,
              change_in_adjustments_cost,
              change_in_retirements_cost,
              change_in_group_rec_cost,
              change_in_cip_cost,
              cost,
              cip_cost,
              salvage_type,
              percent_salvage_value,
              salvage_value,
              member_salvage_value,
              recoverable_cost,
              deprn_limit_type,
              allowed_deprn_limit,
              allowed_deprn_limit_amount,
              member_deprn_limit_amount,
              adjusted_recoverable_cost,
              adjusted_cost,
              depreciate_flag,
              disabled_flag,
              date_placed_in_service,
              deprn_method_code,
              life_in_months,
              rate_adjustment_factor,
              adjusted_rate,
              bonus_rule,
              adjusted_capacity,
              production_capacity,
              unit_of_measure,
              remaining_life1,
              remaining_life2,
              formula_factor,
              unrevalued_cost,
              reval_amortization_basis,
              reval_ceiling,
              ceiling_name,
              eofy_adj_cost,
              eofy_formula_factor,
              eofy_reserve,
              eop_adj_cost,
              eop_formula_factor,
              short_fiscal_year_flag,
              group_asset_id,
              super_group_id,
              over_depreciate_option,
              fully_rsvd_revals_counter,
              capitalized_flag,
              fully_reserved_flag,
              fully_retired_flag,
              life_complete_flag,
              terminal_gain_loss_amount,
              terminal_gain_loss_flag,
              deprn_amount,
              ytd_deprn,
              deprn_reserve,
              bonus_deprn_amount,
              bonus_ytd_deprn,
              bonus_deprn_reserve,
              bonus_rate,
              ltd_production,
              ytd_production,
              production,
              reval_amortization,
              reval_deprn_expense,
              reval_reserve,
              ytd_reval_deprn_expense,
              deprn_override_flag,
              system_deprn_amount,
              system_bonus_deprn_amount,
              ytd_proceeds_of_sale,
              ltd_proceeds_of_sale,
              ytd_cost_of_removal,
              ltd_cost_of_removal,
              deprn_adjustment_amount,
              expense_adjustment_amount,
              unplanned_amount,
              reserve_adjustment_amount,
              creation_date,
              created_by,
              last_update_date,
              last_updated_by,
              last_update_login,
              change_in_eofy_reserve,
              switch_code,
              transaction_header_id_in,
              transaction_header_id_out,
              polish_deprn_basis,
              polish_adj_rec_cost,
              impairment_amount,
              ytd_impairment,
              impairment_reserve
      ) VALUES (
              X_set_of_books_id,
              X_Book_Type_Code,
              X_Asset_Id,
              X_Period_Counter,
              X_Fiscal_Year,
              X_Period_Num,
              X_Calendar_Period_Open_Date,
              X_Calendar_Period_Close_Date,
              X_Reset_Adjusted_Cost_Flag,
              X_Change_In_Cost,
              X_Change_In_Additions_Cost,
              X_Change_In_Adjustments_Cost,
              X_Change_In_Retirements_Cost,
              X_Change_In_Group_Rec_Cost,
              X_Change_In_CIP_Cost,
              X_Cost,
              X_CIP_Cost,
              X_Salvage_Type,
              X_Percent_Salvage_Value,
              X_Salvage_Value,
              X_Member_Salvage_Value,
              X_Recoverable_Cost,
              X_Deprn_Limit_Type,
              X_Allowed_Deprn_Limit,
              X_Allowed_Deprn_Limit_Amount,
              X_Member_Deprn_Limit_Amount,
              X_Adjusted_Recoverable_Cost,
              X_Adjusted_Cost,
              X_Depreciate_Flag,
              X_Disabled_Flag,
              X_Date_Placed_In_Service,
              X_Deprn_Method_Code,
              X_Life_In_Months,
              X_Rate_Adjustment_Factor,
              X_Adjusted_Rate,
              X_Bonus_Rule,
              X_Adjusted_Capacity,
              X_Production_Capacity,
              X_Unit_Of_Measure,
              X_Remaining_Life1,
              X_Remaining_Life2,
              X_Formula_Factor,
              X_Unrevalued_Cost,
              X_Reval_Amortization_Basis,
              X_Reval_Ceiling,
              X_Ceiling_Name,
              X_Eofy_Adj_Cost,
              X_Eofy_Formula_Factor,
              X_Eofy_Reserve,
              X_Eop_Adj_Cost,
              X_Eop_Formula_Factor,
              X_Short_Fiscal_Year_Flag,
              X_Group_Asset_ID,
              X_Super_Group_ID,
              X_Over_Depreciate_Option,
              X_Fully_Rsvd_Revals_Counter,
              X_Capitalized_Flag,
              X_Fully_Reserved_Flag,
              X_Fully_Retired_Flag,
              X_Life_Complete_Flag,
              X_Terminal_Gain_Loss_Amount,
              X_Terminal_Gain_Loss_Flag,
              X_Deprn_Amount,
              X_Ytd_Deprn,
              X_Deprn_Reserve,
              X_Bonus_Deprn_Amount,
              X_Bonus_Ytd_Deprn,
              X_Bonus_Deprn_Reserve,
              X_Bonus_Rate,
              X_Ltd_Production,
              X_Ytd_Production,
              X_Production,
              X_Reval_Amortization,
              X_Reval_Deprn_Expense,
              X_Reval_Reserve,
              X_Ytd_Reval_Deprn_Expense,
              X_Deprn_Override_Flag,
              X_System_Deprn_Amount,
              X_System_Bonus_Deprn_Amount,
              X_Ytd_Proceeds_Of_Sale,
              X_Ltd_Proceeds_Of_Sale,
              X_Ytd_Cost_Of_Removal,
              X_Ltd_Cost_Of_Removal,
              X_Deprn_Adjustment_Amount,
              X_Expense_Adjustment_Amount,
              X_Unplanned_Amount,
              X_Reserve_Adjustment_Amount,
              X_Creation_Date,
              X_Created_By,
              X_Last_Update_Date,
              X_Last_Updated_By,
              X_Last_Update_Login,
              X_Change_In_Eofy_Reserve,
              X_Switch_Code,
              X_Transaction_Header_Id_In,
              X_Transaction_Header_Id_Out,
              X_Polish_Deprn_Basis,
              X_Polish_Adj_Rec_Cost,
              X_Impairment_Amount,
              X_Ytd_Impairment,
              X_impairment_reserve
      );

      OPEN C_bs_mc;
      FETCH C_bs_mc INTO X_Rowid;
      if (C_bs_mc%NOTFOUND) then
      CLOSE C_bs_mc;
      Raise NO_DATA_FOUND;
      end if;
      CLOSE C_bs_mc;

   else

      INSERT INTO fa_books_summary(
              book_type_code,
              asset_id,
              period_counter,
              fiscal_year,
              period_num,
              calendar_period_open_date,
              calendar_period_close_date,
              reset_adjusted_cost_flag,
              change_in_cost,
              change_in_additions_cost,
              change_in_adjustments_cost,
              change_in_retirements_cost,
              change_in_group_rec_cost,
              change_in_cip_cost,
              cost,
              cip_cost,
              salvage_type,
              percent_salvage_value,
              salvage_value,
              member_salvage_value,
              recoverable_cost,
              deprn_limit_type,
              allowed_deprn_limit,
              allowed_deprn_limit_amount,
              member_deprn_limit_amount,
              adjusted_recoverable_cost,
              adjusted_cost,
              depreciate_flag,
              disabled_flag,
              date_placed_in_service,
              deprn_method_code,
              life_in_months,
              rate_adjustment_factor,
              adjusted_rate,
              bonus_rule,
              adjusted_capacity,
              production_capacity,
              unit_of_measure,
              remaining_life1,
              remaining_life2,
              formula_factor,
              unrevalued_cost,
              reval_amortization_basis,
              reval_ceiling,
              ceiling_name,
              eofy_adj_cost,
              eofy_formula_factor,
              eofy_reserve,
              eop_adj_cost,
              eop_formula_factor,
              short_fiscal_year_flag,
              group_asset_id,
              super_group_id,
              over_depreciate_option,
              fully_rsvd_revals_counter,
              capitalized_flag,
              fully_reserved_flag,
              fully_retired_flag,
              life_complete_flag,
              terminal_gain_loss_amount,
              terminal_gain_loss_flag,
              deprn_amount,
              ytd_deprn,
              deprn_reserve,
              bonus_deprn_amount,
              bonus_ytd_deprn,
              bonus_deprn_reserve,
              bonus_rate,
              ltd_production,
              ytd_production,
              production,
              reval_amortization,
              reval_deprn_expense,
              reval_reserve,
              ytd_reval_deprn_expense,
              deprn_override_flag,
              system_deprn_amount,
              system_bonus_deprn_amount,
              ytd_proceeds_of_sale,
              ltd_proceeds_of_sale,
              ytd_cost_of_removal,
              ltd_cost_of_removal,
              deprn_adjustment_amount,
              expense_adjustment_amount,
              unplanned_amount,
              reserve_adjustment_amount,
              creation_date,
              created_by,
              last_update_date,
              last_updated_by,
              last_update_login,
              change_in_eofy_reserve,
              switch_code,
              transaction_header_id_in,
              transaction_header_id_out,
              polish_deprn_basis,
              polish_adj_rec_cost,
              impairment_amount,
              ytd_impairment,
              impairment_reserve
      ) VALUES (
              X_Book_Type_Code,
              X_Asset_Id,
              X_Period_Counter,
              X_Fiscal_Year,
              X_Period_Num,
              X_Calendar_Period_Open_Date,
              X_Calendar_Period_Close_Date,
              X_Reset_Adjusted_Cost_Flag,
              X_Change_In_Cost,
              X_Change_In_Additions_Cost,
              X_Change_In_Adjustments_Cost,
              X_Change_In_Retirements_Cost,
              X_Change_In_Group_Rec_Cost,
              X_Change_In_CIP_Cost,
              X_Cost,
              X_CIP_Cost,
              X_Salvage_Type,
              X_Percent_Salvage_Value,
              X_Salvage_Value,
              X_Member_Salvage_Value,
              X_Recoverable_Cost,
              X_Deprn_Limit_Type,
              X_Allowed_Deprn_Limit,
              X_Allowed_Deprn_Limit_Amount,
              X_Member_Deprn_Limit_Amount,
              X_Adjusted_Recoverable_Cost,
              X_Adjusted_Cost,
              X_Depreciate_Flag,
              X_Disabled_Flag,
              X_Date_Placed_In_Service,
              X_Deprn_Method_Code,
              X_Life_In_Months,
              X_Rate_Adjustment_Factor,
              X_Adjusted_Rate,
              X_Bonus_Rule,
              X_Adjusted_Capacity,
              X_Production_Capacity,
              X_Unit_Of_Measure,
              X_Remaining_Life1,
              X_Remaining_Life2,
              X_Formula_Factor,
              X_Unrevalued_Cost,
              X_Reval_Amortization_Basis,
              X_Reval_Ceiling,
              X_Ceiling_Name,
              X_Eofy_Adj_Cost,
              X_Eofy_Formula_Factor,
              X_Eofy_Reserve,
              X_Eop_Adj_Cost,
              X_Eop_Formula_Factor,
              X_Short_Fiscal_Year_Flag,
              X_Group_Asset_ID,
              X_Super_Group_ID,
              X_Over_Depreciate_Option,
              X_Fully_Rsvd_Revals_Counter,
              X_Capitalized_Flag,
              X_Fully_Reserved_Flag,
              X_Fully_Retired_Flag,
              X_Life_Complete_Flag,
              X_Terminal_Gain_Loss_Amount,
              X_Terminal_Gain_Loss_Flag,
              X_Deprn_Amount,
              X_Ytd_Deprn,
              X_Deprn_Reserve,
              X_Bonus_Deprn_Amount,
              X_Bonus_Ytd_Deprn,
              X_Bonus_Deprn_Reserve,
              X_Bonus_Rate,
              X_Ltd_Production,
              X_Ytd_Production,
              X_Production,
              X_Reval_Amortization,
              X_Reval_Deprn_Expense,
              X_Reval_Reserve,
              X_Ytd_Reval_Deprn_Expense,
              X_Deprn_Override_Flag,
              X_System_Deprn_Amount,
              X_System_Bonus_Deprn_Amount,
              X_Ytd_Proceeds_Of_Sale,
              X_Ltd_Proceeds_Of_Sale,
              X_Ytd_Cost_Of_Removal,
              X_Ltd_Cost_Of_Removal,
              X_Deprn_Adjustment_Amount,
              X_Expense_Adjustment_Amount,
              X_Unplanned_Amount,
              X_Reserve_Adjustment_Amount,
              X_Creation_Date,
              X_Created_By,
              X_Last_Update_Date,
              X_Last_Updated_By,
              X_Last_Update_Login,
              X_Change_In_Eofy_Reserve,
              X_Switch_Code,
              X_Transaction_Header_Id_In,
              X_Transaction_Header_Id_Out,
              X_Polish_Deprn_Basis,
              X_Polish_Adj_Rec_Cost,
              X_Impairment_Amount,
              X_Ytd_Impairment,
              X_impairment_reserve
      );

      OPEN C_bs;
      FETCH C_bs INTO X_Rowid;
      if (C_bs%NOTFOUND) then
         CLOSE C_bs;
         Raise NO_DATA_FOUND;
      end if;
      CLOSE C_bs;

   end if;  -- end mrc

   X_Return_Status := TRUE;

EXCEPTION
   WHEN OTHERS THEN
      fa_srvr_msg.add_sql_error(
         calling_fn => 'fa_books_summary_pkg.insert_row', p_log_level_rec => p_log_level_rec);
      X_Return_Status := FALSE;
      raise;
END Insert_Row;

PROCEDURE Lock_Row(  X_Rowid                          VARCHAR2,
                     X_Book_Type_Code                 VARCHAR2,
                     X_Asset_Id                       NUMBER,
                     X_Period_Counter                 NUMBER,
                     X_Fiscal_Year                    NUMBER   DEFAULT NULL,
                     X_Period_Num                     NUMBER   DEFAULT NULL,
                     X_Calendar_Period_Open_Date      DATE     DEFAULT NULL,
                     X_Calendar_Period_Close_Date     DATE     DEFAULT NULL,
                     X_Reset_Adjusted_Cost_Flag       VARCHAR2 DEFAULT NULL,
                     X_Change_In_Cost                 NUMBER   DEFAULT NULL,
                     X_Change_In_Additions_Cost       NUMBER   DEFAULT NULL,
                     X_Change_In_Adjustments_Cost     NUMBER   DEFAULT NULL,
                     X_Change_In_Retirements_Cost     NUMBER   DEFAULT NULL,
                     X_Change_In_Group_Rec_Cost       NUMBER   DEFAULT NULL,
                     X_Change_In_CIP_Cost             NUMBER   DEFAULT NULL,
                     X_Cost                           NUMBER   DEFAULT NULL,
                     X_CIP_Cost                       NUMBER   DEFAULT NULL,
                     X_Salvage_Type                   VARCHAR2 DEFAULT NULL,
                     X_Percent_Salvage_Value          NUMBER   DEFAULT NULL,
                     X_Salvage_Value                  NUMBER   DEFAULT NULL,
                     X_Member_Salvage_Value           NUMBER   DEFAULT NULL,
                     X_Recoverable_Cost               NUMBER   DEFAULT NULL,
                     X_Deprn_Limit_Type               VARCHAR2 DEFAULT NULL,
                     X_Allowed_Deprn_Limit            NUMBER   DEFAULT NULL,
                     X_Allowed_Deprn_Limit_Amount     NUMBER   DEFAULT NULL,
                     X_Member_Deprn_Limit_Amount      NUMBER   DEFAULT NULL,
                     X_Adjusted_Recoverable_Cost      NUMBER   DEFAULT NULL,
                     X_Adjusted_Cost                  NUMBER   DEFAULT NULL,
                     X_Depreciate_Flag                VARCHAR2 DEFAULT NULL,
                     X_Disabled_Flag                  VARCHAR2 DEFAULT NULL,
                     X_Date_Placed_In_Service         DATE     DEFAULT NULL,
                     X_Deprn_Method_Code              VARCHAR2 DEFAULT NULL,
                     X_Life_In_Months                 NUMBER   DEFAULT NULL,
                     X_Rate_Adjustment_Factor         NUMBER   DEFAULT NULL,
                     X_Adjusted_Rate                  NUMBER   DEFAULT NULL,
                     X_Bonus_Rule                     VARCHAR2 DEFAULT NULL,
                     X_Adjusted_Capacity              NUMBER   DEFAULT NULL,
                     X_Production_Capacity            NUMBER   DEFAULT NULL,
                     X_Unit_Of_Measure                VARCHAR2 DEFAULT NULL,
                     X_Remaining_Life1                NUMBER   DEFAULT NULL,
                     X_Remaining_Life2                NUMBER   DEFAULT NULL,
                     X_Formula_Factor                 NUMBER   DEFAULT NULL,
                     X_Unrevalued_Cost                NUMBER   DEFAULT NULL,
                     X_Reval_Amortization_Basis       NUMBER   DEFAULT NULL,
                     X_Reval_Ceiling                  NUMBER   DEFAULT NULL,
                     X_Ceiling_Name                   VARCHAR2 DEFAULT NULL,
                     X_Eofy_Adj_Cost                  NUMBER   DEFAULT NULL,
                     X_Eofy_Formula_Factor            NUMBER   DEFAULT NULL,
                     X_Eofy_Reserve                   NUMBER   DEFAULT NULL,
                     X_Eop_Adj_Cost                   NUMBER   DEFAULT NULL,
                     X_Eop_Formula_Factor             NUMBER   DEFAULT NULL,
                     X_Short_Fiscal_Year_Flag         VARCHAR2 DEFAULT NULL,
                     X_Group_Asset_ID                 NUMBER   DEFAULT NULL,
                     X_Super_Group_ID                 NUMBER   DEFAULT NULL,
                     X_Over_Depreciate_Option         VARCHAR2 DEFAULT NULL,
                     X_Fully_Rsvd_Revals_Counter      NUMBER   DEFAULT NULL,
                     X_Capitalized_Flag               VARCHAR2 DEFAULT NULL,
                     X_Fully_Reserved_Flag            VARCHAR2 DEFAULT NULL,
                     X_Fully_Retired_Flag             VARCHAR2 DEFAULT NULL,
                     X_Life_Complete_Flag             VARCHAR2 DEFAULT NULL,
                     X_Terminal_Gain_Loss_Amount      NUMBER   DEFAULT NULL,
                     X_Terminal_Gain_Loss_Flag        VARCHAR2 DEFAULT NULL,
                     X_Deprn_Amount                   NUMBER   DEFAULT NULL,
                     X_Ytd_Deprn                      NUMBER   DEFAULT NULL,
                     X_Deprn_Reserve                  NUMBER   DEFAULT NULL,
                     X_Bonus_Deprn_Amount             NUMBER   DEFAULT NULL,
                     X_Bonus_Ytd_Deprn                NUMBER   DEFAULT NULL,
                     X_Bonus_Deprn_Reserve            NUMBER   DEFAULT NULL,
                     X_Bonus_Rate                     NUMBER   DEFAULT NULL,
                     X_Ltd_Production                 NUMBER   DEFAULT NULL,
                     X_Ytd_Production                 NUMBER   DEFAULT NULL,
                     X_Production                     NUMBER   DEFAULT NULL,
                     X_Reval_Amortization             NUMBER   DEFAULT NULL,
                     X_Reval_Deprn_Expense            NUMBER   DEFAULT NULL,
                     X_Reval_Reserve                  NUMBER   DEFAULT NULL,
                     X_Ytd_Reval_Deprn_Expense        NUMBER   DEFAULT NULL,
                     X_Deprn_Override_Flag            VARCHAR2 DEFAULT NULL,
                     X_System_Deprn_Amount            NUMBER   DEFAULT NULL,
                     X_System_Bonus_Deprn_Amount      NUMBER   DEFAULT NULL,
                     X_Ytd_Proceeds_Of_Sale           NUMBER   DEFAULT NULL,
                     X_Ltd_Proceeds_Of_Sale           NUMBER   DEFAULT NULL,
                     X_Ytd_Cost_Of_Removal            NUMBER   DEFAULT NULL,
                     X_Ltd_Cost_Of_Removal            NUMBER   DEFAULT NULL,
                     X_Deprn_Adjustment_Amount        NUMBER   DEFAULT NULL,
                     X_Expense_Adjustment_Amount      NUMBER   DEFAULT NULL,
                     X_Unplanned_Amount               NUMBER   DEFAULT NULL,
                     X_Reserve_Adjustment_Amount      NUMBER   DEFAULT NULL,
                     X_Creation_Date                  DATE,
                     X_Created_By                     NUMBER,
                     X_Last_Update_Date               DATE,
                     X_Last_Updated_By                NUMBER,
                     X_Last_Update_Login              NUMBER   DEFAULT NULL,
                     X_Change_In_Eofy_Reserve         NUMBER   DEFAULT NULL,
                     X_Switch_Code                    VARCHAR2 DEFAULT NULL,
                     X_Calling_Fn                     VARCHAR2
, p_log_level_rec        IN     FA_API_TYPES.log_level_rec_type) IS

   CURSOR C IS
      SELECT  book_type_code,
              asset_id,
              period_counter,
              fiscal_year,
              period_num,
              calendar_period_open_date,
              calendar_period_close_date,
              reset_adjusted_cost_flag,
              change_in_cost,
              change_in_additions_cost,
              change_in_adjustments_cost,
              change_in_retirements_cost,
              change_in_group_rec_cost,
              change_in_cip_cost,
              cost,
              cip_cost,
              salvage_type,
              percent_salvage_value,
              salvage_value,
              member_salvage_value,
              recoverable_cost,
              deprn_limit_type,
              allowed_deprn_limit,
              allowed_deprn_limit_amount,
              member_deprn_limit_amount,
              adjusted_recoverable_cost,
              adjusted_cost,
              depreciate_flag,
              disabled_flag,
              date_placed_in_service,
              deprn_method_code,
              life_in_months,
              rate_adjustment_factor,
              adjusted_rate,
              bonus_rule,
              adjusted_capacity,
              production_capacity,
              unit_of_measure,
              remaining_life1,
              remaining_life2,
              formula_factor,
              unrevalued_cost,
              reval_amortization_basis,
              reval_ceiling,
              ceiling_name,
              eofy_adj_cost,
              eofy_formula_factor,
              eofy_reserve,
              eop_adj_cost,
              eop_formula_factor,
              short_fiscal_year_flag,
              group_asset_id,
              super_group_id,
              over_depreciate_option,
              fully_rsvd_revals_counter,
              capitalized_flag,
              fully_reserved_flag,
              fully_retired_flag,
              life_complete_flag,
              terminal_gain_loss_amount,
              terminal_gain_loss_flag,
              deprn_amount,
              ytd_deprn,
              deprn_reserve,
              bonus_deprn_amount,
              bonus_ytd_deprn,
              bonus_deprn_reserve,
              bonus_rate,
              ltd_production,
              ytd_production,
              production,
              reval_amortization,
              reval_deprn_expense,
              reval_reserve,
              ytd_reval_deprn_expense,
              deprn_override_flag,
              system_deprn_amount,
              system_bonus_deprn_amount,
              ytd_proceeds_of_sale,
              ltd_proceeds_of_sale,
              ytd_cost_of_removal,
              ltd_cost_of_removal,
              deprn_adjustment_amount,
              expense_adjustment_amount,
              unplanned_amount,
              reserve_adjustment_amount,
              creation_date,
              created_by,
              last_update_date,
              last_updated_by,
              last_update_login,
              change_in_eofy_reserve,
              switch_code
       FROM   fa_books_summary
       WHERE  rowid = X_Rowid
       FOR UPDATE of Asset_Id, Book_Type_Code, Period_Counter NOWAIT;

   Recinfo C%ROWTYPE;

BEGIN

   OPEN C;
   FETCH C INTO Recinfo;
   if (C%NOTFOUND) then
      CLOSE C;
      FND_MESSAGE.Set_Name('FND', 'FORM_RECORD_DELETED');
      APP_EXCEPTION.Raise_Exception;
   end if;
   CLOSE C;

   -- not finished.  still need to add rest of columns from table.
   if ((Recinfo.book_type_code =  X_Book_Type_Code)
      AND (Recinfo.asset_id =  X_Asset_Id)
      AND (Recinfo.period_counter =  X_Period_Counter)
      AND (   (Recinfo.fiscal_year =  X_Fiscal_Year)
          OR (    (Recinfo.fiscal_year IS NULL)
             AND (X_Fiscal_Year IS NULL)))
      AND (   (Recinfo.period_num =  X_Period_Num)
          OR (    (Recinfo.period_num IS NULL)
             AND (X_Period_Num IS NULL)))
   ) then
      return;
   else
      FND_MESSAGE.Set_Name('FND', 'FORM_RECORD_CHANGED');
      APP_EXCEPTION.Raise_Exception;
   end if;

END Lock_Row;

PROCEDURE Update_Row(X_Rowid                          VARCHAR2 DEFAULT NULL,
                     X_Book_Type_Code                 VARCHAR2 DEFAULT NULL,
                     X_Asset_Id                       NUMBER   DEFAULT NULL,
                     X_Period_Counter                 NUMBER   DEFAULT NULL,
                     X_Fiscal_Year                    NUMBER   DEFAULT NULL,
                     X_Period_Num                     NUMBER   DEFAULT NULL,
                     X_Calendar_Period_Open_Date      DATE     DEFAULT NULL,
                     X_Calendar_Period_Close_Date     DATE     DEFAULT NULL,
                     X_Reset_Adjusted_Cost_Flag       VARCHAR2 DEFAULT NULL,
                     X_Change_In_Cost                 NUMBER   DEFAULT NULL,
                     X_Change_In_Additions_Cost       NUMBER   DEFAULT NULL,
                     X_Change_In_Adjustments_Cost     NUMBER   DEFAULT NULL,
                     X_Change_In_Retirements_Cost     NUMBER   DEFAULT NULL,
                     X_Change_In_Group_Rec_Cost       NUMBER   DEFAULT NULL,
                     X_Change_In_CIP_Cost             NUMBER   DEFAULT NULL,
                     X_Cost                           NUMBER   DEFAULT NULL,
                     X_CIP_Cost                       NUMBER   DEFAULT NULL,
                     X_Salvage_Type                   VARCHAR2 DEFAULT NULL,
                     X_Percent_Salvage_Value          NUMBER   DEFAULT NULL,
                     X_Salvage_Value                  NUMBER   DEFAULT NULL,
                     X_Member_Salvage_Value           NUMBER   DEFAULT NULL,
                     X_Recoverable_Cost               NUMBER   DEFAULT NULL,
                     X_Deprn_Limit_Type               VARCHAR2 DEFAULT NULL,
                     X_Allowed_Deprn_Limit            NUMBER   DEFAULT NULL,
                     X_Allowed_Deprn_Limit_Amount     NUMBER   DEFAULT NULL,
                     X_Member_Deprn_Limit_Amount      NUMBER   DEFAULT NULL,
                     X_Adjusted_Recoverable_Cost      NUMBER   DEFAULT NULL,
                     X_Adjusted_Cost                  NUMBER   DEFAULT NULL,
                     X_Depreciate_Flag                VARCHAR2 DEFAULT NULL,
                     X_Disabled_Flag                  VARCHAR2 DEFAULT NULL,
                     X_Date_Placed_In_Service         DATE     DEFAULT NULL,
                     X_Deprn_Method_Code              VARCHAR2 DEFAULT NULL,
                     X_Life_In_Months                 NUMBER   DEFAULT NULL,
                     X_Rate_Adjustment_Factor         NUMBER   DEFAULT NULL,
                     X_Adjusted_Rate                  NUMBER   DEFAULT NULL,
                     X_Bonus_Rule                     VARCHAR2 DEFAULT NULL,
                     X_Adjusted_Capacity              NUMBER   DEFAULT NULL,
                     X_Production_Capacity            NUMBER   DEFAULT NULL,
                     X_Unit_Of_Measure                VARCHAR2 DEFAULT NULL,
                     X_Remaining_Life1                NUMBER   DEFAULT NULL,
                     X_Remaining_Life2                NUMBER   DEFAULT NULL,
                     X_Formula_Factor                 NUMBER   DEFAULT NULL,
                     X_Unrevalued_Cost                NUMBER   DEFAULT NULL,
                     X_Reval_Amortization_Basis       NUMBER   DEFAULT NULL,
                     X_Reval_Ceiling                  NUMBER   DEFAULT NULL,
                     X_Ceiling_Name                   VARCHAR2 DEFAULT NULL,
                     X_Eofy_Adj_Cost                  NUMBER   DEFAULT NULL,
                     X_Eofy_Formula_Factor            NUMBER   DEFAULT NULL,
                     X_Eofy_Reserve                   NUMBER   DEFAULT NULL,
                     X_Eop_Adj_Cost                   NUMBER   DEFAULT NULL,
                     X_Eop_Formula_Factor             NUMBER   DEFAULT NULL,
                     X_Short_Fiscal_Year_Flag         VARCHAR2 DEFAULT NULL,
                     X_Group_Asset_ID                 NUMBER   DEFAULT NULL,
                     X_Super_Group_ID                 NUMBER   DEFAULT NULL,
                     X_Over_Depreciate_Option         VARCHAR2 DEFAULT NULL,
                     X_Fully_Rsvd_Revals_Counter      NUMBER   DEFAULT NULL,
                     X_Capitalized_Flag               VARCHAR2 DEFAULT NULL,
                     X_Fully_Reserved_Flag            VARCHAR2 DEFAULT NULL,
                     X_Fully_Retired_Flag             VARCHAR2 DEFAULT NULL,
                     X_Life_Complete_Flag             VARCHAR2 DEFAULT NULL,
                     X_Terminal_Gain_Loss_Amount      NUMBER   DEFAULT NULL,
                     X_Terminal_Gain_Loss_Flag        VARCHAR2 DEFAULT NULL,
                     X_Deprn_Amount                   NUMBER   DEFAULT NULL,
                     X_Ytd_Deprn                      NUMBER   DEFAULT NULL,
                     X_Deprn_Reserve                  NUMBER   DEFAULT NULL,
                     X_Bonus_Deprn_Amount             NUMBER   DEFAULT NULL,
                     X_Bonus_Ytd_Deprn                NUMBER   DEFAULT NULL,
                     X_Bonus_Deprn_Reserve            NUMBER   DEFAULT NULL,
                     X_Bonus_Rate                     NUMBER   DEFAULT NULL,
                     X_Ltd_Production                 NUMBER   DEFAULT NULL,
                     X_Ytd_Production                 NUMBER   DEFAULT NULL,
                     X_Production                     NUMBER   DEFAULT NULL,
                     X_Reval_Amortization             NUMBER   DEFAULT NULL,
                     X_Reval_Deprn_Expense            NUMBER   DEFAULT NULL,
                     X_Reval_Reserve                  NUMBER   DEFAULT NULL,
                     X_Ytd_Reval_Deprn_Expense        NUMBER   DEFAULT NULL,
                     X_Deprn_Override_Flag            VARCHAR2 DEFAULT NULL,
                     X_System_Deprn_Amount            NUMBER   DEFAULT NULL,
                     X_System_Bonus_Deprn_Amount      NUMBER   DEFAULT NULL,
                     X_Ytd_Proceeds_Of_Sale           NUMBER   DEFAULT NULL,
                     X_Ltd_Proceeds_Of_Sale           NUMBER   DEFAULT NULL,
                     X_Ytd_Cost_Of_Removal            NUMBER   DEFAULT NULL,
                     X_Ltd_Cost_Of_Removal            NUMBER   DEFAULT NULL,
                     X_Deprn_Adjustment_Amount        NUMBER   DEFAULT NULL,
                     X_Expense_Adjustment_Amount      NUMBER   DEFAULT NULL,
                     X_Unplanned_Amount               NUMBER   DEFAULT NULL,
                     X_Reserve_Adjustment_Amount      NUMBER   DEFAULT NULL,
                     X_Creation_Date                  DATE,
                     X_Created_By                     NUMBER,
                     X_Last_Update_Date               DATE,
                     X_Last_Updated_By                NUMBER,
                     X_Last_Update_Login              NUMBER   DEFAULT NULL,
                     X_Change_In_Eofy_Reserve         NUMBER   DEFAULT NULL,
                     X_Switch_Code                    VARCHAR2 DEFAULT NULL,
                     X_Transaction_Header_Id_In       NUMBER   DEFAULT NULL,
                     X_Transaction_Header_Id_Out      NUMBER   DEFAULT NULL,
                     X_Polish_Deprn_Basis             NUMBER   DEFAULT NULL,
                     X_Polish_Adj_Rec_Cost            NUMBER   DEFAULT NULL,
                     X_Impairment_Amount              NUMBER   DEFAULT NULL,
                     X_Ytd_Impairment                 NUMBER   DEFAULT NULL,
                     X_impairment_reserve                 NUMBER   DEFAULT NULL,
                     X_MRC_Sob_Type_Code              VARCHAR2 DEFAULT 'P',
                     X_set_of_books_id                NUMBER ,
                     X_Calling_Fn                     VARCHAR2
, p_log_level_rec        IN     FA_API_TYPES.log_level_rec_type) IS

BEGIN

   if (X_mrc_sob_type_code = 'R') then
      if X_Rowid is not null then
         UPDATE fa_mc_books_summary
         SET
          book_type_code             = decode(X_Book_Type_Code,
                                              NULL, book_type_code,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Book_Type_Code),
          asset_id                   = decode(X_Asset_Id,
                                              NULL, asset_id,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Asset_Id),
          period_counter             = decode(X_period_counter,
                                              NULL, period_counter,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Period_Counter),
          fiscal_year                = decode(X_fiscal_year,
                                              NULL, fiscal_year,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Fiscal_Year),
          period_num                 = decode(X_period_num,
                                              NULL, period_num,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Period_Num),
          calendar_period_open_date  = decode(X_calendar_period_open_date,
                                              NULL, calendar_period_open_date,
                                              X_Calendar_Period_Open_Date),
          calendar_period_close_date = decode(X_calendar_period_close_date,
                                              NULL, calendar_period_close_date,
                                              X_Calendar_Period_Close_Date),
          reset_adjusted_cost_flag   = decode(X_reset_adjusted_cost_flag,
                                              NULL, reset_adjusted_cost_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Reset_Adjusted_Cost_Flag),
          change_in_cost             = decode(X_change_in_cost,
                                              NULL, change_in_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Cost),
          change_in_additions_cost   = decode(X_change_in_additions_cost,
                                              NULL, change_in_additions_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Additions_Cost),
          change_in_adjustments_cost = decode(X_change_in_adjustments_cost,
                                              NULL, change_in_adjustments_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Adjustments_Cost),
          change_in_retirements_cost = decode(X_change_in_retirements_cost,
                                              NULL, change_in_retirements_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Retirements_Cost),
          change_in_group_rec_cost   = decode(X_change_in_group_rec_cost,
                                              NULL, change_in_group_rec_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Group_Rec_Cost),
          change_in_cip_cost         = decode(X_change_in_cip_cost,
                                              NULL, change_in_cip_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_CIP_Cost),
          cost                       = decode(X_cost,
                                              NULL, cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Cost),
          cip_cost                   = decode(X_cip_cost,
                                              NULL, cip_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_CIP_Cost),
          salvage_type               = decode(X_salvage_type,
                                              NULL, salvage_type,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Salvage_Type),
          percent_salvage_value      = decode(X_percent_salvage_value,
                                              NULL, percent_salvage_value,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Percent_Salvage_Value),
          salvage_value              = decode(X_salvage_value,
                                              NULL, salvage_value,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Salvage_Value),
          member_salvage_value       = decode(X_member_salvage_value,
                                              NULL, member_salvage_value,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Member_Salvage_Value),
          recoverable_cost           = decode(X_recoverable_cost,
                                              NULL, recoverable_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Recoverable_Cost),
          deprn_limit_type           = decode(X_deprn_limit_type,
                                              NULL, deprn_limit_type,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Deprn_Limit_Type),
          allowed_deprn_limit        = decode(X_allowed_deprn_limit,
                                              NULL, allowed_deprn_limit,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Allowed_Deprn_Limit),
          allowed_deprn_limit_amount = decode(X_allowed_deprn_limit_amount,
                                              NULL, allowed_deprn_limit_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Allowed_Deprn_Limit_Amount),
          member_deprn_limit_amount  = decode(X_member_deprn_limit_amount,
                                              NULL, member_deprn_limit_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Member_Deprn_Limit_Amount),
          adjusted_recoverable_cost  = decode(X_adjusted_recoverable_cost,
                                              NULL, adjusted_recoverable_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Recoverable_Cost),
          adjusted_cost              = decode(X_adjusted_cost,
                                              NULL, adjusted_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Cost),
          depreciate_flag            = decode(X_depreciate_flag,
                                              NULL, depreciate_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Depreciate_Flag),
          disabled_flag              = decode(X_disabled_flag,
                                              NULL, disabled_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Disabled_Flag),
          date_placed_in_service     = decode(X_date_placed_in_service,
                                              NULL, date_placed_in_service,
                                              X_Date_Placed_In_Service),
          deprn_method_code          = decode(X_deprn_method_code,
                                              NULL, deprn_method_code,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Deprn_Method_Code),
          life_in_months             = decode(X_life_in_months,
                                              NULL, life_in_months,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Life_In_Months),
          rate_adjustment_factor     = decode(X_rate_adjustment_factor,
                                              NULL, rate_adjustment_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Rate_Adjustment_Factor),
          adjusted_rate              = decode(X_adjusted_rate,
                                              NULL, adjusted_rate,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Rate),
          bonus_rule                 = decode(X_bonus_rule,
                                              NULL, bonus_rule,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Bonus_Rule),
          adjusted_capacity          = decode(X_adjusted_capacity,
                                              NULL, adjusted_capacity,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Capacity),
          production_capacity        = decode(X_production_capacity,
                                              NULL, production_capacity,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Production_Capacity),
          unit_of_measure            = decode(X_unit_of_measure,
                                              NULL, unit_of_measure,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Unit_Of_Measure),
          remaining_life1            = decode(X_remaining_life1,
                                              NULL, remaining_life1,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Remaining_Life1),
          remaining_life2            = decode(X_remaining_life2,
                                              NULL, remaining_life2,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Remaining_Life2),
          formula_factor             = decode(X_formula_factor,
                                              NULL, formula_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Formula_Factor),
          unrevalued_cost            = decode(X_unrevalued_cost,
                                              NULL, unrevalued_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Unrevalued_Cost),
          reval_amortization_basis   = decode(X_reval_amortization_basis,
                                              NULL, reval_amortization_basis,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Amortization_Basis),
          reval_ceiling              = decode(X_reval_ceiling,
                                              NULL, reval_ceiling,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Ceiling),
          ceiling_name               = decode(X_ceiling_name,
                                              NULL, ceiling_name,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Ceiling_Name),
          eofy_adj_cost              = decode(X_eofy_adj_cost,
                                              NULL, eofy_adj_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eofy_Adj_Cost),
          eofy_formula_factor        = decode(X_eofy_formula_factor,
                                              NULL, eofy_formula_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eofy_Formula_Factor),
          eofy_reserve               = decode(X_eofy_reserve,
                                              NULL, eofy_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eofy_Reserve),
          eop_adj_cost               = decode(X_eop_adj_cost,
                                              NULL, eop_adj_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eop_Adj_Cost),
          eop_formula_factor         = decode(X_eop_formula_factor,
                                              NULL, eop_formula_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eop_Formula_Factor),
          short_fiscal_year_flag     = decode(X_short_fiscal_year_flag,
                                              NULL, short_fiscal_year_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Short_Fiscal_Year_Flag),
          group_asset_id             = decode(X_group_asset_id,
                                              NULL, group_asset_id,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Group_Asset_ID),
          super_group_id             = decode(X_super_group_id,
                                              NULL, super_group_id,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Super_Group_ID),
          over_depreciate_option     = decode(X_over_depreciate_option,
                                              NULL, over_depreciate_option,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Over_Depreciate_Option),
          fully_rsvd_revals_counter  = decode(X_fully_rsvd_revals_counter,
                                              NULL, fully_rsvd_revals_counter,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Fully_Rsvd_Revals_Counter),
          capitalized_flag           = decode(X_capitalized_flag,
                                              NULL, capitalized_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Capitalized_Flag),
          fully_reserved_flag        = decode(X_fully_reserved_flag,
                                              NULL, fully_reserved_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Fully_Reserved_Flag),
          fully_retired_flag         = decode(X_fully_retired_flag,
                                              NULL, fully_retired_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Fully_Retired_Flag),
          life_complete_flag         = decode(X_life_complete_flag,
                                              NULL, life_complete_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Life_Complete_Flag),
          terminal_gain_loss_amount  = decode(X_terminal_gain_loss_amount,
                                              NULL, terminal_gain_loss_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Terminal_Gain_Loss_Amount),
          terminal_gain_loss_flag    = decode(X_terminal_gain_loss_flag,
                                              NULL, terminal_gain_loss_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Terminal_Gain_Loss_Flag),
          deprn_amount               = decode(X_deprn_amount,
                                              NULL, deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Deprn_Amount),
          ytd_deprn                  = decode(X_ytd_deprn,
                                              NULL, ytd_deprn,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Deprn),
          deprn_reserve              = decode(X_deprn_reserve,
                                              NULL, deprn_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Deprn_Reserve),
          bonus_deprn_amount         = decode(X_bonus_deprn_amount,
                                              NULL, bonus_deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Deprn_Amount),
          bonus_ytd_deprn            = decode(X_bonus_ytd_deprn,
                                              NULL, bonus_ytd_deprn,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Ytd_Deprn),
          bonus_deprn_reserve        = decode(X_bonus_deprn_reserve,
                                              NULL, bonus_deprn_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Deprn_Reserve),
          bonus_rate                 = decode(X_bonus_rate,
                                              NULL, bonus_rate,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Rate),
          ltd_production             = decode(X_ltd_production,
                                              NULL, ltd_production,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ltd_Production),
          ytd_production             = decode(X_ytd_production,
                                              NULL, ytd_production,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Production),
          production                 = decode(X_production,
                                              NULL, production,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Production),
          reval_amortization         = decode(X_reval_amortization,
                                              NULL, reval_amortization,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Amortization),
          reval_deprn_expense        = decode(X_reval_deprn_expense,
                                              NULL, reval_deprn_expense,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Deprn_Expense),
          reval_reserve              = decode(X_reval_reserve,
                                              NULL, reval_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Reserve),
          ytd_reval_deprn_expense    = decode(X_ytd_reval_deprn_expense,
                                              NULL, ytd_reval_deprn_expense,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Reval_Deprn_Expense),
          deprn_override_flag        = decode(X_deprn_override_flag,
                                              NULL, deprn_override_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Deprn_Override_Flag),
          system_deprn_amount        = decode(X_system_deprn_amount,
                                              NULL, system_deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_System_Deprn_Amount),
          system_bonus_deprn_amount  = decode(X_system_bonus_deprn_amount,
                                              NULL, system_bonus_deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_System_Bonus_Deprn_Amount),
          ytd_proceeds_of_sale       = decode(X_ytd_proceeds_of_sale,
                                              NULL, ytd_proceeds_of_sale,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Proceeds_Of_Sale),
          ltd_proceeds_of_sale       = decode(X_ltd_proceeds_of_sale,
                                              NULL, ltd_proceeds_of_sale,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ltd_Proceeds_Of_Sale),
          ytd_cost_of_removal        = decode(X_ytd_cost_of_removal,
                                              NULL, ytd_cost_of_removal,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Cost_Of_Removal),
          ltd_cost_of_removal        = decode(X_ltd_cost_of_removal,
                                              NULL, ltd_cost_of_removal,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ltd_Cost_Of_Removal),
          deprn_adjustment_amount    = decode(X_deprn_adjustment_amount,
                                              NULL, deprn_adjustment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Deprn_Adjustment_Amount),
          expense_adjustment_amount  = decode(X_expense_adjustment_amount,
                                              NULL, expense_adjustment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Expense_Adjustment_Amount),
          unplanned_amount           = decode(X_unplanned_amount,
                                              NULL, unplanned_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Unplanned_Amount),
          reserve_adjustment_amount  = decode(X_reserve_adjustment_amount,
                                              NULL, reserve_adjustment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reserve_Adjustment_Amount),
          creation_date              = decode(X_creation_date,
                                              NULL, creation_date,
                                              X_Creation_Date),
          created_by                 = decode(X_created_by,
                                              NULL, created_by,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Created_By),
          last_update_date           = decode(X_last_update_date,
                                              NULL, last_update_date,
                                              X_Last_Update_Date),
          last_updated_by            = decode(X_last_updated_by,
                                              NULL, last_updated_by,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Last_Updated_By),
          last_update_login          = decode(X_last_update_login,
                                              NULL, last_update_login,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Last_Update_Login),
          change_in_eofy_reserve     = decode(X_change_in_eofy_reserve,
                                              NULL, change_in_eofy_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Eofy_Reserve),
          switch_code                = decode(X_switch_code,
                                              NULL, switch_code,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Switch_Code),
          transaction_header_id_in   = decode(X_transaction_header_id_in,
                                              NULL, transaction_header_id_in,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_transaction_header_id_in),
          transaction_header_id_out  = decode(X_transaction_header_id_out,
                                              NULL, transaction_header_id_out,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_transaction_header_id_out),
          polish_deprn_basis         = decode(X_Polish_Deprn_Basis,
                                              NULL, polish_deprn_basis,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_polish_deprn_basis),
          polish_adj_rec_cost        = decode(X_Polish_Adj_Rec_Cost,
                                              NULL, polish_adj_rec_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Polish_Adj_Rec_Cost),
          impairment_amount          = decode(X_impairment_amount,
                                              NULL, impairment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Impairment_Amount),
          ytd_impairment             = decode(X_ytd_impairment,
                                              NULL, ytd_impairment,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Impairment),
          impairment_reserve             = decode(X_impairment_reserve,
                                              NULL, impairment_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_impairment_reserve)
         WHERE asset_id = X_Asset_Id
         AND   book_type_code = X_Book_Type_Code
         AND   period_counter = X_Period_Counter
         AND   set_of_books_id = X_set_of_books_id;
      end if;
   else
      if X_Rowid is not null then
         UPDATE fa_books_summary
            SET
          book_type_code             = decode(X_Book_Type_Code,
                                              NULL, book_type_code,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Book_Type_Code),
          asset_id                   = decode(X_Asset_Id,
                                              NULL, asset_id,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Asset_Id),
          period_counter             = decode(X_period_counter,
                                              NULL, period_counter,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Period_Counter),
          fiscal_year                = decode(X_fiscal_year,
                                              NULL, fiscal_year,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Fiscal_Year),
          period_num                 = decode(X_period_num,
                                              NULL, period_num,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Period_Num),
          calendar_period_open_date  = decode(X_calendar_period_open_date,
                                              NULL, calendar_period_open_date,
                                              X_Calendar_Period_Open_Date),
          calendar_period_close_date = decode(X_calendar_period_close_date,
                                              NULL, calendar_period_close_date,
                                              X_Calendar_Period_Close_Date),
          reset_adjusted_cost_flag   = decode(X_reset_adjusted_cost_flag,
                                              NULL, reset_adjusted_cost_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Reset_Adjusted_Cost_Flag),
          change_in_cost             = decode(X_change_in_cost,
                                              NULL, change_in_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Cost),
          change_in_additions_cost   = decode(X_change_in_additions_cost,
                                              NULL, change_in_additions_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Additions_Cost),
          change_in_adjustments_cost = decode(X_change_in_adjustments_cost,
                                              NULL, change_in_adjustments_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Adjustments_Cost),
          change_in_retirements_cost = decode(X_change_in_retirements_cost,
                                              NULL, change_in_retirements_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Retirements_Cost),
          change_in_group_rec_cost   = decode(X_change_in_group_rec_cost,
                                              NULL, change_in_group_rec_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Group_Rec_Cost),
          change_in_cip_cost         = decode(X_change_in_cip_cost,
                                              NULL, change_in_cip_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_CIP_Cost),
          cost                       = decode(X_cost,
                                              NULL, cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Cost),
          cip_cost                   = decode(X_cip_cost,
                                              NULL, cip_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_CIP_Cost),
          salvage_type               = decode(X_salvage_type,
                                              NULL, salvage_type,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Salvage_Type),
          percent_salvage_value      = decode(X_percent_salvage_value,
                                              NULL, percent_salvage_value,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Percent_Salvage_Value),
          salvage_value              = decode(X_salvage_value,
                                              NULL, salvage_value,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Salvage_Value),
          member_salvage_value       = decode(X_member_salvage_value,
                                              NULL, member_salvage_value,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Member_Salvage_Value),
          recoverable_cost           = decode(X_recoverable_cost,
                                              NULL, recoverable_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Recoverable_Cost),
          deprn_limit_type           = decode(X_deprn_limit_type,
                                              NULL, deprn_limit_type,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Deprn_Limit_Type),
          allowed_deprn_limit        = decode(X_allowed_deprn_limit,
                                              NULL, allowed_deprn_limit,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Allowed_Deprn_Limit),
          allowed_deprn_limit_amount = decode(X_allowed_deprn_limit_amount,
                                              NULL, allowed_deprn_limit_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Allowed_Deprn_Limit_Amount),
          member_deprn_limit_amount  = decode(X_member_deprn_limit_amount,
                                              NULL, member_deprn_limit_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Member_Deprn_Limit_Amount),
          adjusted_recoverable_cost  = decode(X_adjusted_recoverable_cost,
                                              NULL, adjusted_recoverable_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Recoverable_Cost),
          adjusted_cost              = decode(X_adjusted_cost,
                                              NULL, adjusted_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Cost),
          depreciate_flag            = decode(X_depreciate_flag,
                                              NULL, depreciate_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Depreciate_Flag),
          disabled_flag              = decode(X_disabled_flag,
                                              NULL, disabled_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Disabled_Flag),
          date_placed_in_service     = decode(X_date_placed_in_service,
                                              NULL, date_placed_in_service,
                                              X_Date_Placed_In_Service),
          deprn_method_code          = decode(X_deprn_method_code,
                                              NULL, deprn_method_code,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Deprn_Method_Code),
          life_in_months             = decode(X_life_in_months,
                                              NULL, life_in_months,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Life_In_Months),
          rate_adjustment_factor     = decode(X_rate_adjustment_factor,
                                              NULL, rate_adjustment_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Rate_Adjustment_Factor),
          adjusted_rate              = decode(X_adjusted_rate,
                                              NULL, adjusted_rate,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Rate),
          bonus_rule                 = decode(X_bonus_rule,
                                              NULL, bonus_rule,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Bonus_Rule),
          adjusted_capacity          = decode(X_adjusted_capacity,
                                              NULL, adjusted_capacity,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Adjusted_Capacity),
          production_capacity        = decode(X_production_capacity,
                                              NULL, production_capacity,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Production_Capacity),
          unit_of_measure            = decode(X_unit_of_measure,
                                              NULL, unit_of_measure,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Unit_Of_Measure),
          remaining_life1            = decode(X_remaining_life1,
                                              NULL, remaining_life1,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Remaining_Life1),
          remaining_life2            = decode(X_remaining_life2,
                                              NULL, remaining_life2,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Remaining_Life2),
          formula_factor             = decode(X_formula_factor,
                                              NULL, formula_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Formula_Factor),
          unrevalued_cost            = decode(X_unrevalued_cost,
                                              NULL, unrevalued_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Unrevalued_Cost),
          reval_amortization_basis   = decode(X_reval_amortization_basis,
                                              NULL, reval_amortization_basis,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Amortization_Basis),
          reval_ceiling              = decode(X_reval_ceiling,
                                              NULL, reval_ceiling,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Ceiling),
          ceiling_name               = decode(X_ceiling_name,
                                              NULL, ceiling_name,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Ceiling_Name),
          eofy_adj_cost              = decode(X_eofy_adj_cost,
                                              NULL, eofy_adj_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eofy_Adj_Cost),
          eofy_formula_factor        = decode(X_eofy_formula_factor,
                                              NULL, eofy_formula_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eofy_Formula_Factor),
          eofy_reserve               = decode(X_eofy_reserve,
                                              NULL, eofy_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eofy_Reserve),
          eop_adj_cost               = decode(X_eop_adj_cost,
                                              NULL, eop_adj_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eop_Adj_Cost),
          eop_formula_factor         = decode(X_eop_formula_factor,
                                              NULL, eop_formula_factor,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Eop_Formula_Factor),
          short_fiscal_year_flag     = decode(X_short_fiscal_year_flag,
                                              NULL, short_fiscal_year_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Short_Fiscal_Year_Flag),
          group_asset_id             = decode(X_group_asset_id,
                                              NULL, group_asset_id,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Group_Asset_ID),
          super_group_id             = decode(X_super_group_id,
                                              NULL, super_group_id,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Super_Group_ID),
          over_depreciate_option     = decode(X_over_depreciate_option,
                                              NULL, over_depreciate_option,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Over_Depreciate_Option),
          fully_rsvd_revals_counter  = decode(X_fully_rsvd_revals_counter,
                                              NULL, fully_rsvd_revals_counter,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Fully_Rsvd_Revals_Counter),
          capitalized_flag           = decode(X_capitalized_flag,
                                              NULL, capitalized_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Capitalized_Flag),
          fully_reserved_flag        = decode(X_fully_reserved_flag,
                                              NULL, fully_reserved_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Fully_Reserved_Flag),
          fully_retired_flag         = decode(X_fully_retired_flag,
                                              NULL, fully_retired_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Fully_Retired_Flag),
          life_complete_flag         = decode(X_life_complete_flag,
                                              NULL, life_complete_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Life_Complete_Flag),
          terminal_gain_loss_amount  = decode(X_terminal_gain_loss_amount,
                                              NULL, terminal_gain_loss_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Terminal_Gain_Loss_Amount),
          terminal_gain_loss_flag    = decode(X_terminal_gain_loss_flag,
                                              NULL, terminal_gain_loss_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Terminal_Gain_Loss_Flag),
          deprn_amount               = decode(X_deprn_amount,
                                              NULL, deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Deprn_Amount),
          ytd_deprn                  = decode(X_ytd_deprn,
                                              NULL, ytd_deprn,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Deprn),
          deprn_reserve              = decode(X_deprn_reserve,
                                              NULL, deprn_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Deprn_Reserve),
          bonus_deprn_amount         = decode(X_bonus_deprn_amount,
                                              NULL, bonus_deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Deprn_Amount),
          bonus_ytd_deprn            = decode(X_bonus_ytd_deprn,
                                              NULL, bonus_ytd_deprn,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Ytd_Deprn),
          bonus_deprn_reserve        = decode(X_bonus_deprn_reserve,
                                              NULL, bonus_deprn_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Deprn_Reserve),
          bonus_rate                 = decode(X_bonus_rate,
                                              NULL, bonus_rate,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Bonus_Rate),
          ltd_production             = decode(X_ltd_production,
                                              NULL, ltd_production,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ltd_Production),
          ytd_production             = decode(X_ytd_production,
                                              NULL, ytd_production,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Production),
          production                 = decode(X_production,
                                              NULL, production,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Production),
          reval_amortization         = decode(X_reval_amortization,
                                              NULL, reval_amortization,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Amortization),
          reval_deprn_expense        = decode(X_reval_deprn_expense,
                                              NULL, reval_deprn_expense,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Deprn_Expense),
          reval_reserve              = decode(X_reval_reserve,
                                              NULL, reval_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reval_Reserve),
          ytd_reval_deprn_expense    = decode(X_ytd_reval_deprn_expense,
                                              NULL, ytd_reval_deprn_expense,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Reval_Deprn_Expense),
          deprn_override_flag        = decode(X_deprn_override_flag,
                                              NULL, deprn_override_flag,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Deprn_Override_Flag),
          system_deprn_amount        = decode(X_system_deprn_amount,
                                              NULL, system_deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_System_Deprn_Amount),
          system_bonus_deprn_amount  = decode(X_system_bonus_deprn_amount,
                                              NULL, system_bonus_deprn_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_System_Bonus_Deprn_Amount),
          ytd_proceeds_of_sale       = decode(X_ytd_proceeds_of_sale,
                                              NULL, ytd_proceeds_of_sale,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Proceeds_Of_Sale),
          ltd_proceeds_of_sale       = decode(X_ltd_proceeds_of_sale,
                                              NULL, ltd_proceeds_of_sale,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ltd_Proceeds_Of_Sale),
          ytd_cost_of_removal        = decode(X_ytd_cost_of_removal,
                                              NULL, ytd_cost_of_removal,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Cost_Of_Removal),
          ltd_cost_of_removal        = decode(X_ltd_cost_of_removal,
                                              NULL, ltd_cost_of_removal,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ltd_Cost_Of_Removal),
          deprn_adjustment_amount    = decode(X_deprn_adjustment_amount,
                                              NULL, deprn_adjustment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Deprn_Adjustment_Amount),
          expense_adjustment_amount  = decode(X_expense_adjustment_amount,
                                              NULL, expense_adjustment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Expense_Adjustment_Amount),
          unplanned_amount           = decode(X_unplanned_amount,
                                              NULL, unplanned_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Unplanned_Amount),
          reserve_adjustment_amount  = decode(X_reserve_adjustment_amount,
                                              NULL, reserve_adjustment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Reserve_Adjustment_Amount),
          creation_date              = decode(X_creation_date,
                                              NULL, creation_date,
                                              X_Creation_Date),
          created_by                 = decode(X_created_by,
                                              NULL, created_by,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Created_By),
          last_update_date           = decode(X_last_update_date,
                                              NULL, last_update_date,
                                              X_Last_Update_Date),
          last_updated_by            = decode(X_last_updated_by,
                                              NULL, last_updated_by,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Last_Updated_By),
          last_update_login          = decode(X_last_update_login,
                                              NULL, last_update_login,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Last_Update_Login),
          change_in_eofy_reserve     = decode(X_change_in_eofy_reserve,
                                              NULL, change_in_eofy_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Change_In_Eofy_Reserve),
          switch_code                = decode(X_switch_code,
                                              NULL, switch_code,
                                              FND_API.G_MISS_CHAR, NULL,
                                              X_Switch_Code),
          transaction_header_id_in   = decode(X_transaction_header_id_in,
                                              NULL, transaction_header_id_in,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_transaction_header_id_in),
          transaction_header_id_out  = decode(X_transaction_header_id_out,
                                              NULL, transaction_header_id_out,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_transaction_header_id_out),
          polish_deprn_basis         = decode(X_Polish_Deprn_Basis,
                                              NULL, polish_deprn_basis,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_polish_deprn_basis),
          polish_adj_rec_cost        = decode(X_Polish_Adj_Rec_Cost,
                                              NULL, polish_adj_rec_cost,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Polish_Adj_Rec_Cost),
          impairment_amount          = decode(X_impairment_amount,
                                              NULL, impairment_amount,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Impairment_Amount),
          ytd_impairment             = decode(X_ytd_impairment,
                                              NULL, ytd_impairment,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_Ytd_Impairment),
          impairment_reserve             = decode(X_impairment_reserve,
                                              NULL, impairment_reserve,
                                              FND_API.G_MISS_NUM, NULL,
                                              X_impairment_reserve)
         WHERE asset_id = X_Asset_Id
         AND   book_type_code = X_Book_Type_Code
         AND   period_counter = X_Period_Counter;
      end if;
   end if;
   --
   if (SQL%NOTFOUND) then
      Raise NO_DATA_FOUND;
   end if;

EXCEPTION
   WHEN OTHERS THEN
      fa_srvr_msg.add_sql_error(
         calling_fn => 'fa_books_summary_pkg.update_row', p_log_level_rec => p_log_level_rec);
      raise;
END Update_Row;

PROCEDURE Delete_Row(X_Rowid                          VARCHAR2 DEFAULT NULL,
                     X_Book_Type_Code                 VARCHAR2,
                     X_Asset_Id                       NUMBER,
                     X_Period_Counter                 NUMBER,
                     X_MRC_Sob_Type_Code              VARCHAR2 DEFAULT 'P',
                     X_set_of_books_id                NUMBER ,
                     X_Calling_Fn                     VARCHAR2
, p_log_level_rec        IN     FA_API_TYPES.log_level_rec_type) IS

BEGIN

   if (X_mrc_sob_type_code = 'R') then
      if (X_Rowid is not null) then
         DELETE FROM fa_mc_books_summary
         WHERE rowid = X_Rowid;
      elsif ((X_Asset_ID is not null) AND
             (X_Book_Type_Code is not null) AND
             (X_Period_Counter is not null)) then
         DELETE FROM fa_mc_books_summary
         WHERE asset_id = X_Asset_ID
         AND   book_type_code = X_Book_Type_Code
         AND   period_counter = X_Period_Counter
         AND set_of_books_id = X_set_of_books_id;
      elsif (X_Asset_Id is not null) then
         DELETE FROM fa_mc_books_summary
         WHERE asset_id = X_Asset_Id
         AND set_of_books_id = X_set_of_books_id;
      else
         -- print some error message
         null;
      end if;
   else
      if (X_Rowid is not null) then
         DELETE FROM fa_books_summary
         WHERE rowid = X_Rowid;
      elsif ((X_Asset_ID is not null) AND
             (X_Book_Type_Code is not null) AND
             (X_Period_Counter is not null)) then
         DELETE FROM fa_books_summary
         WHERE asset_id = X_Asset_ID
         AND   book_type_code = X_Book_Type_Code
         AND   period_counter = X_Period_Counter;
      elsif (X_Asset_Id is not null) then
         DELETE FROM fa_books_summary
         WHERE asset_id = X_Asset_Id;
      else
         -- print some error message
         null;
      end if;
   end if;

   if (SQL%NOTFOUND) then
      Raise NO_DATA_FOUND;
   end if;

EXCEPTION
   WHEN OTHERS THEN
      FA_STANDARD_PKG.RAISE_ERROR(
          CALLED_FN => 'fa_books_summary_pkg.delete_row',
          CALLING_FN => X_Calling_Fn, p_log_level_rec => p_log_level_rec);
END Delete_Row;

END FA_BOOKS_SUMMARY_PKG;

/
