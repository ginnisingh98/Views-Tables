--------------------------------------------------------
--  DDL for Package Body MSC_RESTORE_FIRM_PO
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APPS"."MSC_RESTORE_FIRM_PO" AS
/* $Header: MSCRFPOB.pls 120.0.12010000.1 2008/05/02 19:07:30 appldev ship $ */

  -- =========== Private Functions =============

   PROCEDURE LOG_MESSAGE( pBUFF                     IN  VARCHAR2)
   IS
   BEGIN
     IF fnd_global.conc_request_id > 0  THEN
         FND_FILE.PUT_LINE( FND_FILE.LOG, pBUFF);
        null;
     ELSE
         null;
         --DBMS_OUTPUT.PUT_LINE( pBUFF);
     END IF;
   EXCEPTION
     WHEN OTHERS THEN
        RETURN;
   END LOG_MESSAGE;


PROCEDURE RESTORE_FIRM_PO (
				errbuf                  OUT NOCOPY VARCHAR2,
                                retcode                 OUT NOCOPY NUMBER,
                                arg_plan_id             IN         NUMBER
				)
IS
	lv_plan_id       NUMBER := arg_plan_id;

BEGIN

    BEGIN
            DELETE FROM MSC_RESOURCE_REQUIREMENTS
	     WHERE (PLAN_ID, TRANSACTION_ID, SR_INSTANCE_ID) IN
	          (SELECT PLAN_ID, TRANSACTION_ID, SR_INSTANCE_ID
		  FROM   MSC_STORE_RESOURCE_REQS
		  WHERE  plan_id = lv_plan_id)
	     AND plan_id = lv_plan_id;
	     LOG_MESSAGE('Deleted Resource Requirements : ' || SQL%ROWCOUNT);

	    INSERT INTO MSC_RESOURCE_REQUIREMENTS(
			     TRANSACTION_ID
			    ,PLAN_ID
			    ,SUPPLY_ID
			    ,ORGANIZATION_ID
			    ,SR_INSTANCE_ID
			    ,ROUTING_SEQUENCE_ID
			    ,OPERATION_SEQUENCE_ID
			    ,RESOURCE_SEQ_NUM
			    ,RESOURCE_ID
			    ,DEPARTMENT_ID
			    ,ALTERNATE_NUM
			    ,START_DATE
			    ,END_DATE
			    ,BKT_START_DATE
			    ,RESOURCE_HOURS
			    ,SET_UP
			    ,BKT_END_DATE
			    ,TEAR_DOWN
			    ,AGGREGATE_RESOURCE_ID
			    ,SCHEDULE_FLAG
			    ,PARENT_ID
			    ,STD_OP_CODE
			    ,WIP_ENTITY_ID
			    ,ASSIGNED_UNITS
			    ,BASIS_TYPE
			    ,OPERATION_SEQ_NUM
			    ,LOAD_RATE
			    ,DAILY_RESOURCE_HOURS
			    ,STATUS
			    ,APPLIED
			    ,UPDATED
			    ,SUBST_RES_FLAG
			    ,REFRESH_NUMBER
			    ,LAST_UPDATED_BY
			    ,LAST_UPDATE_DATE
			    ,CREATED_BY
			    ,CREATION_DATE
			    ,LAST_UPDATE_LOGIN
			    ,REQUEST_ID
			    ,PROGRAM_APPLICATION_ID
			    ,PROGRAM_ID
			    ,PROGRAM_UPDATE_DATE
			    ,SOURCE_ITEM_ID
			    ,ASSEMBLY_ITEM_ID
			    ,SUPPLY_TYPE
			    ,FIRM_START_DATE
			    ,FIRM_END_DATE
			    ,FIRM_FLAG
			    ,CUMMULATIVE_QUANTITY
			    ,YIELD
			    ,REVERSE_CUMULATIVE_YIELD
			    ,BATCH_NUMBER
			    ,MINIMUM_TRANSFER_QUANTITY
			    ,REMAINING_CAPACITY
			    ,OVERLOADED_CAPACITY
			    ,EARLIEST_START_DATE
			    ,EARLIEST_COMPLETION_DATE
			    ,SCHEDULED_DEMAND_ID
			    ,PARENT_SEQ_NUM
			    ,SETUP_ID
			    ,ULPSD
			    ,ULPCD
			    ,UEPSD
			    ,UEPCD
			    ,EACD
			    ,QUANTITY_IN_QUEUE
			    ,QUANTITY_RUNNING
			    ,QUANTITY_WAITING_TO_MOVE
			    ,QUANTITY_COMPLETED
			    ,USAGE_RATE
			    ,HOURS_EXPENDED
			    ,RECORD_SOURCE
			    ,ACTIVITY_GROUP_ID
			    ,PRINCIPAL_FLAG
			    ,ORIG_RESOURCE_SEQ_NUM
			    ,GROUP_SEQUENCE_ID
			    ,GROUP_SEQUENCE_NUMBER
			    ,MAXIMUM_ASSIGNED_UNITS
			    ,MINIMUM_CAPACITY
			    ,MAXIMUM_CAPACITY
			    ,BREAKABLE_ACTIVITY_FLAG
			    ,CAPACITY_CONSUMED_RATIO
			    ,FROM_SETUP_ID
			    ,STEP_QUANTITY
			    ,STEP_QUANTITY_UOM
			    ,UNADJUSTED_RESOURCE_HOURS
			    ,TOUCH_TIME
			    ,JIT_END_DATE
			    ,UNBUCKETED_START_DATE
			    ,UNBUCKETED_END_DATE
			    ,ACTUAL_START_DATE
			    ,TOTAL_RESOURCE_HOURS
			    )
		SELECT
			     res.TRANSACTION_ID
			    ,res.PLAN_ID
			    ,res.SUPPLY_ID
			    ,res.ORGANIZATION_ID
			    ,res.SR_INSTANCE_ID
			    ,res.ROUTING_SEQUENCE_ID
			    ,res.OPERATION_SEQUENCE_ID
			    ,res.RESOURCE_SEQ_NUM
			    ,res.RESOURCE_ID
			    ,res.DEPARTMENT_ID
			    ,res.ALTERNATE_NUM
			    ,res.START_DATE
			    ,res.END_DATE
			    ,res.BKT_START_DATE
			    ,res.RESOURCE_HOURS
			    ,res.SET_UP
			    ,res.BKT_END_DATE
			    ,res.TEAR_DOWN
			    ,res.AGGREGATE_RESOURCE_ID
			    ,res.SCHEDULE_FLAG
			    ,res.PARENT_ID
			    ,res.STD_OP_CODE
			    ,res.WIP_ENTITY_ID
			    ,res.ASSIGNED_UNITS
			    ,res.BASIS_TYPE
			    ,res.OPERATION_SEQ_NUM
			    ,res.LOAD_RATE
			    ,res.DAILY_RESOURCE_HOURS
			    ,res.STATUS
			    ,res.APPLIED
			    ,res.UPDATED
			    ,res.SUBST_RES_FLAG
			    ,res.REFRESH_NUMBER
			    ,res.LAST_UPDATED_BY
			    ,res.LAST_UPDATE_DATE
			    ,res.CREATED_BY
			    ,res.CREATION_DATE
			    ,res.LAST_UPDATE_LOGIN
			    ,res.REQUEST_ID
			    ,res.PROGRAM_APPLICATION_ID
			    ,res.PROGRAM_ID
			    ,res.PROGRAM_UPDATE_DATE
			    ,res.SOURCE_ITEM_ID
			    ,res.ASSEMBLY_ITEM_ID
			    ,res.SUPPLY_TYPE
			    ,res.FIRM_START_DATE
			    ,res.FIRM_END_DATE
			    ,res.FIRM_FLAG
			    ,res.CUMMULATIVE_QUANTITY
			    ,res.YIELD
			    ,res.REVERSE_CUMULATIVE_YIELD
			    ,res.BATCH_NUMBER
			    ,res.MINIMUM_TRANSFER_QUANTITY
			    ,res.REMAINING_CAPACITY
			    ,res.OVERLOADED_CAPACITY
			    ,res.EARLIEST_START_DATE
			    ,res.EARLIEST_COMPLETION_DATE
			    ,res.SCHEDULED_DEMAND_ID
			    ,res.PARENT_SEQ_NUM
			    ,res.SETUP_ID
			    ,res.ULPSD
			    ,res.ULPCD
			    ,res.UEPSD
			    ,res.UEPCD
			    ,res.EACD
			    ,res.QUANTITY_IN_QUEUE
			    ,res.QUANTITY_RUNNING
			    ,res.QUANTITY_WAITING_TO_MOVE
			    ,res.QUANTITY_COMPLETED
			    ,res.USAGE_RATE
			    ,res.HOURS_EXPENDED
			    ,res.RECORD_SOURCE
			    ,res.ACTIVITY_GROUP_ID
			    ,res.PRINCIPAL_FLAG
			    ,res.ORIG_RESOURCE_SEQ_NUM
			    ,res.GROUP_SEQUENCE_ID
			    ,res.GROUP_SEQUENCE_NUMBER
			    ,res.MAXIMUM_ASSIGNED_UNITS
			    ,res.MINIMUM_CAPACITY
			    ,res.MAXIMUM_CAPACITY
			    ,res.BREAKABLE_ACTIVITY_FLAG
			    ,res.CAPACITY_CONSUMED_RATIO
			    ,res.FROM_SETUP_ID
			    ,res.STEP_QUANTITY
			    ,res.STEP_QUANTITY_UOM
			    ,res.UNADJUSTED_RESOURCE_HOURS
			    ,res.TOUCH_TIME
			    ,res.JIT_END_DATE
			    ,res.UNBUCKETED_START_DATE
			    ,res.UNBUCKETED_END_DATE
			    ,res.ACTUAL_START_DATE
			    ,res.TOTAL_RESOURCE_HOURS
	    FROM   MSC_STORE_RESOURCE_REQS res
	    WHERE  res.PLAN_ID = lv_plan_id;

	    LOG_MESSAGE('Inserted Resource Requirements : ' || SQL%ROWCOUNT);
    EXCEPTION
	WHEN OTHERS THEN
	   msc_util.msc_debug('Error in Restoring Firm Resource Requirements.');
	   msc_util.msc_debug(SQLERRM);

	   RETCODE := G_ERROR;
	   ERRBUF  := SQLERRM;
        RETURN;
    END;

    COMMIT;

    BEGIN
            DELETE FROM MSC_SUPPLIES
	     WHERE (PLAN_ID, TRANSACTION_ID, SR_INSTANCE_ID) IN
	          (SELECT PLAN_ID, TRANSACTION_ID, SR_INSTANCE_ID
		  FROM   MSC_STORE_SUPPLIES
		  WHERE  plan_id = lv_plan_id)
	     AND plan_id = lv_plan_id;
	    LOG_MESSAGE('Deleted Supplies  : ' || SQL%ROWCOUNT);

	    INSERT INTO MSC_SUPPLIES(
		     PLAN_ID
		    ,TRANSACTION_ID
		    ,ORGANIZATION_ID
		    ,SR_INSTANCE_ID
		    ,INVENTORY_ITEM_ID
		    ,SCHEDULE_DESIGNATOR_ID
		    ,REVISION
		    ,UNIT_NUMBER
		    ,NEW_SCHEDULE_DATE
		    ,OLD_SCHEDULE_DATE
		    ,NEW_WIP_START_DATE
		    ,OLD_WIP_START_DATE
		    ,FIRST_UNIT_COMPLETION_DATE
		    ,LAST_UNIT_COMPLETION_DATE
		    ,FIRST_UNIT_START_DATE
		    ,LAST_UNIT_START_DATE
		    ,DISPOSITION_ID
		    ,DISPOSITION_STATUS_TYPE
		    ,ORDER_TYPE
		    ,SUPPLIER_ID
		    ,SUPPLIER_SITE_ID
		    ,NEW_ORDER_QUANTITY
		    ,OLD_ORDER_QUANTITY
		    ,NEW_ORDER_PLACEMENT_DATE
		    ,OLD_ORDER_PLACEMENT_DATE
		    ,RESCHEDULE_DAYS
		    ,RESCHEDULE_FLAG
		    ,SCHEDULE_COMPRESS_DAYS
		    ,NEW_PROCESSING_DAYS
		    ,PURCH_LINE_NUM
		    ,QUANTITY_IN_PROCESS
		    ,IMPLEMENTED_QUANTITY
		    ,FIRM_PLANNED_TYPE
		    ,FIRM_QUANTITY
		    ,FIRM_DATE
		    ,IMPLEMENT_DEMAND_CLASS
		    ,IMPLEMENT_DATE
		    ,IMPLEMENT_QUANTITY
		    ,IMPLEMENT_FIRM
		    ,IMPLEMENT_WIP_CLASS_CODE
		    ,IMPLEMENT_JOB_NAME
		    ,IMPLEMENT_DOCK_DATE
		    ,IMPLEMENT_STATUS_CODE
		    ,IMPLEMENT_EMPLOYEE_ID
		    ,IMPLEMENT_UOM_CODE
		    ,IMPLEMENT_LOCATION_ID
		    ,IMPLEMENT_SOURCE_ORG_ID
		    ,IMPLEMENT_SR_INSTANCE_ID
		    ,IMPLEMENT_SUPPLIER_ID
		    ,IMPLEMENT_SUPPLIER_SITE_ID
		    ,IMPLEMENT_AS
		    ,RELEASE_STATUS
		    ,LOAD_TYPE
		    ,PROCESS_SEQ_ID
		    ,SCO_SUPPLY_FLAG
		    ,ALTERNATE_BOM_DESIGNATOR
		    ,ALTERNATE_ROUTING_DESIGNATOR
		    ,OPERATION_SEQ_NUM
		    ,BY_PRODUCT_USING_ASSY_ID
		    ,SOURCE_ORGANIZATION_ID
		    ,SOURCE_SR_INSTANCE_ID
		    ,SOURCE_SUPPLIER_SITE_ID
		    ,SOURCE_SUPPLIER_ID
		    ,SHIP_METHOD
		    ,WEIGHT_CAPACITY_USED
		    ,VOLUME_CAPACITY_USED
		    ,NEW_SHIP_DATE
		    ,NEW_DOCK_DATE
		    ,OLD_DOCK_DATE
		    ,LINE_ID
		    ,PROJECT_ID
		    ,TASK_ID
		    ,PLANNING_GROUP
		    ,IMPLEMENT_PROJECT_ID
		    ,IMPLEMENT_TASK_ID
		    ,IMPLEMENT_SCHEDULE_GROUP_ID
		    ,IMPLEMENT_BUILD_SEQUENCE
		    ,IMPLEMENT_ALTERNATE_BOM
		    ,IMPLEMENT_ALTERNATE_ROUTING
		    ,IMPLEMENT_UNIT_NUMBER
		    ,IMPLEMENT_LINE_ID
		    ,RELEASE_ERRORS
		    ,NUMBER1
		    ,SOURCE_ITEM_ID
		    ,ORDER_NUMBER
		    ,SCHEDULE_GROUP_ID
		    ,BUILD_SEQUENCE
		    ,WIP_ENTITY_NAME
		    ,IMPLEMENT_PROCESSING_DAYS
		    ,DELIVERY_PRICE
		    ,LATE_SUPPLY_DATE
		    ,LATE_SUPPLY_QTY
		    ,LOT_NUMBER
		    ,SUBINVENTORY_CODE
		    ,QTY_SCRAPPED
		    ,EXPECTED_SCRAP_QTY
		    ,QTY_COMPLETED
		    ,DAILY_RATE
		    ,SCHEDULE_GROUP_NAME
		    ,UPDATED
		    ,SUBST_ITEM_FLAG
		    ,STATUS
		    ,APPLIED
		    ,EXPIRATION_QUANTITY
		    ,EXPIRATION_DATE
		    ,NON_NETTABLE_QTY
		    ,IMPLEMENT_WIP_START_DATE
		    ,REFRESH_NUMBER
		    ,LAST_UPDATE_DATE
		    ,LAST_UPDATED_BY
		    ,CREATION_DATE
		    ,CREATED_BY
		    ,LAST_UPDATE_LOGIN
		    ,REQUEST_ID
		    ,PROGRAM_APPLICATION_ID
		    ,PROGRAM_ID
		    ,PROGRAM_UPDATE_DATE
		    ,IMPLEMENT_DAILY_RATE
		    ,NEED_BY_DATE
		    ,SOURCE_SUPPLY_ID
		    ,SR_MTL_SUPPLY_ID
		    ,WIP_STATUS_CODE
		    ,DEMAND_CLASS
		    ,FROM_ORGANIZATION_ID
		    ,WIP_SUPPLY_TYPE
		    ,PO_LINE_ID
		    ,LOAD_FACTOR_RATE
		    ,ROUTING_SEQUENCE_ID
		    ,BILL_SEQUENCE_ID
		    ,COPRODUCTS_SUPPLY
		    ,CFM_ROUTING_FLAG
		    ,CUSTOMER_ID
		    ,SHIP_TO_SITE_ID
		    ,OLD_NEED_BY_DATE
		    ,OLD_DAILY_RATE
		    ,OLD_FIRST_UNIT_START_DATE
		    ,OLD_LAST_UNIT_COMPLETION_DATE
		    ,OLD_NEW_SCHEDULE_DATE
		    ,OLD_QTY_COMPLETED
		    ,OLD_NEW_ORDER_QUANTITY
		    ,OLD_FIRM_QUANTITY
		    ,OLD_FIRM_DATE
		    ,PLANNING_PARTNER_SITE_ID
		    ,PLANNING_TP_TYPE
		    ,OWNING_PARTNER_SITE_ID
		    ,OWNING_TP_TYPE
		    ,VMI_FLAG
		    ,EARLIEST_START_DATE
		    ,EARLIEST_COMPLETION_DATE
		    ,MIN_START_DATE
		    ,SCHEDULED_DEMAND_ID
		    ,EXPLOSION_DATE
		    ,SCO_SUPPLY_DATE
		    ,RECORD_SOURCE
		    ,SUPPLY_IS_SHARED
		    ,ULPSD
		    ,ULPCD
		    ,UEPSD
		    ,UEPCD
		    ,EACD
		    ,ORIGINAL_NEED_BY_DATE
		    ,ORIGINAL_QUANTITY
		    ,ACCEPTANCE_REQUIRED_FLAG
		    ,PROMISED_DATE
		    ,WIP_START_QUANTITY
		    ,END_ORDER_NUMBER
		    ,END_ORDER_LINE_NUMBER
		    ,ORDER_LINE_NUMBER
		    ,UNBUCKETED_DEMAND_DATE
		    ,QUANTITY_PER_ASSEMBLY
		    ,QUANTITY_ISSUED
		    ,SHIPMENT_ID
		    ,JOB_OP_SEQ_NUM
		    ,JUMP_OP_SEQ_NUM
		    ,SHIP_CALENDAR
		    ,RECEIVING_CALENDAR
		    ,INTRANSIT_CALENDAR
		    ,INTRANSIT_LEAD_TIME
		    ,OLD_SHIP_DATE
		    ,IMPLEMENT_SHIP_DATE
		    ,ORIG_SHIP_METHOD
		    ,ORIG_INTRANSIT_LEAD_TIME
		    ,PARENT_ID
		    ,DAYS_LATE
		    ,SCHEDULE_PRIORITY
		    ,PO_LINE_LOCATION_ID
		    ,PO_DISTRIBUTION_ID
		    ,WSM_FAULTY_NETWORK
		    ,IMPLEMENT_DEST_ORG_ID
		    ,IMPLEMENT_DEST_INST_ID
		    ,REQUESTED_START_DATE
		    ,REQUESTED_COMPLETION_DATE
		    ,ASSET_SERIAL_NUMBER
		    ,ASSET_ITEM_ID
		    ,TOP_TRANSACTION_ID
		    ,UNBUCKETED_NEW_SCHED_DATE
		    ,IMPLEMENT_SHIP_METHOD
		    ,ACTUAL_START_DATE
		    )
	    SELECT
		     sup.PLAN_ID
		    ,sup.TRANSACTION_ID
		    ,sup.ORGANIZATION_ID
		    ,sup.SR_INSTANCE_ID
		    ,sup.INVENTORY_ITEM_ID
		    ,sup.SCHEDULE_DESIGNATOR_ID
		    ,sup.REVISION
		    ,sup.UNIT_NUMBER
		    ,sup.NEW_SCHEDULE_DATE
		    ,sup.OLD_SCHEDULE_DATE
		    ,sup.NEW_WIP_START_DATE
		    ,sup.OLD_WIP_START_DATE
		    ,sup.FIRST_UNIT_COMPLETION_DATE
		    ,sup.LAST_UNIT_COMPLETION_DATE
		    ,sup.FIRST_UNIT_START_DATE
		    ,sup.LAST_UNIT_START_DATE
		    ,sup.DISPOSITION_ID
		    ,sup.DISPOSITION_STATUS_TYPE
		    ,sup.ORDER_TYPE
		    ,sup.SUPPLIER_ID
		    ,sup.SUPPLIER_SITE_ID
		    ,sup.NEW_ORDER_QUANTITY
		    ,sup.OLD_ORDER_QUANTITY
		    ,sup.NEW_ORDER_PLACEMENT_DATE
		    ,sup.OLD_ORDER_PLACEMENT_DATE
		    ,sup.RESCHEDULE_DAYS
		    ,sup.RESCHEDULE_FLAG
		    ,sup.SCHEDULE_COMPRESS_DAYS
		    ,sup.NEW_PROCESSING_DAYS
		    ,sup.PURCH_LINE_NUM
		    ,sup.QUANTITY_IN_PROCESS
		    ,sup.IMPLEMENTED_QUANTITY
		    ,sup.FIRM_PLANNED_TYPE
		    ,sup.FIRM_QUANTITY
		    ,sup.FIRM_DATE
		    ,sup.IMPLEMENT_DEMAND_CLASS
		    ,sup.IMPLEMENT_DATE
		    ,sup.IMPLEMENT_QUANTITY
		    ,sup.IMPLEMENT_FIRM
		    ,sup.IMPLEMENT_WIP_CLASS_CODE
		    ,sup.IMPLEMENT_JOB_NAME
		    ,sup.IMPLEMENT_DOCK_DATE
		    ,sup.IMPLEMENT_STATUS_CODE
		    ,sup.IMPLEMENT_EMPLOYEE_ID
		    ,sup.IMPLEMENT_UOM_CODE
		    ,sup.IMPLEMENT_LOCATION_ID
		    ,sup.IMPLEMENT_SOURCE_ORG_ID
		    ,sup.IMPLEMENT_SR_INSTANCE_ID
		    ,sup.IMPLEMENT_SUPPLIER_ID
		    ,sup.IMPLEMENT_SUPPLIER_SITE_ID
		    ,sup.IMPLEMENT_AS
		    ,sup.RELEASE_STATUS
		    ,sup.LOAD_TYPE
		    ,sup.PROCESS_SEQ_ID
		    ,sup.SCO_SUPPLY_FLAG
		    ,sup.ALTERNATE_BOM_DESIGNATOR
		    ,sup.ALTERNATE_ROUTING_DESIGNATOR
		    ,sup.OPERATION_SEQ_NUM
		    ,sup.BY_PRODUCT_USING_ASSY_ID
		    ,sup.SOURCE_ORGANIZATION_ID
		    ,sup.SOURCE_SR_INSTANCE_ID
		    ,sup.SOURCE_SUPPLIER_SITE_ID
		    ,sup.SOURCE_SUPPLIER_ID
		    ,sup.SHIP_METHOD
		    ,sup.WEIGHT_CAPACITY_USED
		    ,sup.VOLUME_CAPACITY_USED
		    ,sup.NEW_SHIP_DATE
		    ,sup.NEW_DOCK_DATE
		    ,sup.OLD_DOCK_DATE
		    ,sup.LINE_ID
		    ,sup.PROJECT_ID
		    ,sup.TASK_ID
		    ,sup.PLANNING_GROUP
		    ,sup.IMPLEMENT_PROJECT_ID
		    ,sup.IMPLEMENT_TASK_ID
		    ,sup.IMPLEMENT_SCHEDULE_GROUP_ID
		    ,sup.IMPLEMENT_BUILD_SEQUENCE
		    ,sup.IMPLEMENT_ALTERNATE_BOM
		    ,sup.IMPLEMENT_ALTERNATE_ROUTING
		    ,sup.IMPLEMENT_UNIT_NUMBER
		    ,sup.IMPLEMENT_LINE_ID
		    ,sup.RELEASE_ERRORS
		    ,sup.NUMBER1
		    ,sup.SOURCE_ITEM_ID
		    ,sup.ORDER_NUMBER
		    ,sup.SCHEDULE_GROUP_ID
		    ,sup.BUILD_SEQUENCE
		    ,sup.WIP_ENTITY_NAME
		    ,sup.IMPLEMENT_PROCESSING_DAYS
		    ,sup.DELIVERY_PRICE
		    ,sup.LATE_SUPPLY_DATE
		    ,sup.LATE_SUPPLY_QTY
		    ,sup.LOT_NUMBER
		    ,sup.SUBINVENTORY_CODE
		    ,sup.QTY_SCRAPPED
		    ,sup.EXPECTED_SCRAP_QTY
		    ,sup.QTY_COMPLETED
		    ,sup.DAILY_RATE
		    ,sup.SCHEDULE_GROUP_NAME
		    ,sup.UPDATED
		    ,sup.SUBST_ITEM_FLAG
		    ,sup.STATUS
		    ,sup.APPLIED
		    ,sup.EXPIRATION_QUANTITY
		    ,sup.EXPIRATION_DATE
		    ,sup.NON_NETTABLE_QTY
		    ,sup.IMPLEMENT_WIP_START_DATE
		    ,sup.REFRESH_NUMBER
		    ,sup.LAST_UPDATE_DATE
		    ,sup.LAST_UPDATED_BY
		    ,sup.CREATION_DATE
		    ,sup.CREATED_BY
		    ,sup.LAST_UPDATE_LOGIN
		    ,sup.REQUEST_ID
		    ,sup.PROGRAM_APPLICATION_ID
		    ,sup.PROGRAM_ID
		    ,sup.PROGRAM_UPDATE_DATE
		    ,sup.IMPLEMENT_DAILY_RATE
		    ,sup.NEED_BY_DATE
		    ,sup.SOURCE_SUPPLY_ID
		    ,sup.SR_MTL_SUPPLY_ID
		    ,sup.WIP_STATUS_CODE
		    ,sup.DEMAND_CLASS
		    ,sup.FROM_ORGANIZATION_ID
		    ,sup.WIP_SUPPLY_TYPE
		    ,sup.PO_LINE_ID
		    ,sup.LOAD_FACTOR_RATE
		    ,sup.ROUTING_SEQUENCE_ID
		    ,sup.BILL_SEQUENCE_ID
		    ,sup.COPRODUCTS_SUPPLY
		    ,sup.CFM_ROUTING_FLAG
		    ,sup.CUSTOMER_ID
		    ,sup.SHIP_TO_SITE_ID
		    ,sup.OLD_NEED_BY_DATE
		    ,sup.OLD_DAILY_RATE
		    ,sup.OLD_FIRST_UNIT_START_DATE
		    ,sup.OLD_LAST_UNIT_COMPLETION_DATE
		    ,sup.OLD_NEW_SCHEDULE_DATE
		    ,sup.OLD_QTY_COMPLETED
		    ,sup.OLD_NEW_ORDER_QUANTITY
		    ,sup.OLD_FIRM_QUANTITY
		    ,sup.OLD_FIRM_DATE
		    ,sup.PLANNING_PARTNER_SITE_ID
		    ,sup.PLANNING_TP_TYPE
		    ,sup.OWNING_PARTNER_SITE_ID
		    ,sup.OWNING_TP_TYPE
		    ,sup.VMI_FLAG
		    ,sup.EARLIEST_START_DATE
		    ,sup.EARLIEST_COMPLETION_DATE
		    ,sup.MIN_START_DATE
		    ,sup.SCHEDULED_DEMAND_ID
		    ,sup.EXPLOSION_DATE
		    ,sup.SCO_SUPPLY_DATE
		    ,sup.RECORD_SOURCE
		    ,sup.SUPPLY_IS_SHARED
		    ,sup.ULPSD
		    ,sup.ULPCD
		    ,sup.UEPSD
		    ,sup.UEPCD
		    ,sup.EACD
		    ,sup.ORIGINAL_NEED_BY_DATE
		    ,sup.ORIGINAL_QUANTITY
		    ,sup.ACCEPTANCE_REQUIRED_FLAG
		    ,sup.PROMISED_DATE
		    ,sup.WIP_START_QUANTITY
		    ,sup.END_ORDER_NUMBER
		    ,sup.END_ORDER_LINE_NUMBER
		    ,sup.ORDER_LINE_NUMBER
		    ,sup.UNBUCKETED_DEMAND_DATE
		    ,sup.QUANTITY_PER_ASSEMBLY
		    ,sup.QUANTITY_ISSUED
		    ,sup.SHIPMENT_ID
		    ,sup.JOB_OP_SEQ_NUM
		    ,sup.JUMP_OP_SEQ_NUM
		    ,sup.SHIP_CALENDAR
		    ,sup.RECEIVING_CALENDAR
		    ,sup.INTRANSIT_CALENDAR
		    ,sup.INTRANSIT_LEAD_TIME
		    ,sup.OLD_SHIP_DATE
		    ,sup.IMPLEMENT_SHIP_DATE
		    ,sup.ORIG_SHIP_METHOD
		    ,sup.ORIG_INTRANSIT_LEAD_TIME
		    ,sup.PARENT_ID
		    ,sup.DAYS_LATE
		    ,sup.SCHEDULE_PRIORITY
		    ,sup.PO_LINE_LOCATION_ID
		    ,sup.PO_DISTRIBUTION_ID
		    ,sup.WSM_FAULTY_NETWORK
		    ,sup.IMPLEMENT_DEST_ORG_ID
		    ,sup.IMPLEMENT_DEST_INST_ID
		    ,sup.REQUESTED_START_DATE
		    ,sup.REQUESTED_COMPLETION_DATE
		    ,sup.ASSET_SERIAL_NUMBER
		    ,sup.ASSET_ITEM_ID
		    ,sup.TOP_TRANSACTION_ID
		    ,sup.UNBUCKETED_NEW_SCHED_DATE
		    ,sup.IMPLEMENT_SHIP_METHOD
		    ,sup.ACTUAL_START_DATE
	    FROM   MSC_STORE_SUPPLIES              sup
	    WHERE  sup.PLAN_ID = lv_plan_id;
	    LOG_MESSAGE('Inserted Supplies : ' || SQL%ROWCOUNT);

    EXCEPTION
	WHEN OTHERS THEN
	   msc_util.msc_debug('Error in Restoring Firm Supplies.');
	   msc_util.msc_debug(SQLERRM);

	   RETCODE := G_ERROR;
	   ERRBUF  := SQLERRM;
        RETURN;
    END;

    COMMIT;

    RETCODE := G_SUCCESS;

EXCEPTION
   when OTHERS THEN
        msc_util.msc_debug(SQLERRM);
	ERRBUF  := SQLERRM;
	RETCODE := G_ERROR;

END RESTORE_FIRM_PO;

END MSC_RESTORE_FIRM_PO; -- package

/
